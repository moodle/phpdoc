<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: backup_plan_dbops Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.2</span>
   </div>
   <div id="projectbrief">Moodle 4.2.7+ (Build: 20240425) (7b172f51b99)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../d0/d96/classbackup__plan__dbops-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">backup_plan_dbops Class Reference<div class="ingroups"><a class="el" href="../../d6/d9f/group__moodlecore.html">moodlecore</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Non instantiable helper class providing <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a> support to the @backup_plan class.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for backup_plan_dbops:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d0c/classbackup__plan__dbops.png" usemap="#backup_5Fplan_5Fdbops_map" alt=""/>
  <map id="backup_5Fplan_5Fdbops_map" name="backup_5Fplan_5Fdbops_map">
<area href="../../d4/db4/classbackup__dbops.html" title="Base abstract class for all the helper classes providing DB operations." alt="backup_dbops" shape="rect" coords="0,0,125,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a310d3b4eb489af65b38d2f84775d4501" id="r_a310d3b4eb489af65b38d2f84775d4501"><td class="memItemLeft" align="right" valign="top"><a id="a310d3b4eb489af65b38d2f84775d4501" name="a310d3b4eb489af65b38d2f84775d4501"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_blockids_from_courseid</b> ($courseid)</td></tr>
<tr class="memdesc:a310d3b4eb489af65b38d2f84775d4501"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one course id, return one array with all the block intances that belong to it. <br /></td></tr>
<tr class="separator:a310d3b4eb489af65b38d2f84775d4501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c764e401a1a5c3eafd946182148ab1e" id="r_a3c764e401a1a5c3eafd946182148ab1e"><td class="memItemLeft" align="right" valign="top"><a id="a3c764e401a1a5c3eafd946182148ab1e" name="a3c764e401a1a5c3eafd946182148ab1e"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_blockids_from_moduleid</b> ($moduleid)</td></tr>
<tr class="memdesc:a3c764e401a1a5c3eafd946182148ab1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one course module id, return one array with all the block intances that belong to it. <br /></td></tr>
<tr class="separator:a3c764e401a1a5c3eafd946182148ab1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674e51c02dce36c3272ee2be7794bf73" id="r_a674e51c02dce36c3272ee2be7794bf73"><td class="memItemLeft" align="right" valign="top"><a id="a674e51c02dce36c3272ee2be7794bf73" name="a674e51c02dce36c3272ee2be7794bf73"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_courseformat_from_courseid</b> ($courseid)</td></tr>
<tr class="memdesc:a674e51c02dce36c3272ee2be7794bf73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one course id, return its format in <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a>. <br /></td></tr>
<tr class="separator:a674e51c02dce36c3272ee2be7794bf73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab35a2a60442b826d0ca0f0a6328d110a" id="r_ab35a2a60442b826d0ca0f0a6328d110a"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab35a2a60442b826d0ca0f0a6328d110a">get_default_backup_filename</a> ($format, $type, $id, $users, $anonymised, $useidonly=false, $files=true)</td></tr>
<tr class="memdesc:ab35a2a60442b826d0ca0f0a6328d110a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the default backup filename, based in passed params.  <br /></td></tr>
<tr class="separator:ab35a2a60442b826d0ca0f0a6328d110a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a599ce28f203f14141e5c3cdb45e87d39" id="r_a599ce28f203f14141e5c3cdb45e87d39"><td class="memItemLeft" align="right" valign="top"><a id="a599ce28f203f14141e5c3cdb45e87d39" name="a599ce28f203f14141e5c3cdb45e87d39"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_mnet_localhost_wwwroot</b> ()</td></tr>
<tr class="memdesc:a599ce28f203f14141e5c3cdb45e87d39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the wwwroot of the $CFG-&gt;mnet_localhost_id host caching it along the request. <br /></td></tr>
<tr class="separator:a599ce28f203f14141e5c3cdb45e87d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a760a8053250eb87ea5ada64af01105e4" id="r_a760a8053250eb87ea5ada64af01105e4"><td class="memItemLeft" align="right" valign="top"><a id="a760a8053250eb87ea5ada64af01105e4" name="a760a8053250eb87ea5ada64af01105e4"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_modules_from_sectionid</b> ($sectionid)</td></tr>
<tr class="memdesc:a760a8053250eb87ea5ada64af01105e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one section id, return one array with all the course modules that belong to it. <br /></td></tr>
<tr class="separator:a760a8053250eb87ea5ada64af01105e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a227f5f096fe0b28fcdc1e52256ee7100" id="r_a227f5f096fe0b28fcdc1e52256ee7100"><td class="memItemLeft" align="right" valign="top"><a id="a227f5f096fe0b28fcdc1e52256ee7100" name="a227f5f096fe0b28fcdc1e52256ee7100"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>get_sections_from_courseid</b> ($courseid)</td></tr>
<tr class="memdesc:a227f5f096fe0b28fcdc1e52256ee7100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one course id, return one array with all the course_sections belonging to it. <br /></td></tr>
<tr class="separator:a227f5f096fe0b28fcdc1e52256ee7100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44197cf5252b4ceceaaf09a145b57409" id="r_a44197cf5252b4ceceaaf09a145b57409"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44197cf5252b4ceceaaf09a145b57409">get_theme_from_courseid</a> ($courseid)</td></tr>
<tr class="memdesc:a44197cf5252b4ceceaaf09a145b57409"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a course id, returns its theme.  <br /></td></tr>
<tr class="separator:a44197cf5252b4ceceaaf09a145b57409"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd60c6475efb7a384e2761b8f6a290bb" id="r_afd60c6475efb7a384e2761b8f6a290bb"><td class="memItemLeft" align="right" valign="top"><a id="afd60c6475efb7a384e2761b8f6a290bb" name="afd60c6475efb7a384e2761b8f6a290bb"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>require_gradebook_backup</b> ($courseid, $backupid)</td></tr>
<tr class="memdesc:afd60c6475efb7a384e2761b8f6a290bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a flag indicating the need to backup gradebook elements like calculated grade items and category visibility If all activity related grade items are being backed up we can also backup calculated grade items and categories. <br /></td></tr>
<tr class="separator:afd60c6475efb7a384e2761b8f6a290bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Non instantiable helper class providing <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a> support to the @backup_plan class. </p>
<p>This class contains various static methods available for all the <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a> operations performed by the @backup_plan (and builder) classes</p>
<p>TODO: Finish phpdocs </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ab35a2a60442b826d0ca0f0a6328d110a" name="ab35a2a60442b826d0ca0f0a6328d110a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35a2a60442b826d0ca0f0a6328d110a">&#9670;&#160;</a></span>get_default_backup_filename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static backup_plan_dbops::get_default_backup_filename </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$format</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$id</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$users</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$anonymised</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$useidonly</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$files</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the default backup filename, based in passed params. </p>
<p>Default format is (see <a href="https://tracker.moodle.org/browse/MDL-22145" class="el">MDL-22145</a>) backup word - format - type - name - date - info . mbz where name is variable (course shortname, section name/id, activity modulename + cmid) and info can be (nu = no user info, an = anonymized). The last param $useidasname, defaulting to false, allows to replace the course shortname by the course id (used by automated backups, to avoid non-ascii chars in OS filesystem)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$format</td><td>One of backup::FORMAT_ </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$type</td><td>One of backup::TYPE_ </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$courseid,/$sectionid/$cmid</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$users</td><td>Should be true is users were included in the backup </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$anonymised</td><td>Should be true is user information was anonymized. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$useidonly</td><td>only use the ID in the file name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>The filename to use </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a44197cf5252b4ceceaaf09a145b57409" name="a44197cf5252b4ceceaaf09a145b57409"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44197cf5252b4ceceaaf09a145b57409">&#9670;&#160;</a></span>get_theme_from_courseid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static backup_plan_dbops::get_theme_from_courseid </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a course id, returns its theme. </p>
<p>This can either be the course theme or (if not specified in course) the category, site theme.</p>
<p>User, session, and inherited-from-mnet themes cannot have backed-up per course data. This is course-related data so it must be in a course theme specified as part of the course structure </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$courseid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>Name of course theme </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>moodle_page::resolve_theme() </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>backup/util/dbops/<b>backup_plan_dbops.class.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 28 2024 02:31:28 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
