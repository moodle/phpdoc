<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: question_engine_data_mapper Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.5</span>
   </div>
   <div id="projectbrief">Moodle 4.5dev (Build: 20240516) (f49d1207610)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../dd/d78/classquestion__engine__data__mapper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">question_engine_data_mapper Class Reference<div class="ingroups"><a class="el" href="../../de/d37/group__core__question.html">core_question</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>This class controls the loading and saving of question engine data to and from the database.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaa852e8bf904cc9a9e46b410502b3201" id="r_aaa852e8bf904cc9a9e46b410502b3201"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa852e8bf904cc9a9e46b410502b3201">__construct</a> (<a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a> $db=null)</td></tr>
<tr class="separator:aaa852e8bf904cc9a9e46b410502b3201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d71598061cece8b8d73618e473a9be6" id="r_a9d71598061cece8b8d73618e473a9be6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d71598061cece8b8d73618e473a9be6">combine_step_data</a> (array $stepdata)</td></tr>
<tr class="memdesc:a9d71598061cece8b8d73618e473a9be6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take an array of arrays, and flatten it, even if the outer array is empty.  <br /></td></tr>
<tr class="separator:a9d71598061cece8b8d73618e473a9be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a99f28abbd78e28bd4297958842866" id="r_a15a99f28abbd78e28bd4297958842866"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15a99f28abbd78e28bd4297958842866">delete_previews</a> ($questionid)</td></tr>
<tr class="memdesc:a15a99f28abbd78e28bd4297958842866"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete all the previews for a given question.  <br /></td></tr>
<tr class="separator:a15a99f28abbd78e28bd4297958842866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abadbd971aba5eb37b78871bca1d24f74" id="r_abadbd971aba5eb37b78871bca1d24f74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abadbd971aba5eb37b78871bca1d24f74">delete_questions_usage_by_activities</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:abadbd971aba5eb37b78871bca1d24f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a> and all its associated.  <br /></td></tr>
<tr class="separator:abadbd971aba5eb37b78871bca1d24f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4466b3ba8b319814b38e82a4e3398ad" id="r_aa4466b3ba8b319814b38e82a4e3398ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa4466b3ba8b319814b38e82a4e3398ad">delete_steps</a> ($stepids, $context)</td></tr>
<tr class="memdesc:aa4466b3ba8b319814b38e82a4e3398ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete some steps of a question attempt.  <br /></td></tr>
<tr class="separator:aa4466b3ba8b319814b38e82a4e3398ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8f4371d22078e3f7593f33114b1f839" id="r_ad8f4371d22078e3f7593f33114b1f839"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad8f4371d22078e3f7593f33114b1f839">in_summary_state_test</a> ($summarystate, $equal=true, $prefix='summarystates')</td></tr>
<tr class="memdesc:ad8f4371d22078e3f7593f33114b1f839"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the SQL needed to test that question_attempt_steps.state is in a state corresponding to $summarystate.  <br /></td></tr>
<tr class="separator:ad8f4371d22078e3f7593f33114b1f839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c0265ae9006e4cf01ef7d2cc6b19225" id="r_a0c0265ae9006e4cf01ef7d2cc6b19225"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c0265ae9006e4cf01ef7d2cc6b19225">insert_all_step_data</a> (array $rows)</td></tr>
<tr class="memdesc:a0c0265ae9006e4cf01ef7d2cc6b19225"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a lot of records into question_attempt_step_data in one go.  <br /></td></tr>
<tr class="separator:a0c0265ae9006e4cf01ef7d2cc6b19225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d10664f6a455e0981a59a55f1e5be4b" id="r_a0d10664f6a455e0981a59a55f1e5be4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0d10664f6a455e0981a59a55f1e5be4b">insert_question_attempt</a> (<a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> $qa, $context)</td></tr>
<tr class="memdesc:a0d10664f6a455e0981a59a55f1e5be4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store an entire <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database, including all the question_attempt_steps that comprise it.  <br /></td></tr>
<tr class="separator:a0d10664f6a455e0981a59a55f1e5be4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af778f0e3d2479f7c309c089c9ec8eb6b" id="r_af778f0e3d2479f7c309c089c9ec8eb6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af778f0e3d2479f7c309c089c9ec8eb6b">insert_question_attempt_metadata</a> (<a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> $qa, array $names)</td></tr>
<tr class="memdesc:af778f0e3d2479f7c309c089c9ec8eb6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store new metadata for an existing <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database.  <br /></td></tr>
<tr class="separator:af778f0e3d2479f7c309c089c9ec8eb6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a234cdd22982a6062cd348a83df970bfa" id="r_a234cdd22982a6062cd348a83df970bfa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a234cdd22982a6062cd348a83df970bfa">insert_question_attempt_step</a> (<a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> $step, $questionattemptid, $seq, $context)</td></tr>
<tr class="memdesc:a234cdd22982a6062cd348a83df970bfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> in the database.  <br /></td></tr>
<tr class="separator:a234cdd22982a6062cd348a83df970bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec1832500178cfa8bbab72815b8595c" id="r_a8ec1832500178cfa8bbab72815b8595c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ec1832500178cfa8bbab72815b8595c">insert_questions_usage_by_activity</a> (<a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> $quba)</td></tr>
<tr class="memdesc:a8ec1832500178cfa8bbab72815b8595c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store an entire <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> in the database, including all the question_attempts that comprise it.  <br /></td></tr>
<tr class="separator:a8ec1832500178cfa8bbab72815b8595c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d96395a79da612afc651d1577ddafb" id="r_ac7d96395a79da612afc651d1577ddafb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7d96395a79da612afc651d1577ddafb">latest_step_for_qa_subquery</a> ($questionattemptid='qa.id')</td></tr>
<tr class="memdesc:ac7d96395a79da612afc651d1577ddafb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the subquery which selects the latest step for each <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a>.  <br /></td></tr>
<tr class="separator:ac7d96395a79da612afc651d1577ddafb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7d70636fa72f3d2dc50b3948ffeaa9" id="r_a3f7d70636fa72f3d2dc50b3948ffeaa9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f7d70636fa72f3d2dc50b3948ffeaa9">load_attempts_at_question</a> ($questionid, <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a3f7d70636fa72f3d2dc50b3948ffeaa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all the attempts at a given queston from a set of question_usages.  <br /></td></tr>
<tr class="separator:a3f7d70636fa72f3d2dc50b3948ffeaa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc2d0c5a40b1b8f4706a5cca33b0e24" id="r_afcc2d0c5a40b1b8f4706a5cca33b0e24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afcc2d0c5a40b1b8f4706a5cca33b0e24">load_average_marks</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids, $slots=null)</td></tr>
<tr class="memdesc:afcc2d0c5a40b1b8f4706a5cca33b0e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load the average mark, and number of attempts, for each slot in a set of question usages.  <br /></td></tr>
<tr class="separator:afcc2d0c5a40b1b8f4706a5cca33b0e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdbb16b97c4050e437a82d11044e10cf" id="r_afdbb16b97c4050e437a82d11044e10cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afdbb16b97c4050e437a82d11044e10cf">load_question_attempt</a> ($questionattemptid)</td></tr>
<tr class="memdesc:afdbb16b97c4050e437a82d11044e10cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> from the database, including all its steps.  <br /></td></tr>
<tr class="separator:afdbb16b97c4050e437a82d11044e10cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fd359af35be843eb5e776127249e12f" id="r_a1fd359af35be843eb5e776127249e12f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fd359af35be843eb5e776127249e12f">load_question_attempt_step</a> ($stepid)</td></tr>
<tr class="memdesc:a1fd359af35be843eb5e776127249e12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> from the database.  <br /></td></tr>
<tr class="separator:a1fd359af35be843eb5e776127249e12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09031f841c333d1ed1383c85d3c28618" id="r_a09031f841c333d1ed1383c85d3c28618"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09031f841c333d1ed1383c85d3c28618">load_questions_usage_by_activity</a> ($qubaid)</td></tr>
<tr class="memdesc:a09031f841c333d1ed1383c85d3c28618"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> from the database, including all its <a class="el" href="../../d3/dda/classquestion__attempt.html">and all their steps. </a> <br /></td></tr>
<tr class="separator:a09031f841c333d1ed1383c85d3c28618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae198ef5c3aef9a3291ae76cf784dc8ff" id="r_ae198ef5c3aef9a3291ae76cf784dc8ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae198ef5c3aef9a3291ae76cf784dc8ff">load_questions_usages_by_activity</a> ($qubaids)</td></tr>
<tr class="memdesc:ae198ef5c3aef9a3291ae76cf784dc8ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load all <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> from the database for one <a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a> Include all its <a class="el" href="../../d3/dda/classquestion__attempt.html">and all their steps. </a> <br /></td></tr>
<tr class="separator:ae198ef5c3aef9a3291ae76cf784dc8ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f799e9c1f8f1d230f12cc75fd726fb9" id="r_a4f799e9c1f8f1d230f12cc75fd726fb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f799e9c1f8f1d230f12cc75fd726fb9">load_questions_usages_latest_steps</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids, $slots=null, $fields=null)</td></tr>
<tr class="memdesc:a4f799e9c1f8f1d230f12cc75fd726fb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load information about the latest state of each question from the database.  <br /></td></tr>
<tr class="separator:a4f799e9c1f8f1d230f12cc75fd726fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dcec6f9e4ed2f6e25c2099ce0b58018" id="r_a9dcec6f9e4ed2f6e25c2099ce0b58018"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9dcec6f9e4ed2f6e25c2099ce0b58018">load_questions_usages_question_state_summary</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids, $slots=null)</td></tr>
<tr class="memdesc:a9dcec6f9e4ed2f6e25c2099ce0b58018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load summary information about the state of each question in a group of attempts.  <br /></td></tr>
<tr class="separator:a9dcec6f9e4ed2f6e25c2099ce0b58018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf171921d5de3e5e601561db28e39ff0" id="r_acf171921d5de3e5e601561db28e39ff0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf171921d5de3e5e601561db28e39ff0">load_questions_usages_where_question_in_state</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids, $summarystate, $slot, $questionid=null, $orderby='random', $params=array(), $limitfrom=0, $limitnum=null, $extraselect='')</td></tr>
<tr class="memdesc:acf171921d5de3e5e601561db28e39ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a list of usage ids where the question with slot $slot, and optionally also with question id $questionid, is in summary state $summarystate.  <br /></td></tr>
<tr class="separator:acf171921d5de3e5e601561db28e39ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bdf9a60e35e0d60f104548416014818" id="r_a8bdf9a60e35e0d60f104548416014818"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8bdf9a60e35e0d60f104548416014818">load_used_variants</a> (array $questionids, <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a8bdf9a60e35e0d60f104548416014818"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of times each variant has been used for each question in a list in a set of usages.  <br /></td></tr>
<tr class="separator:a8bdf9a60e35e0d60f104548416014818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6244f883754250de006575e2b5515514" id="r_a6244f883754250de006575e2b5515514"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6244f883754250de006575e2b5515514">question_attempt_latest_state_view</a> ($alias, <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a6244f883754250de006575e2b5515514"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a subquery that returns the latest step of every qa in some qubas.  <br /></td></tr>
<tr class="separator:a6244f883754250de006575e2b5515514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad215907f47857a4a33ca44fc577d7964" id="r_ad215907f47857a4a33ca44fc577d7964"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad215907f47857a4a33ca44fc577d7964">questions_in_use</a> (array $questionids, <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:ad215907f47857a4a33ca44fc577d7964"><td class="mdescLeft">&#160;</td><td class="mdescRight">Are any of these questions are currently in use?  <br /></td></tr>
<tr class="separator:ad215907f47857a4a33ca44fc577d7964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e26bdcb3091ba8dc17e2f671024f8b" id="r_aa9e26bdcb3091ba8dc17e2f671024f8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9e26bdcb3091ba8dc17e2f671024f8b">set_max_mark_in_attempts</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids, $slot, $newmaxmark)</td></tr>
<tr class="memdesc:aa9e26bdcb3091ba8dc17e2f671024f8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the maxmark for the <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> with number in usage $slot for all the specified question_attempts.  <br /></td></tr>
<tr class="separator:aa9e26bdcb3091ba8dc17e2f671024f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a6730388e686068b7072a6fc381fd71" id="r_a0a6730388e686068b7072a6fc381fd71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a6730388e686068b7072a6fc381fd71">sum_usage_marks_subquery</a> ($qubaid)</td></tr>
<tr class="memdesc:a0a6730388e686068b7072a6fc381fd71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a sub-query that computes the sum of the marks for all the questions in a usage.  <br /></td></tr>
<tr class="separator:a0a6730388e686068b7072a6fc381fd71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20cb3e8db4a440df2d53e2902989f1e" id="r_ac20cb3e8db4a440df2d53e2902989f1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac20cb3e8db4a440df2d53e2902989f1e">update_question_attempt</a> (<a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> $qa)</td></tr>
<tr class="memdesc:ac20cb3e8db4a440df2d53e2902989f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update a question_attempts row to refect any changes in a <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> (but not any of its steps).  <br /></td></tr>
<tr class="separator:ac20cb3e8db4a440df2d53e2902989f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf171f937bfc69e4362bc831d64d7625" id="r_adf171f937bfc69e4362bc831d64d7625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf171f937bfc69e4362bc831d64d7625">update_question_attempt_flag</a> ($qubaid, $questionid, $qaid, $slot, $newstate)</td></tr>
<tr class="memdesc:adf171f937bfc69e4362bc831d64d7625"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the flagged state of a question in the database.  <br /></td></tr>
<tr class="separator:adf171f937bfc69e4362bc831d64d7625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235803ee9e1786de9cb27efd55bd9f80" id="r_a235803ee9e1786de9cb27efd55bd9f80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a235803ee9e1786de9cb27efd55bd9f80">update_question_attempt_metadata</a> (<a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> $qa, array $names)</td></tr>
<tr class="memdesc:a235803ee9e1786de9cb27efd55bd9f80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates existing metadata for an existing <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database.  <br /></td></tr>
<tr class="separator:a235803ee9e1786de9cb27efd55bd9f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf74d868e6b4433e76d2b8659d5316fe" id="r_adf74d868e6b4433e76d2b8659d5316fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf74d868e6b4433e76d2b8659d5316fe">update_question_attempt_step</a> (<a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> $step, $questionattemptid, $seq, $context)</td></tr>
<tr class="memdesc:adf74d868e6b4433e76d2b8659d5316fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> in the database.  <br /></td></tr>
<tr class="separator:adf74d868e6b4433e76d2b8659d5316fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e2fad4ef42eadc0f4c688c3a61b1b3" id="r_ad4e2fad4ef42eadc0f4c688c3a61b1b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4e2fad4ef42eadc0f4c688c3a61b1b3">update_questions_usage_by_activity</a> (<a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> $quba)</td></tr>
<tr class="memdesc:ad4e2fad4ef42eadc0f4c688c3a61b1b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update a question_usages row to refect any changes in a usage (but not any of its question_attempts.  <br /></td></tr>
<tr class="separator:ad4e2fad4ef42eadc0f4c688c3a61b1b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3dab41521e5d57f57ad0dbeb1c77990c" id="r_a3dab41521e5d57f57ad0dbeb1c77990c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3dab41521e5d57f57ad0dbeb1c77990c">delete_response_files</a> ($contextid, $itemidstest, $params)</td></tr>
<tr class="memdesc:a3dab41521e5d57f57ad0dbeb1c77990c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete all the files belonging to the response variables in the gives question attempt steps.  <br /></td></tr>
<tr class="separator:a3dab41521e5d57f57ad0dbeb1c77990c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b05c2829b965001863cc4429c6ecf3a" id="r_a4b05c2829b965001863cc4429c6ecf3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b05c2829b965001863cc4429c6ecf3a">delete_usage_records_for_mysql</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a4b05c2829b965001863cc4429c6ecf3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a work-around for poor <a class="el" href="../../d1/dd7/class_my_s_q_l.html" title="Caches data to a MySQL database.">MySQL</a> performance with DELETE FROM x WHERE id IN (SELECT ...).  <br /></td></tr>
<tr class="separator:a4b05c2829b965001863cc4429c6ecf3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee98ea9879969b5c315e92bceb0ce859" id="r_aee98ea9879969b5c315e92bceb0ce859"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee98ea9879969b5c315e92bceb0ce859">full_states_to_summary_state_sql</a> ()</td></tr>
<tr class="memdesc:aee98ea9879969b5c315e92bceb0ce859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all the WHEN 'x' THEN 'y' terms needed to convert the question_attempt_steps.state column to a summary state.  <br /></td></tr>
<tr class="separator:aee98ea9879969b5c315e92bceb0ce859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7070088877b115c8f8701f71c34f2801" id="r_a7070088877b115c8f8701f71c34f2801"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7070088877b115c8f8701f71c34f2801">make_step_record</a> (<a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> $step, $questionattemptid, $seq)</td></tr>
<tr class="memdesc:a7070088877b115c8f8701f71c34f2801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method used by insert_question_attempt_step and update_question_attempt_step.  <br /></td></tr>
<tr class="separator:a7070088877b115c8f8701f71c34f2801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a09f03f64ea042811255c89e524599" id="r_a56a09f03f64ea042811255c89e524599"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56a09f03f64ea042811255c89e524599">prepare_step_data</a> (<a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> $step, $stepid, $context)</td></tr>
<tr class="memdesc:a56a09f03f64ea042811255c89e524599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method used by insert_question_attempt_step and update_question_attempt_step.  <br /></td></tr>
<tr class="separator:a56a09f03f64ea042811255c89e524599"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a75189b8d3d89e18ad06c496abc8ba378" id="r_a75189b8d3d89e18ad06c496abc8ba378"><td class="memItemLeft" align="right" valign="top"><a id="a75189b8d3d89e18ad06c496abc8ba378" name="a75189b8d3d89e18ad06c496abc8ba378"></a>
<a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a>&#160;</td><td class="memItemRight" valign="bottom"><b>$db</b></td></tr>
<tr class="memdesc:a75189b8d3d89e18ad06c496abc8ba378"><td class="mdescLeft">&#160;</td><td class="mdescRight">normally points to global $DB, but I prefer not to use globals if I can help it. <br /></td></tr>
<tr class="separator:a75189b8d3d89e18ad06c496abc8ba378"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class controls the loading and saving of question engine data to and from the database. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2009 The Open University </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aaa852e8bf904cc9a9e46b410502b3201" name="aaa852e8bf904cc9a9e46b410502b3201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa852e8bf904cc9a9e46b410502b3201">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::__construct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a></td>          <td class="paramname"><span class="paramname"><em>$db</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d3/d6e/classmoodle__database.html" title="Abstract class representing moodle database interface.">moodle_database</a></td><td class="paramname">$db</td><td>a database connectoin. Defaults to global $DB. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9d71598061cece8b8d73618e473a9be6" name="a9d71598061cece8b8d73618e473a9be6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d71598061cece8b8d73618e473a9be6">&#9670;&#160;</a></span>combine_step_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::combine_step_data </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$stepdata</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take an array of arrays, and flatten it, even if the outer array is empty. </p>
<p>Only public so it can be called from the unit of work. Not part of the public API of this class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$stepdata</td><td>array of zero or more arrays. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>made by concatenating all the separate arrays. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a15a99f28abbd78e28bd4297958842866" name="a15a99f28abbd78e28bd4297958842866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15a99f28abbd78e28bd4297958842866">&#9670;&#160;</a></span>delete_previews()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::delete_previews </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete all the previews for a given question. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$questionid</td><td>question id. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abadbd971aba5eb37b78871bca1d24f74" name="abadbd971aba5eb37b78871bca1d24f74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abadbd971aba5eb37b78871bca1d24f74">&#9670;&#160;</a></span>delete_questions_usage_by_activities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::delete_questions_usage_by_activities </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a> and all its associated. </p>
<p>You should not call this method directly. You should use @externalurl question_engine::delete_questions_usage_by_activities()}.</p>
<p><a class="el" href="">question_attempts</a> and <a class="el" href="">question_attempt_steps</a> from the database. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>identifies which question useages to delete. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3dab41521e5d57f57ad0dbeb1c77990c" name="a3dab41521e5d57f57ad0dbeb1c77990c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dab41521e5d57f57ad0dbeb1c77990c">&#9670;&#160;</a></span>delete_response_files()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::delete_response_files </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$itemidstest</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$params</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delete all the files belonging to the response variables in the gives question attempt steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td>the context these attempts belong to. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$itemidstest</td><td>a bit of SQL that can be used in a WHERE itemid $itemidstest clause. Must use named params. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>any query parameters used in $itemidstest. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa4466b3ba8b319814b38e82a4e3398ad" name="aa4466b3ba8b319814b38e82a4e3398ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4466b3ba8b319814b38e82a4e3398ad">&#9670;&#160;</a></span>delete_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::delete_steps </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$stepids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete some steps of a question attempt. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$stepids</td><td>array of step ids to delete. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context that the $quba belongs to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4b05c2829b965001863cc4429c6ecf3a" name="a4b05c2829b965001863cc4429c6ecf3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b05c2829b965001863cc4429c6ecf3a">&#9670;&#160;</a></span>delete_usage_records_for_mysql()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::delete_usage_records_for_mysql </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is a work-around for poor <a class="el" href="../../d1/dd7/class_my_s_q_l.html" title="Caches data to a MySQL database.">MySQL</a> performance with DELETE FROM x WHERE id IN (SELECT ...). </p>
<p>We have to use a non-standard syntax to get good performance. See <a href="https://tracker.moodle.org/browse/MDL-29520" class="el">MDL-29520</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>identifies which question useages to delete. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aee98ea9879969b5c315e92bceb0ce859" name="aee98ea9879969b5c315e92bceb0ce859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee98ea9879969b5c315e92bceb0ce859">&#9670;&#160;</a></span>full_states_to_summary_state_sql()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::full_states_to_summary_state_sql </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all the WHEN 'x' THEN 'y' terms needed to convert the question_attempt_steps.state column to a summary state. </p>
<p>Use this like CASE qas.state {$this-&gt;full_states_to_summary_state_sql()} END AS summarystate,</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>SQL fragment. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad8f4371d22078e3f7593f33114b1f839" name="ad8f4371d22078e3f7593f33114b1f839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8f4371d22078e3f7593f33114b1f839">&#9670;&#160;</a></span>in_summary_state_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::in_summary_state_test </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$summarystate</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$equal</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$prefix</em><span class="paramdefsep"> = </span><span class="paramdefval">'summarystates'</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the SQL needed to test that question_attempt_steps.state is in a state corresponding to $summarystate. </p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$summarystate</td><td>one of inprogress, needsgrading, manuallygraded or autograded </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$equal</td><td>if false, do a NOT IN test. Default true. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$prefix</td><td>used in the call to $DB-&gt;get_in_or_equal(). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>as returned by $DB-&gt;get_in_or_equal(). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c0265ae9006e4cf01ef7d2cc6b19225" name="a0c0265ae9006e4cf01ef7d2cc6b19225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c0265ae9006e4cf01ef7d2cc6b19225">&#9670;&#160;</a></span>insert_all_step_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::insert_all_step_data </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$rows</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a lot of records into question_attempt_step_data in one go. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$rows</td><td>the rows to insert. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0d10664f6a455e0981a59a55f1e5be4b" name="a0d10664f6a455e0981a59a55f1e5be4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d10664f6a455e0981a59a55f1e5be4b">&#9670;&#160;</a></span>insert_question_attempt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::insert_question_attempt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a></td>          <td class="paramname"><span class="paramname"><em>$qa</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store an entire <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database, including all the question_attempt_steps that comprise it. </p>
<p>You should not call this method directly. You should use @externalurl question_engine::save_questions_usage_by_activity()}.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a></td><td class="paramname">$qa</td><td>the question attempt to store. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context of the owning <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af778f0e3d2479f7c309c089c9ec8eb6b" name="af778f0e3d2479f7c309c089c9ec8eb6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af778f0e3d2479f7c309c089c9ec8eb6b">&#9670;&#160;</a></span>insert_question_attempt_metadata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::insert_question_attempt_metadata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a></td>          <td class="paramname"><span class="paramname"><em>$qa</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$names</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store new metadata for an existing <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a></td><td class="paramname">$qa</td><td>the question attempt to store meta data for. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$names</td><td>the names of the metadata variables to store. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a234cdd22982a6062cd348a83df970bfa" name="a234cdd22982a6062cd348a83df970bfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234cdd22982a6062cd348a83df970bfa">&#9670;&#160;</a></span>insert_question_attempt_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::insert_question_attempt_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a></td>          <td class="paramname"><span class="paramname"><em>$step</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionattemptid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$seq</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> in the database. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html" title="Stores one step in a {.">question_attempt_step</a></td><td class="paramname">$step</td><td>the step to store. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$questionattemptid</td><td>the question attept id this step belongs to. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$seq</td><td>the sequence number of this stop. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context of the owning <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8ec1832500178cfa8bbab72815b8595c" name="a8ec1832500178cfa8bbab72815b8595c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec1832500178cfa8bbab72815b8595c">&#9670;&#160;</a></span>insert_questions_usage_by_activity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::insert_questions_usage_by_activity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a></td>          <td class="paramname"><span class="paramname"><em>$quba</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store an entire <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> in the database, including all the question_attempts that comprise it. </p>
<p>You should not call this method directly. You should use @externalurl question_engine::save_questions_usage_by_activity()}.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a></td><td class="paramname">$quba</td><td>the usage to store. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac7d96395a79da612afc651d1577ddafb" name="ac7d96395a79da612afc651d1577ddafb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d96395a79da612afc651d1577ddafb">&#9670;&#160;</a></span>latest_step_for_qa_subquery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::latest_step_for_qa_subquery </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionattemptid</em><span class="paramdefsep"> = </span><span class="paramdefval">'qa.id'</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the subquery which selects the latest step for each <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$questionattemptid</td><td>column alias for the column to join on which is question_attempt.id. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>SQL fragment to include in the query. Has not placeholders. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3f7d70636fa72f3d2dc50b3948ffeaa9" name="a3f7d70636fa72f3d2dc50b3948ffeaa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f7d70636fa72f3d2dc50b3948ffeaa9">&#9670;&#160;</a></span>load_attempts_at_question()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_attempts_at_question </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load all the attempts at a given queston from a set of question_usages. </p>
<p>steps.</p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$questionid</td><td>the question to load all the attempts fors. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>used to restrict which usages are included in the query. See <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">question_attempt[]</td><td>array of question_attempts that were loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afcc2d0c5a40b1b8f4706a5cca33b0e24" name="afcc2d0c5a40b1b8f4706a5cca33b0e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc2d0c5a40b1b8f4706a5cca33b0e24">&#9670;&#160;</a></span>load_average_marks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_average_marks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slots</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load the average mark, and number of attempts, for each slot in a set of question usages. </p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>used to restrict which usages are included in the query. See <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a>. </td></tr>
    <tr><td class="paramtype">array&#160;|&#160;null</td><td class="paramname">$slots</td><td>if null, load info for all quesitions, otherwise only load the averages for the specified questions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of objects with fields -&gt;slot, -&gt;averagefraction and -&gt;numaveraged. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afdbb16b97c4050e437a82d11044e10cf" name="afdbb16b97c4050e437a82d11044e10cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdbb16b97c4050e437a82d11044e10cf">&#9670;&#160;</a></span>load_question_attempt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_question_attempt </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionattemptid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> from the database, including all its steps. </p>
<p>Normally, you should use <a class="el" href="">question_engine::load_questions_usage_by_activity()</a> but there may be rare occasions where for performance reasons, you only wish to load one qa, in which case you may call this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$questionattemptid</td><td>the id of the question attempt to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a></td><td>the question attempt that was loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1fd359af35be843eb5e776127249e12f" name="a1fd359af35be843eb5e776127249e12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fd359af35be843eb5e776127249e12f">&#9670;&#160;</a></span>load_question_attempt_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_question_attempt_step </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$stepid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> from the database. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$stepid</td><td>the id of the step to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../df/db2/classquestion__attempt__step.html" title="Stores one step in a {.">question_attempt_step</a></td><td>the step that was loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a09031f841c333d1ed1383c85d3c28618" name="a09031f841c333d1ed1383c85d3c28618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09031f841c333d1ed1383c85d3c28618">&#9670;&#160;</a></span>load_questions_usage_by_activity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_questions_usage_by_activity </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$qubaid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load a <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> from the database, including all its <a class="el" href="../../d3/dda/classquestion__attempt.html">and all their steps. </a></p>
<p>You should call <a class="el" href="">question_engine::load_questions_usage_by_activity()</a> rather than calling this method directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$qubaid</td><td>the id of the usage to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a></td><td>the usage that was loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae198ef5c3aef9a3291ae76cf784dc8ff" name="ae198ef5c3aef9a3291ae76cf784dc8ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae198ef5c3aef9a3291ae76cf784dc8ff">&#9670;&#160;</a></span>load_questions_usages_by_activity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_questions_usages_by_activity </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load all <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> from the database for one <a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a> Include all its <a class="el" href="../../d3/dda/classquestion__attempt.html">and all their steps. </a></p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>the condition that tells us which usages to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">question_usage_by_activity[]</td><td>the usages that were loaded. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f799e9c1f8f1d230f12cc75fd726fb9" name="a4f799e9c1f8f1d230f12cc75fd726fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f799e9c1f8f1d230f12cc75fd726fb9">&#9670;&#160;</a></span>load_questions_usages_latest_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_questions_usages_latest_steps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slots</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fields</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load information about the latest state of each question from the database. </p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>used to restrict which usages are included in the query. See <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a>. </td></tr>
    <tr><td class="paramtype">array&#160;|&#160;null</td><td class="paramname">$slots</td><td>(optional) list of slots for which to return information. Default all slots. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$fields</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of records. See the SQL in this function to see the fields available. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9dcec6f9e4ed2f6e25c2099ce0b58018" name="a9dcec6f9e4ed2f6e25c2099ce0b58018"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dcec6f9e4ed2f6e25c2099ce0b58018">&#9670;&#160;</a></span>load_questions_usages_question_state_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_questions_usages_question_state_summary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slots</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load summary information about the state of each question in a group of attempts. </p>
<p>This is used, for example, by the quiz manual grading report, to show how many attempts at each question need to be graded.</p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>used to restrict which usages are included in the query. See <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a>. </td></tr>
    <tr><td class="paramtype">array&#160;|&#160;null</td><td class="paramname">$slots</td><td>(optional) list of slots for which to return information. Default all slots. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>The array keys are 'slot,questionid'. The values are objects with fields $slot, $questionid, $inprogress, $name, $needsgrading, $autograded, $manuallygraded and $all. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acf171921d5de3e5e601561db28e39ff0" name="acf171921d5de3e5e601561db28e39ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf171921d5de3e5e601561db28e39ff0">&#9670;&#160;</a></span>load_questions_usages_where_question_in_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_questions_usages_where_question_in_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$summarystate</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slot</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$orderby</em><span class="paramdefsep"> = </span><span class="paramdefval">'random'</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$params</em><span class="paramdefsep"> = </span><span class="paramdefval">array()</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitfrom</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitnum</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$extraselect</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a list of usage ids where the question with slot $slot, and optionally also with question id $questionid, is in summary state $summarystate. </p>
<p>Also return the total count of such states.</p>
<p>Only a subset of the ids can be returned by using $orderby, $limitfrom and $limitnum. A special value 'random' can be passed as $orderby, in which case $limitfrom is ignored.</p>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>used to restrict which usages are included in the query. See <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a>. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$slot</td><td>The slot for the questions you want to know about. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$questionid</td><td>(optional) Only return attempts that were of this specific question. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$summarystate</td><td>the summary state of interest, or 'all'. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$orderby</td><td>the column to order by. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>any params required by any of the SQL fragments. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limitfrom</td><td>implements paging of the results. Ignored if $orderby = random or $limitnum is null. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limitnum</td><td>implements paging of the results. null = all. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$extraselect</td><td>anything passed here will be added to the SELECT list, use this to return extra data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>with two elements, an array of usage ids, and a count of the total number. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8bdf9a60e35e0d60f104548416014818" name="a8bdf9a60e35e0d60f104548416014818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bdf9a60e35e0d60f104548416014818">&#9670;&#160;</a></span>load_used_variants()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::load_used_variants </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$questionids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the number of times each variant has been used for each question in a list in a set of usages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$questionids</td><td>of question ids. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>ids of the usages to consider. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>questionid =&gt; variant number =&gt; num uses. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7070088877b115c8f8701f71c34f2801" name="a7070088877b115c8f8701f71c34f2801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7070088877b115c8f8701f71c34f2801">&#9670;&#160;</a></span>make_step_record()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::make_step_record </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a></td>          <td class="paramname"><span class="paramname"><em>$step</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionattemptid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$seq</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper method used by insert_question_attempt_step and update_question_attempt_step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html" title="Stores one step in a {.">question_attempt_step</a></td><td class="paramname">$step</td><td>the step to store. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$questionattemptid</td><td>the question attept id this step belongs to. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$seq</td><td>the sequence number of this stop. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>data to insert into the database. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a56a09f03f64ea042811255c89e524599" name="a56a09f03f64ea042811255c89e524599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a09f03f64ea042811255c89e524599">&#9670;&#160;</a></span>prepare_step_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::prepare_step_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a></td>          <td class="paramname"><span class="paramname"><em>$step</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$stepid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper method used by insert_question_attempt_step and update_question_attempt_step. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html" title="Stores one step in a {.">question_attempt_step</a></td><td class="paramname">$step</td><td>the step to store. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$stepid</td><td>the id of the step. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context of the owning <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6244f883754250de006575e2b5515514" name="a6244f883754250de006575e2b5515514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6244f883754250de006575e2b5515514">&#9670;&#160;</a></span>question_attempt_latest_state_view()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::question_attempt_latest_state_view </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$alias</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a subquery that returns the latest step of every qa in some qubas. </p>
<p>Currently, this is only used by the quiz reports. See {</p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d4/de0/classmod__quiz_1_1local_1_1reports_1_1attempts__report__table.html#aebc23c314a40afedff6d9f2649a3867b" title="Add the information about the latest state of the question with slot $slot to the query.">mod_quiz::local::reports::attempts_report_table::add_latest_state_join()</a>}.</dd></dl>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$alias</td><td>alias to use for this inline-view. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>restriction on which question_usages we are interested in. This is important for performance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>with two elements, the SQL fragment and any params requried. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad215907f47857a4a33ca44fc577d7964" name="ad215907f47857a4a33ca44fc577d7964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad215907f47857a4a33ca44fc577d7964">&#9670;&#160;</a></span>questions_in_use()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::questions_in_use </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$questionids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Are any of these questions are currently in use? </p>
<p>You should call <a class="el" href="">question_engine::questions_in_use()</a> rather than calling this method directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$questionids</td><td>of question ids. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>ids of the usages to consider. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether any of these questions are being used by any of those usages. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa9e26bdcb3091ba8dc17e2f671024f8b" name="aa9e26bdcb3091ba8dc17e2f671024f8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e26bdcb3091ba8dc17e2f671024f8b">&#9670;&#160;</a></span>set_max_mark_in_attempts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::set_max_mark_in_attempts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slot</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newmaxmark</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the maxmark for the <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> with number in usage $slot for all the specified question_attempts. </p>
<p>You should call <a class="el" href="">question_engine::set_max_mark_in_attempts()</a> rather than calling this method directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>Selects which usages are updated. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$slot</td><td>the number is usage to affect. </td></tr>
    <tr><td class="paramtype">number</td><td class="paramname">$newmaxmark</td><td>the new max mark to set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0a6730388e686068b7072a6fc381fd71" name="a0a6730388e686068b7072a6fc381fd71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6730388e686068b7072a6fc381fd71">&#9670;&#160;</a></span>sum_usage_marks_subquery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::sum_usage_marks_subquery </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$qubaid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a sub-query that computes the sum of the marks for all the questions in a usage. </p>
<p>Which usage to compute the sum for is controlled by the $qubaid parameter.</p>
<p>See {</p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d1/dc7/classmod__quiz_1_1grade__calculator.html#a31f1d456ca7ba97c985b7e39af5c6f07" title="Update the sumgrades field of attempts at this quiz.">mod_quiz::grade_calculator::recompute_all_attempt_sumgrades()</a>} for an example of the usage of this method.</dd></dl>
<p>This method may be called publicly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$qubaid</td><td>SQL fragment that controls which usage is summed. This will normally be the name of a column in the outer query. Not that this SQL fragment must not contain any placeholders. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>SQL code for the subquery. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac20cb3e8db4a440df2d53e2902989f1e" name="ac20cb3e8db4a440df2d53e2902989f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20cb3e8db4a440df2d53e2902989f1e">&#9670;&#160;</a></span>update_question_attempt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::update_question_attempt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a></td>          <td class="paramname"><span class="paramname"><em>$qa</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update a question_attempts row to refect any changes in a <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> (but not any of its steps). </p>
<p>You should not call this method directly. You should use @externalurl question_engine::save_questions_usage_by_activity()}.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a></td><td class="paramname">$qa</td><td>the question attempt that has changed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adf171f937bfc69e4362bc831d64d7625" name="adf171f937bfc69e4362bc831d64d7625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf171f937bfc69e4362bc831d64d7625">&#9670;&#160;</a></span>update_question_attempt_flag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::update_question_attempt_flag </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$qubaid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$qaid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$slot</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newstate</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the flagged state of a question in the database. </p>
<p>You should call <a class="el" href="">question_engine::update_flag()()</a> rather than calling this method directly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$qubaid</td><td>the question usage id. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$questionid</td><td>the question id. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$qaid</td><td>the <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> id. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$slot</td><td>the slot number of the question attempt to update. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$newstate</td><td>the new state of the flag. true = flagged. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a235803ee9e1786de9cb27efd55bd9f80" name="a235803ee9e1786de9cb27efd55bd9f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a235803ee9e1786de9cb27efd55bd9f80">&#9670;&#160;</a></span>update_question_attempt_metadata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::update_question_attempt_metadata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a></td>          <td class="paramname"><span class="paramname"><em>$qa</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$names</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates existing metadata for an existing <a class="el" href="../../d3/dda/classquestion__attempt.html">question_attempt</a> in the database. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a></td><td class="paramname">$qa</td><td>the question attempt to store meta data for. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$names</td><td>the names of the metadata variables to store. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adf74d868e6b4433e76d2b8659d5316fe" name="adf74d868e6b4433e76d2b8659d5316fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf74d868e6b4433e76d2b8659d5316fe">&#9670;&#160;</a></span>update_question_attempt_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::update_question_attempt_step </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a></td>          <td class="paramname"><span class="paramname"><em>$step</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$questionattemptid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$seq</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update a <a class="el" href="../../df/db2/classquestion__attempt__step.html">question_attempt_step</a> in the database. </p>
<p>Private method, only for use by other parts of the question engine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../df/db2/classquestion__attempt__step.html" title="Stores one step in a {.">question_attempt_step</a></td><td class="paramname">$step</td><td>the step to store. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$questionattemptid</td><td>the question attept id this step belongs to. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$seq</td><td>the sequence number of this stop. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context of the owning <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of question_attempt_step_data rows, that still need to be inserted. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad4e2fad4ef42eadc0f4c688c3a61b1b3" name="ad4e2fad4ef42eadc0f4c688c3a61b1b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e2fad4ef42eadc0f4c688c3a61b1b3">&#9670;&#160;</a></span>update_questions_usage_by_activity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">question_engine_data_mapper::update_questions_usage_by_activity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a></td>          <td class="paramname"><span class="paramname"><em>$quba</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update a question_usages row to refect any changes in a usage (but not any of its question_attempts. </p>
<p>You should not call this method directly. You should use @externalurl question_engine::save_questions_usage_by_activity()}.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a></td><td class="paramname">$quba</td><td>the usage that has changed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>question/engine/<b>datalib.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 19 2024 02:47:11 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
