<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: restore_course_structure_step Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.1</span>
   </div>
   <div id="projectbrief">Moodle 4.1.11 (Build: 20240610) (c8c84b4af18)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search',false);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../df/dcd/classrestore__course__structure__step-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">restore_course_structure_step Class Reference<div class="ingroups"><a class="el" href="../../d5/d0a/group__core__backup.html">core_backup</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Structure step that will read the course.xml file, loading it and performing various actions depending of the site/restore settings.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for restore_course_structure_step:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../de/d6b/classrestore__course__structure__step.png" usemap="#restore_5Fcourse_5Fstructure_5Fstep_map" alt=""/>
  <map id="restore_5Fcourse_5Fstructure_5Fstep_map" name="restore_5Fcourse_5Fstructure_5Fstep_map">
<area href="../../d9/dcb/classrestore__structure__step.html" title="Abstract class defining the needed stuff to restore one xml file." alt="restore_structure_step" shape="rect" coords="97,168,282,192"/>
<area href="../../db/d9b/classrestore__step.html" title="Abstract class defining the needed stuf for one restore step." alt="restore_step" shape="rect" coords="97,112,282,136"/>
<area href="../../d3/dbd/classbase__step.html" title="Abstract class defining the basis for one execution (backup/restore) step." alt="base_step" shape="rect" coords="97,56,282,80"/>
<area href="../../df/dc9/interfaceexecutable.html" title="Interface to apply to all the classes we want to be executable (plan/part/task)" alt="executable" shape="rect" coords="0,0,185,24"/>
<area href="../../d8/dda/interfaceloggable.html" title="Interface to apply to all the classes we want to be able to write to logs." alt="loggable" shape="rect" coords="195,0,380,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a55585469af6127126d913e7152c7bf2b" id="r_a55585469af6127126d913e7152c7bf2b"><td class="memItemLeft" align="right" valign="top"><a id="a55585469af6127126d913e7152c7bf2b" name="a55585469af6127126d913e7152c7bf2b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>add_related_files</b> ($component, $filearea, $mappingitemname, $filesctxid=null, $olditemid=null)</td></tr>
<tr class="memdesc:a55585469af6127126d913e7152c7bf2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add all the existing file, given their component and filearea and one backup_ids itemname to match with. <br /></td></tr>
<tr class="separator:a55585469af6127126d913e7152c7bf2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c70f0c7596f5500981002a1a9df027d" id="r_a9c70f0c7596f5500981002a1a9df027d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/classrestore__step.html#a9c70f0c7596f5500981002a1a9df027d">apply_date_offset</a> ($<a class="el" href="../../d8/ded/group___simple_pie.html#gaefbfa229f1c9e1fc967bff724a010f9e">value</a>)</td></tr>
<tr class="memdesc:a9c70f0c7596f5500981002a1a9df027d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply course startdate offset based in original course startdate and course_offset_startdate setting Note we are using one static cache here, but <em>by restoreid</em>, so it's ok for concurrence/multiple executions in the same request.  <br /></td></tr>
<tr class="separator:a9c70f0c7596f5500981002a1a9df027d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb820ae8d44addb02d4e18a5cf6f28fc" id="r_afb820ae8d44addb02d4e18a5cf6f28fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9b/classrestore__step.html#afb820ae8d44addb02d4e18a5cf6f28fc">decrypt</a> ($<a class="el" href="../../d8/ded/group___simple_pie.html#gaefbfa229f1c9e1fc967bff724a010f9e">value</a>)</td></tr>
<tr class="memdesc:afb820ae8d44addb02d4e18a5cf6f28fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns symmetric-key AES-256 decryption of base64 encoded contents.  <br /></td></tr>
<tr class="separator:afb820ae8d44addb02d4e18a5cf6f28fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c8c82d27e1aa5991a685e1ca13a47d" id="r_a35c8c82d27e1aa5991a685e1ca13a47d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dbd/classbase__step.html#a35c8c82d27e1aa5991a685e1ca13a47d">destroy</a> ()</td></tr>
<tr class="memdesc:a35c8c82d27e1aa5991a685e1ca13a47d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy all circular references.  <br /></td></tr>
<tr class="separator:a35c8c82d27e1aa5991a685e1ca13a47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3912e58d4837bab006658938f33dac" id="r_a2a3912e58d4837bab006658938f33dac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#a2a3912e58d4837bab006658938f33dac">execute</a> ()</td></tr>
<tr class="memdesc:a2a3912e58d4837bab006658938f33dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will perform all the actions necessary to achieve the execution of the plan/part/task.  <br /></td></tr>
<tr class="separator:a2a3912e58d4837bab006658938f33dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890609829390748a66aa74dbbcd8d4b2" id="r_a890609829390748a66aa74dbbcd8d4b2"><td class="memItemLeft" align="right" valign="top"><a id="a890609829390748a66aa74dbbcd8d4b2" name="a890609829390748a66aa74dbbcd8d4b2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_mapping</b> ($itemname, $oldid)</td></tr>
<tr class="memdesc:a890609829390748a66aa74dbbcd8d4b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the complete mapping from the given itemname, itemid. <br /></td></tr>
<tr class="separator:a890609829390748a66aa74dbbcd8d4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac09d6de4de95edad9da7972f6eddea25" id="r_ac09d6de4de95edad9da7972f6eddea25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#ac09d6de4de95edad9da7972f6eddea25">get_mappingid</a> ($itemname, $oldid, $ifnotfound=false)</td></tr>
<tr class="memdesc:ac09d6de4de95edad9da7972f6eddea25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the new id of a mapping for the given itemname.  <br /></td></tr>
<tr class="separator:ac09d6de4de95edad9da7972f6eddea25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09adb3eeebb1589cdfe5983d938d600" id="r_aa09adb3eeebb1589cdfe5983d938d600"><td class="memItemLeft" align="right" valign="top"><a id="aa09adb3eeebb1589cdfe5983d938d600" name="aa09adb3eeebb1589cdfe5983d938d600"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_name</b> ()</td></tr>
<tr class="separator:aa09adb3eeebb1589cdfe5983d938d600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcaff513ccf9479c801c71b4293f394f" id="r_abcaff513ccf9479c801c71b4293f394f"><td class="memItemLeft" align="right" valign="top"><a id="abcaff513ccf9479c801c71b4293f394f" name="abcaff513ccf9479c801c71b4293f394f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_new_parentid</b> ($itemname)</td></tr>
<tr class="memdesc:abcaff513ccf9479c801c71b4293f394f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the latest (parent) new id mapped by one pathelement. <br /></td></tr>
<tr class="separator:abcaff513ccf9479c801c71b4293f394f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae846db96de5559b0e5e6603d9ed8d15a" id="r_ae846db96de5559b0e5e6603d9ed8d15a"><td class="memItemLeft" align="right" valign="top"><a id="ae846db96de5559b0e5e6603d9ed8d15a" name="ae846db96de5559b0e5e6603d9ed8d15a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_old_parentid</b> ($itemname)</td></tr>
<tr class="memdesc:ae846db96de5559b0e5e6603d9ed8d15a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the latest (parent) old id mapped by one pathelement. <br /></td></tr>
<tr class="separator:ae846db96de5559b0e5e6603d9ed8d15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f8755a3fc8e4a8afd4a385b2016920" id="r_ae3f8755a3fc8e4a8afd4a385b2016920"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#ae3f8755a3fc8e4a8afd4a385b2016920">get_task</a> ()</td></tr>
<tr class="memdesc:ae3f8755a3fc8e4a8afd4a385b2016920"><td class="mdescLeft">&#160;</td><td class="mdescRight">As far as restore structure steps are implementing <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> stuff, they need to have the parent task available for wrapping purposes (get course/context....)  <br /></td></tr>
<tr class="separator:ae3f8755a3fc8e4a8afd4a385b2016920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3585480af09452a3c038ea822a309300" id="r_a3585480af09452a3c038ea822a309300"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#a3585480af09452a3c038ea822a309300">grouped_parent_exists</a> ($pelement, $elements)</td></tr>
<tr class="memdesc:a3585480af09452a3c038ea822a309300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given one pathelement, return true if grouped parent was found.  <br /></td></tr>
<tr class="separator:a3585480af09452a3c038ea822a309300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28041330e9811d34f76d61cd4bc8d21" id="r_ae28041330e9811d34f76d61cd4bc8d21"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#ae28041330e9811d34f76d61cd4bc8d21">launch_after_restore_methods</a> ()</td></tr>
<tr class="memdesc:ae28041330e9811d34f76d61cd4bc8d21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch all the after_restore methods present in all the processing objects.  <br /></td></tr>
<tr class="separator:ae28041330e9811d34f76d61cd4bc8d21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac849571ff5893405cd4b0be044779678" id="r_ac849571ff5893405cd4b0be044779678"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dbd/classbase__step.html#ac849571ff5893405cd4b0be044779678">log</a> ($message, $level, $a=null, $depth=null, $display=false)</td></tr>
<tr class="memdesc:ac849571ff5893405cd4b0be044779678"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will be responsible for handling the params, and to call to the corresponding logger-&gt;process() once all modifications in params have been performed.  <br /></td></tr>
<tr class="separator:ac849571ff5893405cd4b0be044779678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ea01f63c8ae143762c50675246188d" id="r_a11ea01f63c8ae143762c50675246188d"><td class="memItemLeft" align="right" valign="top"><a id="a11ea01f63c8ae143762c50675246188d" name="a11ea01f63c8ae143762c50675246188d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>process</b> ($data)</td></tr>
<tr class="memdesc:a11ea01f63c8ae143762c50675246188d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive one chunk of information form the xml parser processor and dispatch it, following the naming rules. <br /></td></tr>
<tr class="separator:a11ea01f63c8ae143762c50675246188d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba8593f544f78ca060459405bad7bbc5" id="r_aba8593f544f78ca060459405bad7bbc5"><td class="memItemLeft" align="right" valign="top"><a id="aba8593f544f78ca060459405bad7bbc5" name="aba8593f544f78ca060459405bad7bbc5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>process_allowed_module</b> ($data)</td></tr>
<tr class="separator:aba8593f544f78ca060459405bad7bbc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8012a9573933836a3fd8e1ef67221836" id="r_a8012a9573933836a3fd8e1ef67221836"><td class="memItemLeft" align="right" valign="top"><a id="a8012a9573933836a3fd8e1ef67221836" name="a8012a9573933836a3fd8e1ef67221836"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>process_category</b> ($data)</td></tr>
<tr class="separator:a8012a9573933836a3fd8e1ef67221836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab99b8dc772d3dcfa0f5506913fc393" id="r_afab99b8dc772d3dcfa0f5506913fc393"><td class="memItemLeft" align="right" valign="top">moodledatabase&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afab99b8dc772d3dcfa0f5506913fc393">process_course</a> ($data)</td></tr>
<tr class="memdesc:afab99b8dc772d3dcfa0f5506913fc393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processing functions go here.  <br /></td></tr>
<tr class="separator:afab99b8dc772d3dcfa0f5506913fc393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8945099cf6d1043939c81dd7d73ce9d3" id="r_a8945099cf6d1043939c81dd7d73ce9d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8945099cf6d1043939c81dd7d73ce9d3">process_course_format_option</a> (array $data)</td></tr>
<tr class="memdesc:a8945099cf6d1043939c81dd7d73ce9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes a course format option.  <br /></td></tr>
<tr class="separator:a8945099cf6d1043939c81dd7d73ce9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec21a705dad55b2ebe9b34ad519c83a" id="r_acec21a705dad55b2ebe9b34ad519c83a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acec21a705dad55b2ebe9b34ad519c83a">process_customfield</a> ($data)</td></tr>
<tr class="memdesc:acec21a705dad55b2ebe9b34ad519c83a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process custom fields.  <br /></td></tr>
<tr class="separator:acec21a705dad55b2ebe9b34ad519c83a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa91b4d9cd03e4bc2bf47f7e1c45d8692" id="r_aa91b4d9cd03e4bc2bf47f7e1c45d8692"><td class="memItemLeft" align="right" valign="top"><a id="aa91b4d9cd03e4bc2bf47f7e1c45d8692" name="aa91b4d9cd03e4bc2bf47f7e1c45d8692"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>process_tag</b> ($data)</td></tr>
<tr class="separator:aa91b4d9cd03e4bc2bf47f7e1c45d8692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad82dabee427613b2d9bbfa1e9dd28dd" id="r_aad82dabee427613b2d9bbfa1e9dd28dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#aad82dabee427613b2d9bbfa1e9dd28dd">set_mapping</a> ($itemname, $oldid, $newid, $restorefiles=false, $filesctxid=null, $parentid=null)</td></tr>
<tr class="memdesc:aad82dabee427613b2d9bbfa1e9dd28dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">To send ids pairs to backup_ids_table and to store them into paths.  <br /></td></tr>
<tr class="separator:aad82dabee427613b2d9bbfa1e9dd28dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26bcb34417b639aa1735729b598b536" id="r_ab26bcb34417b639aa1735729b598b536"><td class="memItemLeft" align="right" valign="top"><a id="ab26bcb34417b639aa1735729b598b536" name="ab26bcb34417b639aa1735729b598b536"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>set_task</b> ($task)</td></tr>
<tr class="separator:ab26bcb34417b639aa1735729b598b536"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a211ee2ab675b152d030e28ab71b210c9" id="r_a211ee2ab675b152d030e28ab71b210c9"><td class="memItemLeft" align="right" valign="top"><a id="a211ee2ab675b152d030e28ab71b210c9" name="a211ee2ab675b152d030e28ab71b210c9"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>SKIP_ALL_CHILDREN</b> = -991399</td></tr>
<tr class="separator:a211ee2ab675b152d030e28ab71b210c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2652dc3247c519c2bd3cb0083b5547ab" id="r_a2652dc3247c519c2bd3cb0083b5547ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#a2652dc3247c519c2bd3cb0083b5547ab">add_plugin_structure</a> ($plugintype, $element)</td></tr>
<tr class="memdesc:a2652dc3247c519c2bd3cb0083b5547ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add plugin structure to any element in the structure restore tree.  <br /></td></tr>
<tr class="separator:a2652dc3247c519c2bd3cb0083b5547ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad18b19ae3b919c22a5552548e95515f5" id="r_ad18b19ae3b919c22a5552548e95515f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#ad18b19ae3b919c22a5552548e95515f5">add_subplugin_structure</a> ($subplugintype, $element, $plugintype=null, $pluginname=null)</td></tr>
<tr class="memdesc:ad18b19ae3b919c22a5552548e95515f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add subplugin structure for a given plugin to any element in the structure restore tree.  <br /></td></tr>
<tr class="separator:ad18b19ae3b919c22a5552548e95515f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e9d80bcc6083705a17a022069d8d576" id="r_a1e9d80bcc6083705a17a022069d8d576"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1e9d80bcc6083705a17a022069d8d576">after_execute</a> ()</td></tr>
<tr class="memdesc:a1e9d80bcc6083705a17a022069d8d576"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method will be executed after the whole structure step have been processed.  <br /></td></tr>
<tr class="separator:a1e9d80bcc6083705a17a022069d8d576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d0e659d8eaafc1068d8eb0687afee5c" id="r_a2d0e659d8eaafc1068d8eb0687afee5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#a2d0e659d8eaafc1068d8eb0687afee5c">after_restore</a> ()</td></tr>
<tr class="memdesc:a2d0e659d8eaafc1068d8eb0687afee5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method will be executed after the rest of the restore has been processed.  <br /></td></tr>
<tr class="separator:a2d0e659d8eaafc1068d8eb0687afee5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3879750941d7a30cb142e4c32c9771" id="r_a8a3879750941d7a30cb142e4c32c9771"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a3879750941d7a30cb142e4c32c9771">define_structure</a> ()</td></tr>
<tr class="memdesc:a8a3879750941d7a30cb142e4c32c9771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that will return the structure to be processed by this <a class="el" href="../../db/d9b/classrestore__step.html" title="Abstract class defining the needed stuf for one restore step.">restore_step</a>.  <br /></td></tr>
<tr class="separator:a8a3879750941d7a30cb142e4c32c9771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceab2b07fc2034fd4447035d6f65c8ae" id="r_aceab2b07fc2034fd4447035d6f65c8ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#aceab2b07fc2034fd4447035d6f65c8ae">execute_condition</a> ()</td></tr>
<tr class="memdesc:aceab2b07fc2034fd4447035d6f65c8ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">To conditionally decide if one step will be executed or no.  <br /></td></tr>
<tr class="separator:aceab2b07fc2034fd4447035d6f65c8ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925e017145d7b71ed5e9496b1fc3bfeb" id="r_a925e017145d7b71ed5e9496b1fc3bfeb"><td class="memItemLeft" align="right" valign="top"><a id="a925e017145d7b71ed5e9496b1fc3bfeb" name="a925e017145d7b71ed5e9496b1fc3bfeb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_basepath</b> ()</td></tr>
<tr class="separator:a925e017145d7b71ed5e9496b1fc3bfeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5932624e302d00b33da90591a0d26761" id="r_a5932624e302d00b33da90591a0d26761"><td class="memItemLeft" align="right" valign="top"><a id="a5932624e302d00b33da90591a0d26761" name="a5932624e302d00b33da90591a0d26761"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_courseid</b> ()</td></tr>
<tr class="separator:a5932624e302d00b33da90591a0d26761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f8a7543af0f03ad2d7baa41bfd097c" id="r_aa5f8a7543af0f03ad2d7baa41bfd097c"><td class="memItemLeft" align="right" valign="top"><a id="aa5f8a7543af0f03ad2d7baa41bfd097c" name="aa5f8a7543af0f03ad2d7baa41bfd097c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_logger</b> ()</td></tr>
<tr class="separator:aa5f8a7543af0f03ad2d7baa41bfd097c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd91ec816eb4961b01949293e589d162" id="r_afd91ec816eb4961b01949293e589d162"><td class="memItemLeft" align="right" valign="top"><a id="afd91ec816eb4961b01949293e589d162" name="afd91ec816eb4961b01949293e589d162"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_restoreid</b> ()</td></tr>
<tr class="separator:afd91ec816eb4961b01949293e589d162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe85108f2bed8aef517c17184663997b" id="r_abe85108f2bed8aef517c17184663997b"><td class="memItemLeft" align="right" valign="top"><a id="abe85108f2bed8aef517c17184663997b" name="abe85108f2bed8aef517c17184663997b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_setting</b> ($name)</td></tr>
<tr class="separator:abe85108f2bed8aef517c17184663997b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc900833b962344c356fa0bd0d5337c" id="r_afcc900833b962344c356fa0bd0d5337c"><td class="memItemLeft" align="right" valign="top"><a id="afcc900833b962344c356fa0bd0d5337c" name="afcc900833b962344c356fa0bd0d5337c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_setting_value</b> ($name)</td></tr>
<tr class="separator:afcc900833b962344c356fa0bd0d5337c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae522f2b075c01e3f5487dc9d5d999b75" id="r_ae522f2b075c01e3f5487dc9d5d999b75"><td class="memItemLeft" align="right" valign="top"><a id="ae522f2b075c01e3f5487dc9d5d999b75" name="ae522f2b075c01e3f5487dc9d5d999b75"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_settings</b> ()</td></tr>
<tr class="memdesc:ae522f2b075c01e3f5487dc9d5d999b75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protected API starts here. <br /></td></tr>
<tr class="separator:ae522f2b075c01e3f5487dc9d5d999b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abad8bfe79237f90669015f0494f509a8" id="r_abad8bfe79237f90669015f0494f509a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcb/classrestore__structure__step.html#abad8bfe79237f90669015f0494f509a8">launch_after_execute_methods</a> ()</td></tr>
<tr class="memdesc:abad8bfe79237f90669015f0494f509a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch all the after_execute methods present in all the processing objects.  <br /></td></tr>
<tr class="separator:abad8bfe79237f90669015f0494f509a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7becd679d431e4dfff8a0169696f63" id="r_a0e7becd679d431e4dfff8a0169696f63"><td class="memItemLeft" align="right" valign="top"><a id="a0e7becd679d431e4dfff8a0169696f63" name="a0e7becd679d431e4dfff8a0169696f63"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>prepare_pathelements</b> ($elementsarr)</td></tr>
<tr class="memdesc:a0e7becd679d431e4dfff8a0169696f63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare the pathelements for processing, looking for duplicates, applying processing objects and other adjustments. <br /></td></tr>
<tr class="separator:a0e7becd679d431e4dfff8a0169696f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f068bdd7dcbb018561fa52ae72d23ff" id="r_a0f068bdd7dcbb018561fa52ae72d23ff"><td class="memItemLeft" align="right" valign="top"><a id="a0f068bdd7dcbb018561fa52ae72d23ff" name="a0f068bdd7dcbb018561fa52ae72d23ff"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>setting_exists</b> ($name)</td></tr>
<tr class="separator:a0f068bdd7dcbb018561fa52ae72d23ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1a33f2ca5224c8540b39f889528d5938" id="r_a1a33f2ca5224c8540b39f889528d5938"><td class="memItemLeft" align="right" valign="top"><a id="a1a33f2ca5224c8540b39f889528d5938" name="a1a33f2ca5224c8540b39f889528d5938"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$contentprocessor</b></td></tr>
<tr class="separator:a1a33f2ca5224c8540b39f889528d5938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c56f9109ec716cfdf1cccb4941aa0a" id="r_a25c56f9109ec716cfdf1cccb4941aa0a"><td class="memItemLeft" align="right" valign="top"><a id="a25c56f9109ec716cfdf1cccb4941aa0a" name="a25c56f9109ec716cfdf1cccb4941aa0a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$elementsnewid</b></td></tr>
<tr class="separator:a25c56f9109ec716cfdf1cccb4941aa0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59879fd22c0b57a534dfbf7e03ee923" id="r_ab59879fd22c0b57a534dfbf7e03ee923"><td class="memItemLeft" align="right" valign="top"><a id="ab59879fd22c0b57a534dfbf7e03ee923" name="ab59879fd22c0b57a534dfbf7e03ee923"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$elementsoldid</b></td></tr>
<tr class="separator:ab59879fd22c0b57a534dfbf7e03ee923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee9183c071c44190be94c8fdbbd4a737" id="r_aee9183c071c44190be94c8fdbbd4a737"><td class="memItemLeft" align="right" valign="top"><a id="aee9183c071c44190be94c8fdbbd4a737" name="aee9183c071c44190be94c8fdbbd4a737"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$filename</b></td></tr>
<tr class="separator:aee9183c071c44190be94c8fdbbd4a737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7e649564d6e411901dabf17ad35e11" id="r_a7c7e649564d6e411901dabf17ad35e11"><td class="memItemLeft" align="right" valign="top">array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c7e649564d6e411901dabf17ad35e11">$legacyallowedmodules</a> = array()</td></tr>
<tr class="memdesc:a7c7e649564d6e411901dabf17ad35e11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used when <a class="el" href="#a7bf3d7d82af3e0fb834e0533bce37040">$legacyrestrictmodules</a> is true.  <br /></td></tr>
<tr class="separator:a7c7e649564d6e411901dabf17ad35e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf3d7d82af3e0fb834e0533bce37040" id="r_a7bf3d7d82af3e0fb834e0533bce37040"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bf3d7d82af3e0fb834e0533bce37040">$legacyrestrictmodules</a> = false</td></tr>
<tr class="memdesc:a7bf3d7d82af3e0fb834e0533bce37040"><td class="mdescLeft">&#160;</td><td class="mdescRight">this gets set to true by <a class="el" href="#afab99b8dc772d3dcfa0f5506913fc393">process_course()</a> if we are restoring an old coures that used the legacy 'module security' feature.  <br /></td></tr>
<tr class="separator:a7bf3d7d82af3e0fb834e0533bce37040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada686e78d14f4d7f0554db5b5697e95a" id="r_ada686e78d14f4d7f0554db5b5697e95a"><td class="memItemLeft" align="right" valign="top"><a id="ada686e78d14f4d7f0554db5b5697e95a" name="ada686e78d14f4d7f0554db5b5697e95a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$name</b></td></tr>
<tr class="separator:ada686e78d14f4d7f0554db5b5697e95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e44a632893cb76f6b6ca8c29eda05d" id="r_ae1e44a632893cb76f6b6ca8c29eda05d"><td class="memItemLeft" align="right" valign="top"><a id="ae1e44a632893cb76f6b6ca8c29eda05d" name="ae1e44a632893cb76f6b6ca8c29eda05d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$pathelements</b></td></tr>
<tr class="separator:ae1e44a632893cb76f6b6ca8c29eda05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e209ba4abd39cd79401ca123f0e60a9" id="r_a0e209ba4abd39cd79401ca123f0e60a9"><td class="memItemLeft" align="right" valign="top"><a id="a0e209ba4abd39cd79401ca123f0e60a9" name="a0e209ba4abd39cd79401ca123f0e60a9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$pathlock</b></td></tr>
<tr class="separator:a0e209ba4abd39cd79401ca123f0e60a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026baa754a617951bc7b58634e54650e" id="r_a026baa754a617951bc7b58634e54650e"><td class="memItemLeft" align="right" valign="top"><a id="a026baa754a617951bc7b58634e54650e" name="a026baa754a617951bc7b58634e54650e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$task</b></td></tr>
<tr class="separator:a026baa754a617951bc7b58634e54650e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Structure step that will read the course.xml file, loading it and performing various actions depending of the site/restore settings. </p>
<p>Note that target course always exist before arriving here so this step will be updating the course record (never inserting) </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a2652dc3247c519c2bd3cb0083b5547ab" name="a2652dc3247c519c2bd3cb0083b5547ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2652dc3247c519c2bd3cb0083b5547ab">&#9670;&#160;</a></span>add_plugin_structure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::add_plugin_structure </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$plugintype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$element</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add plugin structure to any element in the structure restore tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$plugintype</td><td>type of plugin as defined by core_component\get_plugin_types() </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../de/dc3/classrestore__path__element.html" title="Class representing one path to be restored from XML file.">restore_path_element</a></td><td class="paramname">$element</td><td>element in the structure restore tree that we are going to add plugin information to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad18b19ae3b919c22a5552548e95515f5" name="ad18b19ae3b919c22a5552548e95515f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad18b19ae3b919c22a5552548e95515f5">&#9670;&#160;</a></span>add_subplugin_structure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::add_subplugin_structure </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$subplugintype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$element</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$plugintype</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$pluginname</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add subplugin structure for a given plugin to any element in the structure restore tree. </p>
<p>This method allows the injection of subplugins (of a specific plugin) parsing and proccessing to any element in the restore structure.</p>
<p>NOTE: Initially subplugins were only available for activities (mod), so only the <a class="el" href="../../dc/db5/classrestore__activity__structure__step.html">restore_activity_structure_step</a> class had support for them, always looking for /mod/modulenanme subplugins. This new method is a generalization of the existing one for activities, supporting all subplugins injecting information everywhere.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$subplugintype</td><td>type of subplugin as defined in plugin's db/subplugins.json. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../de/dc3/classrestore__path__element.html" title="Class representing one path to be restored from XML file.">restore_path_element</a></td><td class="paramname">$element</td><td>element in the structure restore tree that we are going to add subplugin information to. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$plugintype</td><td>type of the plugin. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$pluginname</td><td>name of the plugin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e9d80bcc6083705a17a022069d8d576" name="a1e9d80bcc6083705a17a022069d8d576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e9d80bcc6083705a17a022069d8d576">&#9670;&#160;</a></span>after_execute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_course_structure_step::after_execute </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method will be executed after the whole structure step have been processed. </p>
<p>After execution method for code needed to be executed after the whole structure has been processed. Useful for cleaning tasks, files process and others. Simply overwrite in in your steps if needed </p>

<p>Reimplemented from <a class="el" href="../../d9/dcb/classrestore__structure__step.html#a1aaba5bfb63882f4d34e9218bbd72340">restore_structure_step</a>.</p>

</div>
</div>
<a id="a2d0e659d8eaafc1068d8eb0687afee5c" name="a2d0e659d8eaafc1068d8eb0687afee5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d0e659d8eaafc1068d8eb0687afee5c">&#9670;&#160;</a></span>after_restore()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::after_restore </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method will be executed after the rest of the restore has been processed. </p>
<p>Use if you need to update IDs based on things which are restored after this step has completed. </p>

<p>Reimplemented in <a class="el" href="../../d4/d41/classrestore__activity__grades__structure__step.html#a30d1afba7b7ea91c90dbd261b213d87f">restore_activity_grades_structure_step</a>, <a class="el" href="../../d8/d32/classrestore__assignment__activity__structure__step.html#a7b6a691e3104b2c8b135d295c7dcec7b">restore_assignment_activity_structure_step</a>, <a class="el" href="../../d8/ddc/classrestore__forum__activity__structure__step.html#ad72795fad131d48759ee5b74e1e1035f">restore_forum_activity_structure_step</a>, and <a class="el" href="../../de/d9f/classrestore__module__structure__step.html#a6622ad04b7b971861106130c7236e2fd">restore_module_structure_step</a>.</p>

</div>
</div>
<a id="a9c70f0c7596f5500981002a1a9df027d" name="a9c70f0c7596f5500981002a1a9df027d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c70f0c7596f5500981002a1a9df027d">&#9670;&#160;</a></span>apply_date_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_step::apply_date_offset </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply course startdate offset based in original course startdate and course_offset_startdate setting Note we are using one static cache here, but <em>by restoreid</em>, so it's ok for concurrence/multiple executions in the same request. </p>
<p>Note: The policy is to roll date only for configurations and not for user data. see <a href="https://tracker.moodle.org/browse/MDL-9367" class="el">MDL-9367</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$value</td><td>Time value (seconds since epoch), or empty for nothing </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>Time value after applying the date offset, or empty for nothing </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afb820ae8d44addb02d4e18a5cf6f28fc" name="afb820ae8d44addb02d4e18a5cf6f28fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb820ae8d44addb02d4e18a5cf6f28fc">&#9670;&#160;</a></span>decrypt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_step::decrypt </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns symmetric-key AES-256 decryption of base64 encoded contents. </p>
<p>This method is used in restore operations to decrypt contents encrypted with <a class="el" href="../../da/d84/classencrypted__final__element.html">encrypted_final_element</a> automatically decoding (base64) and decrypting contents using the key stored in backup_encryptkey config.</p>
<p>Requires openssl, cipher availability, and key existence (backup automatically sets it if missing). Integrity is provided via HMAC.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$value</td><td><a class="el" href="../../da/d84/classencrypted__final__element.html">encrypted_final_element</a> value to decode and decrypt. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string|null</td><td>decoded and decrypted value or null if the operation can not be performed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8a3879750941d7a30cb142e4c32c9771" name="a8a3879750941d7a30cb142e4c32c9771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3879750941d7a30cb142e4c32c9771">&#9670;&#160;</a></span>define_structure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_course_structure_step::define_structure </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function that will return the structure to be processed by this <a class="el" href="../../db/d9b/classrestore__step.html" title="Abstract class defining the needed stuf for one restore step.">restore_step</a>. </p>
<p>Must return one array of @restore_path_element elements </p>

<p>Reimplemented from <a class="el" href="../../d9/dcb/classrestore__structure__step.html#a9744cd987b66b312f105bf91ca43b8b4">restore_structure_step</a>.</p>

</div>
</div>
<a id="a35c8c82d27e1aa5991a685e1ca13a47d" name="a35c8c82d27e1aa5991a685e1ca13a47d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c8c82d27e1aa5991a685e1ca13a47d">&#9670;&#160;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_step::destroy </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy all circular references. </p>
<p>It helps PHP 5.2 a lot! </p>

</div>
</div>
<a id="a2a3912e58d4837bab006658938f33dac" name="a2a3912e58d4837bab006658938f33dac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a3912e58d4837bab006658938f33dac">&#9670;&#160;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::execute </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function will perform all the actions necessary to achieve the execution of the plan/part/task. </p>

<p>Implements <a class="el" href="../../df/dc9/interfaceexecutable.html#a5e976183baad284e1e8aa7361ad14193">executable</a>.</p>

</div>
</div>
<a id="aceab2b07fc2034fd4447035d6f65c8ae" name="aceab2b07fc2034fd4447035d6f65c8ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceab2b07fc2034fd4447035d6f65c8ae">&#9670;&#160;</a></span>execute_condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::execute_condition </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To conditionally decide if one step will be executed or no. </p>
<p>For steps needing to be executed conditionally, based in dynamic conditions (at execution time vs at declaration time) you must override this function. It will return true if the step must be executed and false if not </p>

<p>Reimplemented in <a class="el" href="../../d0/dff/classrestore__activity__competencies__structure__step.html#a1ef5667d2fa3f18b6e87c0fb8e579577">restore_activity_competencies_structure_step</a>, <a class="el" href="../../d8/d56/classrestore__activity__grade__history__structure__step.html#a83211b023f8ef817f0b1af3bf96eeca7">restore_activity_grade_history_structure_step</a>, <a class="el" href="../../d4/d41/classrestore__activity__grades__structure__step.html#aae6d2410bc16a8c2adebe54010bdba82">restore_activity_grades_structure_step</a>, <a class="el" href="../../dc/d89/classrestore__activity__grading__structure__step.html#abc760bf0a11b37c02510c8a61fa56aa4">restore_activity_grading_structure_step</a>, <a class="el" href="../../d3/d8f/classrestore__badges__structure__step.html#aafc6a40bc393c1a3540a8976bb1cc0b2">restore_badges_structure_step</a>, <a class="el" href="../../d6/d6a/classrestore__course__competencies__structure__step.html#ac1c07c0dbd9c06c146dead1c4eafdf09">restore_course_competencies_structure_step</a>, <a class="el" href="../../d9/da8/classrestore__course__completion__structure__step.html#acbbf90612281d75ce8015fc72b51e1f5">restore_course_completion_structure_step</a>, <a class="el" href="../../dc/d2f/classrestore__course__loglastaccess__structure__step.html#a753ebc46640bdcd78898ed7bdc920b5f">restore_course_loglastaccess_structure_step</a>, <a class="el" href="../../de/d86/classrestore__course__logs__structure__step.html#aa11a92627f2e64d72dff94f3d5446198">restore_course_logs_structure_step</a>, <a class="el" href="../../d8/df0/classrestore__course__logstores__structure__step.html#a586c1fb0df9f5e0723a8ecd102f18ab6">restore_course_logstores_structure_step</a>, <a class="el" href="../../d4/dc6/classrestore__enrolments__structure__step.html#a31a288ad3325ecf3bf902bc0c5e0e16f">restore_enrolments_structure_step</a>, <a class="el" href="../../d6/d03/classrestore__grade__history__structure__step.html#ab238b08855ed24e08a2ce357e376695c">restore_grade_history_structure_step</a>, <a class="el" href="../../d5/df1/classrestore__gradebook__structure__step.html#a7317e445ce33aae58c326b3b41ea05bf">restore_gradebook_structure_step</a>, and <a class="el" href="../../d6/d80/classrestore__userscompletion__structure__step.html#a1298f6b0c83660199d54755eca8a3753">restore_userscompletion_structure_step</a>.</p>

</div>
</div>
<a id="ac09d6de4de95edad9da7972f6eddea25" name="ac09d6de4de95edad9da7972f6eddea25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac09d6de4de95edad9da7972f6eddea25">&#9670;&#160;</a></span>get_mappingid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::get_mappingid </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$itemname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$oldid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ifnotfound</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the new id of a mapping for the given itemname. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$itemname</td><td>the type of item </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$oldid</td><td>the item ID from the backup </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$ifnotfound</td><td>what to return if $oldid wasnt found. Defaults to false </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae3f8755a3fc8e4a8afd4a385b2016920" name="ae3f8755a3fc8e4a8afd4a385b2016920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f8755a3fc8e4a8afd4a385b2016920">&#9670;&#160;</a></span>get_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::get_task </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>As far as restore structure steps are implementing <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> stuff, they need to have the parent task available for wrapping purposes (get course/context....) </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">restore_task|null</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3585480af09452a3c038ea822a309300" name="a3585480af09452a3c038ea822a309300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3585480af09452a3c038ea822a309300">&#9670;&#160;</a></span>grouped_parent_exists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::grouped_parent_exists </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$pelement</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$elements</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given one pathelement, return true if grouped parent was found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../de/dc3/classrestore__path__element.html" title="Class representing one path to be restored from XML file.">restore_path_element</a></td><td class="paramname">$pelement</td><td>the element we are interested in. </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../de/dc3/classrestore__path__element.html" title="Class representing one path to be restored from XML file.">restore_path_element</a>[]</td><td class="paramname">$elements</td><td>the elements that exist. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if this element is inside a grouped parent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abad8bfe79237f90669015f0494f509a8" name="abad8bfe79237f90669015f0494f509a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abad8bfe79237f90669015f0494f509a8">&#9670;&#160;</a></span>launch_after_execute_methods()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::launch_after_execute_methods </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Launch all the after_execute methods present in all the processing objects. </p>
<p>This method will launch all the after_execute methods that can be defined both in <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> and <a class="el" href="../../d9/dcb/classrestore__structure__step.html" title="Abstract class defining the needed stuff to restore one xml file.">restore_structure_step</a> classes</p>
<p>For <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> classes the name of the method to be executed will be "after_execute_" + connection point (as far as can be multiple connection points in the same class)</p>
<p>For <a class="el" href="../../d9/dcb/classrestore__structure__step.html" title="Abstract class defining the needed stuff to restore one xml file.">restore_structure_step</a> classes is will be, simply, "after_execute". Note that this is executed <em>after</em> the plugin ones </p>

</div>
</div>
<a id="ae28041330e9811d34f76d61cd4bc8d21" name="ae28041330e9811d34f76d61cd4bc8d21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28041330e9811d34f76d61cd4bc8d21">&#9670;&#160;</a></span>launch_after_restore_methods()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::launch_after_restore_methods </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Launch all the after_restore methods present in all the processing objects. </p>
<p>This method will launch all the after_restore methods that can be defined both in <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> class</p>
<p>For <a class="el" href="../../d8/d35/classrestore__plugin.html" title="Class implementing the plugins support for moodle2 restore.">restore_plugin</a> classes the name of the method to be executed will be "after_restore_" + connection point (as far as can be multiple connection points in the same class) </p>

</div>
</div>
<a id="ac849571ff5893405cd4b0be044779678" name="ac849571ff5893405cd4b0be044779678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac849571ff5893405cd4b0be044779678">&#9670;&#160;</a></span>log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_step::log </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$level</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$a</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$depth</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$display</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function will be responsible for handling the params, and to call to the corresponding logger-&gt;<a class="el" href="../../d9/dcb/classrestore__structure__step.html#a11ea01f63c8ae143762c50675246188d" title="Receive one chunk of information form the xml parser processor and dispatch it, following the naming ...">process()</a> once all modifications in params have been performed. </p>

<p>Implements <a class="el" href="../../d8/dda/interfaceloggable.html#af2c072bff8301fc01a338def4b556b06">loggable</a>.</p>

</div>
</div>
<a id="afab99b8dc772d3dcfa0f5506913fc393" name="afab99b8dc772d3dcfa0f5506913fc393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afab99b8dc772d3dcfa0f5506913fc393">&#9670;&#160;</a></span>process_course()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">moodledatabase restore_course_structure_step::process_course </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$data</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processing functions go here. </p>
<p>$DB </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$data</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8945099cf6d1043939c81dd7d73ce9d3" name="a8945099cf6d1043939c81dd7d73ce9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8945099cf6d1043939c81dd7d73ce9d3">&#9670;&#160;</a></span>process_course_format_option()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">restore_course_structure_step::process_course_format_option </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$data</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes a course format option. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$data</td><td>The record being restored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../dd/dee/classbase__step__exception.html">base_step_exception</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="../../d5/d5c/classdml__exception.html" title="DML exception class, use instead of throw new moodle_exception() in dml code.">dml_exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acec21a705dad55b2ebe9b34ad519c83a" name="acec21a705dad55b2ebe9b34ad519c83a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acec21a705dad55b2ebe9b34ad519c83a">&#9670;&#160;</a></span>process_customfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">restore_course_structure_step::process_customfield </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$data</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process custom fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$data</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad82dabee427613b2d9bbfa1e9dd28dd" name="aad82dabee427613b2d9bbfa1e9dd28dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad82dabee427613b2d9bbfa1e9dd28dd">&#9670;&#160;</a></span>set_mapping()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">restore_structure_step::set_mapping </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$itemname</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$oldid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$restorefiles</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$filesctxid</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$parentid</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To send ids pairs to backup_ids_table and to store them into paths. </p>
<p>This method will send the given itemname and old/new ids to the backup_ids_temp table, and, at the same time, will save the new id into the corresponding <a class="el" href="../../de/dc3/classrestore__path__element.html" title="Class representing one path to be restored from XML file.">restore_path_element</a> for easier access by children. Also will inject the known old context id for the task in case it's going to be used for restoring files later </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7c7e649564d6e411901dabf17ad35e11" name="a7c7e649564d6e411901dabf17ad35e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7e649564d6e411901dabf17ad35e11">&#9670;&#160;</a></span>$legacyallowedmodules</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">array restore_course_structure_step::$legacyallowedmodules = array()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used when <a class="el" href="#a7bf3d7d82af3e0fb834e0533bce37040">$legacyrestrictmodules</a> is true. </p>
<p>This is an array with array keys the module names ('forum', 'quiz', etc.). These are the modules that are allowed according to the data in the backup file. In <a class="el" href="#a1e9d80bcc6083705a17a022069d8d576">after_execute()</a> we then have to prevent adding of all the other types of activity. </p>

</div>
</div>
<a id="a7bf3d7d82af3e0fb834e0533bce37040" name="a7bf3d7d82af3e0fb834e0533bce37040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bf3d7d82af3e0fb834e0533bce37040">&#9670;&#160;</a></span>$legacyrestrictmodules</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool restore_course_structure_step::$legacyrestrictmodules = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this gets set to true by <a class="el" href="#afab99b8dc772d3dcfa0f5506913fc393">process_course()</a> if we are restoring an old coures that used the legacy 'module security' feature. </p>
<p>If so, we have to do more work in <a class="el" href="#a1e9d80bcc6083705a17a022069d8d576">after_execute()</a>. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>backup/moodle2/<b>restore_stepslib.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 9 2024 02:39:27 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
