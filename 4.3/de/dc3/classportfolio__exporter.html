<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: portfolio_exporter Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.3</span>
   </div>
   <div id="projectbrief">Moodle 4.3.4+ (Build: 20240524) (130165c8cc5)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search',false);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../dd/d53/classportfolio__exporter-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">portfolio_exporter Class Reference<div class="ingroups"><a class="el" href="../../d9/d4a/group__core__portfolio.html">core_portfolio</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>The class that handles the various stages of the actual export and the communication between the caller and the portfolio plugin.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5e1b432629949cdf39b8f74af6d7b7e7" id="r_a5e1b432629949cdf39b8f74af6d7b7e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e1b432629949cdf39b8f74af6d7b7e7">__construct</a> ($<a class="el" href="#a997e83bbc63ab7a6a83736036beff66f">instance</a>, <a class="el" href="../../d8/df0/classportfolio__caller__base.html">portfolio_caller_base</a> $<a class="el" href="#aa3e37006876fec43b6ef3a52a24210b0">caller</a>, $callercomponent)</td></tr>
<tr class="memdesc:a5e1b432629949cdf39b8f74af6d7b7e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new exporter for use.  <br /></td></tr>
<tr class="separator:a5e1b432629949cdf39b8f74af6d7b7e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e37006876fec43b6ef3a52a24210b0" id="r_aa3e37006876fec43b6ef3a52a24210b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3e37006876fec43b6ef3a52a24210b0">caller</a> ()</td></tr>
<tr class="memdesc:aa3e37006876fec43b6ef3a52a24210b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to return the caller object.  <br /></td></tr>
<tr class="separator:aa3e37006876fec43b6ef3a52a24210b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fcbf039a6689a81ea72e3370108374a" id="r_a4fcbf039a6689a81ea72e3370108374a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fcbf039a6689a81ea72e3370108374a">cancel_request</a> ($logreturn=false)</td></tr>
<tr class="memdesc:a4fcbf039a6689a81ea72e3370108374a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancels a potfolio request and cleans up the tempdata and redirects the user back to where they started.  <br /></td></tr>
<tr class="separator:a4fcbf039a6689a81ea72e3370108374a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6589a759eb75d7f5f8e500092041aaf" id="r_ac6589a759eb75d7f5f8e500092041aaf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6589a759eb75d7f5f8e500092041aaf">copy_existing_file</a> ($oldfile)</td></tr>
<tr class="memdesc:ac6589a759eb75d7f5f8e500092041aaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies a file from somewhere else in moodle to the portfolio temporary working directory associated with this export.  <br /></td></tr>
<tr class="separator:ac6589a759eb75d7f5f8e500092041aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8f3f338e6bb8738762bcdbdf4f9c86" id="r_aab8f3f338e6bb8738762bcdbdf4f9c86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aab8f3f338e6bb8738762bcdbdf4f9c86">get</a> ($field)</td></tr>
<tr class="memdesc:aab8f3f338e6bb8738762bcdbdf4f9c86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic getter for properties belonging to this instance <b>outside</b> the subclasses like name, visible etc.  <br /></td></tr>
<tr class="separator:aab8f3f338e6bb8738762bcdbdf4f9c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ef25c9f4f47993c963498a28d18ce0" id="r_a70ef25c9f4f47993c963498a28d18ce0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70ef25c9f4f47993c963498a28d18ce0">get_base_filearea</a> ()</td></tr>
<tr class="memdesc:a70ef25c9f4f47993c963498a28d18ce0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the context, filearea, and itemid.  <br /></td></tr>
<tr class="separator:a70ef25c9f4f47993c963498a28d18ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c03ab38c4f2605a75e76e34af0bb8a" id="r_a97c03ab38c4f2605a75e76e34af0bb8a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97c03ab38c4f2605a75e76e34af0bb8a">get_tempfiles</a> ($skipfile='portfolio-export.zip')</td></tr>
<tr class="memdesc:a97c03ab38c4f2605a75e76e34af0bb8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an arary of files in the temporary working directory for this export.  <br /></td></tr>
<tr class="separator:a97c03ab38c4f2605a75e76e34af0bb8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997e83bbc63ab7a6a83736036beff66f" id="r_a997e83bbc63ab7a6a83736036beff66f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a997e83bbc63ab7a6a83736036beff66f">instance</a> ()</td></tr>
<tr class="memdesc:a997e83bbc63ab7a6a83736036beff66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to return the portfolio instance.  <br /></td></tr>
<tr class="separator:a997e83bbc63ab7a6a83736036beff66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b631b00644e738c483900cc06200d4" id="r_a85b631b00644e738c483900cc06200d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85b631b00644e738c483900cc06200d4">log_transfer</a> ()</td></tr>
<tr class="memdesc:a85b631b00644e738c483900cc06200d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log the transfer.  <br /></td></tr>
<tr class="separator:a85b631b00644e738c483900cc06200d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9e02b5275b1f6568d9b2b16d57c55b" id="r_aad9e02b5275b1f6568d9b2b16d57c55b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad9e02b5275b1f6568d9b2b16d57c55b">print_header</a> ($headingstr, $summary=true)</td></tr>
<tr class="memdesc:aad9e02b5275b1f6568d9b2b16d57c55b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local print header function to be reused across the export.  <br /></td></tr>
<tr class="separator:aad9e02b5275b1f6568d9b2b16d57c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf11f0f411f65c4067d38f82a7c1be59" id="r_aaf11f0f411f65c4067d38f82a7c1be59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf11f0f411f65c4067d38f82a7c1be59">process_stage</a> ($stage, $alreadystolen=false)</td></tr>
<tr class="memdesc:aaf11f0f411f65c4067d38f82a7c1be59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the given stage calling whatever functions are necessary.  <br /></td></tr>
<tr class="separator:aaf11f0f411f65c4067d38f82a7c1be59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1f88002690dc1ad05940fc8b4f257e" id="r_acc1f88002690dc1ad05940fc8b4f257e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc1f88002690dc1ad05940fc8b4f257e">process_stage_cleanup</a> ($pullok=false)</td></tr>
<tr class="memdesc:acc1f88002690dc1ad05940fc8b4f257e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'cleanup' stage of the export.  <br /></td></tr>
<tr class="separator:acc1f88002690dc1ad05940fc8b4f257e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fa975d00beac4bc7db4a48a0dcd906" id="r_ac2fa975d00beac4bc7db4a48a0dcd906"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2fa975d00beac4bc7db4a48a0dcd906">process_stage_config</a> ()</td></tr>
<tr class="memdesc:ac2fa975d00beac4bc7db4a48a0dcd906"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'config' stage of the export.  <br /></td></tr>
<tr class="separator:ac2fa975d00beac4bc7db4a48a0dcd906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9877185aa465505204ebced7d7d06171" id="r_a9877185aa465505204ebced7d7d06171"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9877185aa465505204ebced7d7d06171">process_stage_confirm</a> ()</td></tr>
<tr class="memdesc:a9877185aa465505204ebced7d7d06171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'confirm' stage of the export.  <br /></td></tr>
<tr class="separator:a9877185aa465505204ebced7d7d06171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56cfb7f16ffdf7ee891420bd4de59890" id="r_a56cfb7f16ffdf7ee891420bd4de59890"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56cfb7f16ffdf7ee891420bd4de59890">process_stage_finished</a> ($queued=false)</td></tr>
<tr class="memdesc:a56cfb7f16ffdf7ee891420bd4de59890"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'finish' stage of the export.  <br /></td></tr>
<tr class="separator:a56cfb7f16ffdf7ee891420bd4de59890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d3fd8498575bf6ae23e52f4a47465f4" id="r_a7d3fd8498575bf6ae23e52f4a47465f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d3fd8498575bf6ae23e52f4a47465f4">process_stage_package</a> ()</td></tr>
<tr class="memdesc:a7d3fd8498575bf6ae23e52f4a47465f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'package' stage of the export.  <br /></td></tr>
<tr class="separator:a7d3fd8498575bf6ae23e52f4a47465f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76321a2480aba051163c4f04be2b602b" id="r_a76321a2480aba051163c4f04be2b602b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76321a2480aba051163c4f04be2b602b">process_stage_queueorwait</a> ()</td></tr>
<tr class="memdesc:a76321a2480aba051163c4f04be2b602b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'queueornext' stage of the export.  <br /></td></tr>
<tr class="separator:a76321a2480aba051163c4f04be2b602b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa7f1f1af892f1f2a1fe4d0f24497316" id="r_aaa7f1f1af892f1f2a1fe4d0f24497316"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa7f1f1af892f1f2a1fe4d0f24497316">process_stage_send</a> ()</td></tr>
<tr class="memdesc:aaa7f1f1af892f1f2a1fe4d0f24497316"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the 'send' stage of the export.  <br /></td></tr>
<tr class="separator:aaa7f1f1af892f1f2a1fe4d0f24497316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae815799111b82f7ef570979ef1ec8a2e" id="r_ae815799111b82f7ef570979ef1ec8a2e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae815799111b82f7ef570979ef1ec8a2e">save</a> ()</td></tr>
<tr class="memdesc:ae815799111b82f7ef570979ef1ec8a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out the contents of this object and all its data to the portfolio_tempdata table and sets the 'id' field.  <br /></td></tr>
<tr class="separator:ae815799111b82f7ef570979ef1ec8a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672548640b7b973c2f420b803def494c" id="r_a672548640b7b973c2f420b803def494c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a672548640b7b973c2f420b803def494c">set</a> ($field, &amp;$value)</td></tr>
<tr class="memdesc:a672548640b7b973c2f420b803def494c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic setter for properties belonging to this instance <b>outside</b> the subclass like name, visible, etc.  <br /></td></tr>
<tr class="separator:a672548640b7b973c2f420b803def494c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ebd498f56e321c2acdb6a2595005b7" id="r_a60ebd498f56e321c2acdb6a2595005b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60ebd498f56e321c2acdb6a2595005b7">set_forcequeue</a> ()</td></tr>
<tr class="memdesc:a60ebd498f56e321c2acdb6a2595005b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets this export to force queued.  <br /></td></tr>
<tr class="separator:a60ebd498f56e321c2acdb6a2595005b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4e3e5cef7006af924b6888f99276a4" id="r_a3e4e3e5cef7006af924b6888f99276a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e4e3e5cef7006af924b6888f99276a4">update_log_url</a> ($url)</td></tr>
<tr class="memdesc:a3e4e3e5cef7006af924b6888f99276a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">In some cases (mahara) we need to update this after the log has been done because of <a href="https://tracker.moodle.org/browse/MDL-20872" class="el">MDL-20872</a>  <br /></td></tr>
<tr class="separator:a3e4e3e5cef7006af924b6888f99276a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ebf6c3b352b754ed32b3d04a19c825" id="r_a75ebf6c3b352b754ed32b3d04a19c825"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75ebf6c3b352b754ed32b3d04a19c825">verify_rewaken</a> ($readonly=false)</td></tr>
<tr class="memdesc:a75ebf6c3b352b754ed32b3d04a19c825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies a rewoken object.  <br /></td></tr>
<tr class="separator:a75ebf6c3b352b754ed32b3d04a19c825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7db344f79e7eca8bb8761f3aacc6a5" id="r_a2b7db344f79e7eca8bb8761f3aacc6a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b7db344f79e7eca8bb8761f3aacc6a5">write_new_file</a> ($content, $name, $manifest=true)</td></tr>
<tr class="memdesc:a2b7db344f79e7eca8bb8761f3aacc6a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes out some content to a file in the portfolio temporary working directory associated with this export.  <br /></td></tr>
<tr class="separator:a2b7db344f79e7eca8bb8761f3aacc6a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8f1a95a76462beedf768e012a5facb" id="r_a7f8f1a95a76462beedf768e012a5facb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f8f1a95a76462beedf768e012a5facb">zip_tempfiles</a> ($filename='portfolio-export.zip', $filepath='/final/')</td></tr>
<tr class="memdesc:a7f8f1a95a76462beedf768e012a5facb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zips all files in the temporary directory.  <br /></td></tr>
<tr class="separator:a7f8f1a95a76462beedf768e012a5facb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6b8cb50d30213844e8d42c6badd7838c" id="r_a6b8cb50d30213844e8d42c6badd7838c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b8cb50d30213844e8d42c6badd7838c">print_cleaned_export</a> ($log, $<a class="el" href="#a997e83bbc63ab7a6a83736036beff66f">instance</a>=null)</td></tr>
<tr class="memdesc:a6b8cb50d30213844e8d42c6badd7838c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper function to print a friendly error to users.  <br /></td></tr>
<tr class="separator:a6b8cb50d30213844e8d42c6badd7838c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44cfc014dedfb4972f1a2dd7b1f61b88" id="r_a44cfc014dedfb4972f1a2dd7b1f61b88"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44cfc014dedfb4972f1a2dd7b1f61b88">print_expired_export</a> ()</td></tr>
<tr class="memdesc:a44cfc014dedfb4972f1a2dd7b1f61b88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper function to print a friendly error to users This is generally caused by them hitting an expired transfer through the usage of the backbutton.  <br /></td></tr>
<tr class="separator:a44cfc014dedfb4972f1a2dd7b1f61b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25df948076467774a7cbc52915476fc9" id="r_a25df948076467774a7cbc52915476fc9"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a25df948076467774a7cbc52915476fc9">print_finish_info</a> ($returnurl, $continueurl, $extras=null)</td></tr>
<tr class="memdesc:a25df948076467774a7cbc52915476fc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper function to print continue and/or return link.  <br /></td></tr>
<tr class="separator:a25df948076467774a7cbc52915476fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1013637704e6ab79f5a97ff34042801" id="r_ad1013637704e6ab79f5a97ff34042801"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1013637704e6ab79f5a97ff34042801">rewaken_object</a> ($id)</td></tr>
<tr class="memdesc:ad1013637704e6ab79f5a97ff34042801"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rewakens the data from the database given the id.  <br /></td></tr>
<tr class="separator:ad1013637704e6ab79f5a97ff34042801"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac3487b7d30f88fc660b81410c41bf6b6" id="r_ac3487b7d30f88fc660b81410c41bf6b6"><td class="memItemLeft" align="right" valign="top"><a id="ac3487b7d30f88fc660b81410c41bf6b6" name="ac3487b7d30f88fc660b81410c41bf6b6"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>$callercomponent</b></td></tr>
<tr class="memdesc:ac3487b7d30f88fc660b81410c41bf6b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the component that contains the class definition of the caller object used to re-waken the object after sleep <br /></td></tr>
<tr class="separator:ac3487b7d30f88fc660b81410c41bf6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5aab90f73df5ceabf18d71411e23acc" id="r_ad5aab90f73df5ceabf18d71411e23acc"><td class="memItemLeft" align="right" valign="top"><a id="ad5aab90f73df5ceabf18d71411e23acc" name="ad5aab90f73df5ceabf18d71411e23acc"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>$instancefile</b></td></tr>
<tr class="memdesc:ad5aab90f73df5ceabf18d71411e23acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">the file to include that contains the class defintion of the portfolio instance plugin used to re-waken the object after sleep <br /></td></tr>
<tr class="separator:ad5aab90f73df5ceabf18d71411e23acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The class that handles the various stages of the actual export and the communication between the caller and the portfolio plugin. </p>
<p>This is stored in the database between page requests in serialized base64 encoded form also contains helper methods for the plugin and caller to use (at the end of the file) </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="#a70ef25c9f4f47993c963498a28d18ce0" title="Returns the context, filearea, and itemid.">get_base_filearea</a> - where to <a class="el" href="../../dc/d71/group___imap___client.html#gaea09d1ed6a1a3aa8fca59357baa9af80" title="Writes data to the POP3 output stream.">write</a> files to </dd>
<dd>
<a class="el" href="#a2b7db344f79e7eca8bb8761f3aacc6a5" title="Writes out some content to a file in the portfolio temporary working directory associated with this e...">write_new_file</a> - <a class="el" href="../../dc/d71/group___imap___client.html#gaea09d1ed6a1a3aa8fca59357baa9af80" title="Writes data to the POP3 output stream.">write</a> some content to a file in the export filearea </dd>
<dd>
<a class="el" href="#ac6589a759eb75d7f5f8e500092041aaf" title="Copies a file from somewhere else in moodle to the portfolio temporary working directory associated w...">copy_existing_file</a> - copy an existing file into the export filearea </dd>
<dd>
<a class="el" href="#a97c03ab38c4f2605a75e76e34af0bb8a" title="Returns an arary of files in the temporary working directory for this export.">get_tempfiles</a> - return list of all files in the export filearea</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2008 Penny Leach <a href="#" onclick="location.href='mai'+'lto:'+'pen'+'ny'+'@ca'+'ta'+'lys'+'t.'+'net'+'.n'+'z'; return false;">penny<span class="obfuscator">.nosp@m.</span>@cat<span class="obfuscator">.nosp@m.</span>alyst<span class="obfuscator">.nosp@m.</span>.net<span class="obfuscator">.nosp@m.</span>.nz</a> Martin Dougiamas <a href="http://dougiamas.com">http://dougiamas.com</a> </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5e1b432629949cdf39b8f74af6d7b7e7" name="a5e1b432629949cdf39b8f74af6d7b7e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1b432629949cdf39b8f74af6d7b7e7">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::__construct </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$instance</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/df0/classportfolio__caller__base.html">portfolio_caller_base</a></td>          <td class="paramname"><span class="paramname"><em>$caller</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$callercomponent</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new exporter for use. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../dc/d7e/classportfolio__plugin__base.html" title="The base class for portfolio plugins.">portfolio_plugin_base</a></td><td class="paramname">$instance</td><td>portfolio instance (passed by reference) </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d8/df0/classportfolio__caller__base.html" title="Base class for callers.">portfolio_caller_base</a></td><td class="paramname">$caller</td><td>portfolio caller (passed by reference) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$callercomponent</td><td>the name of the callercomponent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa3e37006876fec43b6ef3a52a24210b0" name="aa3e37006876fec43b6ef3a52a24210b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e37006876fec43b6ef3a52a24210b0">&#9670;&#160;</a></span>caller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::caller </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to return the caller object. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d8/df0/classportfolio__caller__base.html" title="Base class for callers.">portfolio_caller_base</a></td><td>subclass </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4fcbf039a6689a81ea72e3370108374a" name="a4fcbf039a6689a81ea72e3370108374a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fcbf039a6689a81ea72e3370108374a">&#9670;&#160;</a></span>cancel_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::cancel_request </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$logreturn</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancels a potfolio request and cleans up the tempdata and redirects the user back to where they started. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$logreturn</td><td>options to return to porfolio log or caller return page </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td>@uses exit </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6589a759eb75d7f5f8e500092041aaf" name="ac6589a759eb75d7f5f8e500092041aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6589a759eb75d7f5f8e500092041aaf">&#9670;&#160;</a></span>copy_existing_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::copy_existing_file </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$oldfile</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies a file from somewhere else in moodle to the portfolio temporary working directory associated with this export. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d0/d00/classstored__file.html" title="Class representing local files stored in a sha1 file pool.">stored_file</a></td><td class="paramname">$oldfile</td><td>existing stored file object </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stored_file|bool</td><td>new file object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aab8f3f338e6bb8738762bcdbdf4f9c86" name="aab8f3f338e6bb8738762bcdbdf4f9c86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab8f3f338e6bb8738762bcdbdf4f9c86">&#9670;&#160;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::get </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$field</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic getter for properties belonging to this instance <b>outside</b> the subclasses like name, visible etc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$field</td><td>property's name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">portfolio_format|mixed</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70ef25c9f4f47993c963498a28d18ce0" name="a70ef25c9f4f47993c963498a28d18ce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ef25c9f4f47993c963498a28d18ce0">&#9670;&#160;</a></span>get_base_filearea()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::get_base_filearea </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the context, filearea, and itemid. </p>
<p>Parts of a filearea (not filepath) to be used by plugins if they want to do things like zip up the contents of the temp area to here, or something that can't be done just using write_new_file, copy_existing_file or get_tempfiles</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>contextid, filearea, itemid are the keys. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a97c03ab38c4f2605a75e76e34af0bb8a" name="a97c03ab38c4f2605a75e76e34af0bb8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c03ab38c4f2605a75e76e34af0bb8a">&#9670;&#160;</a></span>get_tempfiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::get_tempfiles </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$skipfile</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'portfolio-export.zip'</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an arary of files in the temporary working directory for this export. </p>
<p>Always use this instead of the files api directly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$skipfile</td><td>name of the file to be skipped </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of <a class="el" href="../../d0/d00/classstored__file.html" title="Class representing local files stored in a sha1 file pool.">stored_file</a> objects keyed by name </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a997e83bbc63ab7a6a83736036beff66f" name="a997e83bbc63ab7a6a83736036beff66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a997e83bbc63ab7a6a83736036beff66f">&#9670;&#160;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::instance </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to return the portfolio instance. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../dc/d7e/classportfolio__plugin__base.html" title="The base class for portfolio plugins.">portfolio_plugin_base</a></td><td>subclass </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a85b631b00644e738c483900cc06200d4" name="a85b631b00644e738c483900cc06200d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b631b00644e738c483900cc06200d4">&#9670;&#160;</a></span>log_transfer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::log_transfer </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log the transfer. </p>
<p>this should only be called after the file has been sent either via push, or sent from a pull request. </p>

</div>
</div>
<a id="a6b8cb50d30213844e8d42c6badd7838c" name="a6b8cb50d30213844e8d42c6badd7838c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b8cb50d30213844e8d42c6badd7838c">&#9670;&#160;</a></span>print_cleaned_export()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static portfolio_exporter::print_cleaned_export </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$log</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$instance</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wrapper function to print a friendly error to users. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$log</td><td>portfolio_log object </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../dc/d7e/classportfolio__plugin__base.html" title="The base class for portfolio plugins.">portfolio_plugin_base</a></td><td class="paramname">$instance</td><td>portfolio instance @uses exit </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a44cfc014dedfb4972f1a2dd7b1f61b88" name="a44cfc014dedfb4972f1a2dd7b1f61b88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44cfc014dedfb4972f1a2dd7b1f61b88">&#9670;&#160;</a></span>print_expired_export()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static portfolio_exporter::print_expired_export </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wrapper function to print a friendly error to users This is generally caused by them hitting an expired transfer through the usage of the backbutton. </p>
<p>@uses exit </p>

</div>
</div>
<a id="a25df948076467774a7cbc52915476fc9" name="a25df948076467774a7cbc52915476fc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25df948076467774a7cbc52915476fc9">&#9670;&#160;</a></span>print_finish_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static portfolio_exporter::print_finish_info </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$returnurl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$continueurl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$extras</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wrapper function to print continue and/or return link. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$returnurl</td><td>link to previos page </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$continueurl</td><td>continue to next page </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$extras</td><td>(optional) other links to be display. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad9e02b5275b1f6568d9b2b16d57c55b" name="aad9e02b5275b1f6568d9b2b16d57c55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9e02b5275b1f6568d9b2b16d57c55b">&#9670;&#160;</a></span>print_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::print_header </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$headingstr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$summary</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local print header function to be reused across the export. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$headingstr</td><td>full language string </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$summary</td><td>(optional) to print summary, default is set to true </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaf11f0f411f65c4067d38f82a7c1be59" name="aaf11f0f411f65c4067d38f82a7c1be59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf11f0f411f65c4067d38f82a7c1be59">&#9670;&#160;</a></span>process_stage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$stage</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$alreadystolen</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the given stage calling whatever functions are necessary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$stage</td><td>(see PORTFOLIO_STAGE_* constants) </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$alreadystolen</td><td>used to avoid letting plugins steal control twice. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acc1f88002690dc1ad05940fc8b4f257e" name="acc1f88002690dc1ad05940fc8b4f257e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc1f88002690dc1ad05940fc8b4f257e">&#9670;&#160;</a></span>process_stage_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_cleanup </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$pullok</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'cleanup' stage of the export. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$pullok</td><td>normally cleanup is deferred for pull plugins until after the file is requested from portfolio/file.php if you want to clean up earlier, pass true here (defaults to false) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac2fa975d00beac4bc7db4a48a0dcd906" name="ac2fa975d00beac4bc7db4a48a0dcd906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2fa975d00beac4bc7db4a48a0dcd906">&#9670;&#160;</a></span>process_stage_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_config </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'config' stage of the export. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9877185aa465505204ebced7d7d06171" name="a9877185aa465505204ebced7d7d06171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9877185aa465505204ebced7d7d06171">&#9670;&#160;</a></span>process_stage_confirm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_confirm </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'confirm' stage of the export. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a56cfb7f16ffdf7ee891420bd4de59890" name="a56cfb7f16ffdf7ee891420bd4de59890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56cfb7f16ffdf7ee891420bd4de59890">&#9670;&#160;</a></span>process_stage_finished()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_finished </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$queued</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'finish' stage of the export. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$queued</td><td>let the process to be queued </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7d3fd8498575bf6ae23e52f4a47465f4" name="a7d3fd8498575bf6ae23e52f4a47465f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d3fd8498575bf6ae23e52f4a47465f4">&#9670;&#160;</a></span>process_stage_package()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_package </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'package' stage of the export. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d4/d01/classportfolio__export__exception.html" title="Exception to throw during an export - will clean up session and tempdata.">portfolio_export_exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a76321a2480aba051163c4f04be2b602b" name="a76321a2480aba051163c4f04be2b602b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76321a2480aba051163c4f04be2b602b">&#9670;&#160;</a></span>process_stage_queueorwait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_queueorwait </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'queueornext' stage of the export. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaa7f1f1af892f1f2a1fe4d0f24497316" name="aaa7f1f1af892f1f2a1fe4d0f24497316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa7f1f1af892f1f2a1fe4d0f24497316">&#9670;&#160;</a></span>process_stage_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::process_stage_send </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the 'send' stage of the export. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether or not to process the next stage. this is important as the control function is called recursively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad1013637704e6ab79f5a97ff34042801" name="ad1013637704e6ab79f5a97ff34042801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1013637704e6ab79f5a97ff34042801">&#9670;&#160;</a></span>rewaken_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static portfolio_exporter::rewaken_object </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rewakens the data from the database given the id. </p>
<p>Makes sure to load the required files with the class definitions</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$id</td><td>id of data </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../de/dc3/classportfolio__exporter.html" title="The class that handles the various stages of the actual export and the communication between the call...">portfolio_exporter</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae815799111b82f7ef570979ef1ec8a2e" name="ae815799111b82f7ef570979ef1ec8a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae815799111b82f7ef570979ef1ec8a2e">&#9670;&#160;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::save </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes out the contents of this object and all its data to the portfolio_tempdata table and sets the 'id' field. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a672548640b7b973c2f420b803def494c" name="a672548640b7b973c2f420b803def494c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a672548640b7b973c2f420b803def494c">&#9670;&#160;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::set </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;</td>          <td class="paramname"><span class="paramname"><em>$value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic setter for properties belonging to this instance <b>outside</b> the subclass like name, visible, etc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$field</td><td>property's name </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$value</td><td>property's value </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d4/d01/classportfolio__export__exception.html" title="Exception to throw during an export - will clean up session and tempdata.">portfolio_export_exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a60ebd498f56e321c2acdb6a2595005b7" name="a60ebd498f56e321c2acdb6a2595005b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ebd498f56e321c2acdb6a2595005b7">&#9670;&#160;</a></span>set_forcequeue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::set_forcequeue </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets this export to force queued. </p>
<p>Sometimes plugins need to set this randomly if an external system changes its mind about what's supported </p>

</div>
</div>
<a id="a3e4e3e5cef7006af924b6888f99276a4" name="a3e4e3e5cef7006af924b6888f99276a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e4e3e5cef7006af924b6888f99276a4">&#9670;&#160;</a></span>update_log_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::update_log_url </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$url</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In some cases (mahara) we need to update this after the log has been done because of <a href="https://tracker.moodle.org/browse/MDL-20872" class="el">MDL-20872</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$url</td><td>link to be recorded to portfolio log </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a75ebf6c3b352b754ed32b3d04a19c825" name="a75ebf6c3b352b754ed32b3d04a19c825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75ebf6c3b352b754ed32b3d04a19c825">&#9670;&#160;</a></span>verify_rewaken()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::verify_rewaken </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$readonly</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies a rewoken object. </p>
<p>Checks to make sure it belongs to the same user and session as is currently in use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$readonly</td><td>if we're reawakening this for a user to just display in the log view, don't verify the sessionkey </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d4/d71/classportfolio__exception.html" title="Top level portfolio exception.">portfolio_exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2b7db344f79e7eca8bb8761f3aacc6a5" name="a2b7db344f79e7eca8bb8761f3aacc6a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7db344f79e7eca8bb8761f3aacc6a5">&#9670;&#160;</a></span>write_new_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::write_new_file </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$content</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$manifest</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes out some content to a file in the portfolio temporary working directory associated with this export. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$content</td><td>content to write </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>filename to use </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$manifest</td><td>whether this is the main file or an secondary file (eg attachment) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d0/d00/classstored__file.html" title="Class representing local files stored in a sha1 file pool.">stored_file</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7f8f1a95a76462beedf768e012a5facb" name="a7f8f1a95a76462beedf768e012a5facb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8f1a95a76462beedf768e012a5facb">&#9670;&#160;</a></span>zip_tempfiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portfolio_exporter::zip_tempfiles </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$filename</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'portfolio-export.zip'</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$filepath</em></span><span class="paramdefsep"> = </span><span class="paramdefval">'/final/'</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zips all files in the temporary directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$filename</td><td>name of resulting zipfile (optional, defaults to portfolio-export.zip) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$filepath</td><td>subpath in the filearea (optional, defaults to final) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stored_file|bool</td><td>resulting <a class="el" href="../../d0/d00/classstored__file.html" title="Class representing local files stored in a sha1 file pool.">stored_file</a> object, or false </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/portfolio/<b>exporter.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 26 2024 02:42:47 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
