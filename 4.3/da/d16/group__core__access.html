<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: core_access</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.3</span>
   </div>
   <div id="projectbrief">Moodle 4.3.4 (Build: 20240422) (143c2cd5bef)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">core_access</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:d9/d0f/namespacecore" id="r_d9/d0f/namespacecore"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d0f/namespacecore.html">core</a></td></tr>
<tr class="memdesc:d9/d0f/namespacecore"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#160; <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/d9f/namespacecore_1_1context" id="r_d8/d9f/namespacecore_1_1context"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d9f/namespacecore_1_1context.html">core\context</a></td></tr>
<tr class="memdesc:d8/d9f/namespacecore_1_1context"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#160; <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d0/df8/namespacecore_1_1event" id="r_d0/df8/namespacecore_1_1event"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/df8/namespacecore_1_1event.html">core\event</a></td></tr>
<tr class="memdesc:d0/df8/namespacecore_1_1event"><td class="mdescLeft">&#160;</td><td class="mdescRight">&#160; <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d90/classcore_1_1context.html">core\context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/classcore_1_1context_1_1block.html">core\context\block</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d1c/classcore_1_1context_1_1course.html">core\context\course</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d47/classcore_1_1context_1_1coursecat.html">core\context\coursecat</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dfc/classcore_1_1context_1_1module.html">core\context\module</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/ded/classcore_1_1context_1_1system.html">core\context\system</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dba/classcore_1_1context_1_1user.html">core\context\user</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/da6/classcore_1_1context__helper.html">core\context_helper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classcore_1_1event_1_1context__locked.html">core\event\context_locked</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event triggered after a context has been frozen.  <a href="../../d7/d48/classcore_1_1event_1_1context__locked.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d12/classcore_1_1event_1_1context__unlocked.html">core\event\context_unlocked</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event triggered after a context has been unfrozen.  <a href="../../d8/d12/classcore_1_1event_1_1context__unlocked.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d7b/classrequire__login__exception.html">require_login_exception</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Course/activity access exception.  <a href="../../da/d7b/classrequire__login__exception.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d59/classrequire__login__session__timeout__exception.html">require_login_session_timeout_exception</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Session timeout exception.  <a href="../../d1/d59/classrequire__login__session__timeout__exception.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d15/classrequired__capability__exception.html">required_capability_exception</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exceptions indicating user does not have permissions to do something and the execution can not continue.  <a href="../../d2/d15/classrequired__capability__exception.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0e5c6f5ecdd9c5011fbc0eda103e1769" id="r_ga0e5c6f5ecdd9c5011fbc0eda103e1769"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0e5c6f5ecdd9c5011fbc0eda103e1769">assign_capability</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $permission, $roleid, $contextid, $overwrite=false, array $performancehints=[])</td></tr>
<tr class="memdesc:ga0e5c6f5ecdd9c5011fbc0eda103e1769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to write context specific overrides, or default capabilities.  <br /></td></tr>
<tr class="separator:ga0e5c6f5ecdd9c5011fbc0eda103e1769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4044312274e5f5f9bf768f1faa4587c5" id="r_ga4044312274e5f5f9bf768f1faa4587c5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4044312274e5f5f9bf768f1faa4587c5">assign_legacy_capabilities</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $legacyperms)</td></tr>
<tr class="memdesc:ga4044312274e5f5f9bf768f1faa4587c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the defaults found in this capability definition to roles that have the corresponding legacy capabilities assigned to them.  <br /></td></tr>
<tr class="separator:ga4044312274e5f5f9bf768f1faa4587c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5c5c0f0093c4b085455c14c0c5c7fa4" id="r_gad5c5c0f0093c4b085455c14c0c5c7fa4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad5c5c0f0093c4b085455c14c0c5c7fa4">can_access_course</a> (stdClass $course, $user=null, $withcapability='', $onlyactive=false)</td></tr>
<tr class="memdesc:gad5c5c0f0093c4b085455c14c0c5c7fa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the user is able to access the course.  <br /></td></tr>
<tr class="separator:gad5c5c0f0093c4b085455c14c0c5c7fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73fb6f7b305131ff1d48fa08e020e187" id="r_ga73fb6f7b305131ff1d48fa08e020e187"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga73fb6f7b305131ff1d48fa08e020e187">component_level_changed</a> ($cap, $comp, $contextlevel)</td></tr>
<tr class="memdesc:ga73fb6f7b305131ff1d48fa08e020e187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aids in detecting if a new line is required when reading a new capability.  <br /></td></tr>
<tr class="separator:ga73fb6f7b305131ff1d48fa08e020e187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3c8bcb840b64feaed9dd0da770246b1" id="r_gad3c8bcb840b64feaed9dd0da770246b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad3c8bcb840b64feaed9dd0da770246b1">core_role_set_assign_allowed</a> ($fromroleid, $targetroleid)</td></tr>
<tr class="memdesc:gad3c8bcb840b64feaed9dd0da770246b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a record in the role_allow_assign table.  <br /></td></tr>
<tr class="separator:gad3c8bcb840b64feaed9dd0da770246b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga328f41c9ebd5b1dc5c82afe17cb048b7" id="r_ga328f41c9ebd5b1dc5c82afe17cb048b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga328f41c9ebd5b1dc5c82afe17cb048b7">core_role_set_override_allowed</a> ($fromroleid, $targetroleid)</td></tr>
<tr class="memdesc:ga328f41c9ebd5b1dc5c82afe17cb048b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a record in the role_allow_override table.  <br /></td></tr>
<tr class="separator:ga328f41c9ebd5b1dc5c82afe17cb048b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad789a6560ddff7773934c2a2c2b6b2f5" id="r_gad789a6560ddff7773934c2a2c2b6b2f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad789a6560ddff7773934c2a2c2b6b2f5">core_role_set_switch_allowed</a> ($fromroleid, $targetroleid)</td></tr>
<tr class="memdesc:gad789a6560ddff7773934c2a2c2b6b2f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a record in the role_allow_switch table.  <br /></td></tr>
<tr class="separator:gad789a6560ddff7773934c2a2c2b6b2f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47bd0411f15fb14e5bf8d5794464e9fa" id="r_ga47bd0411f15fb14e5bf8d5794464e9fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga47bd0411f15fb14e5bf8d5794464e9fa">core_role_set_view_allowed</a> ($fromroleid, $targetroleid)</td></tr>
<tr class="memdesc:ga47bd0411f15fb14e5bf8d5794464e9fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a record in the role_allow_view table.  <br /></td></tr>
<tr class="separator:ga47bd0411f15fb14e5bf8d5794464e9fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f467700c1117ca97f289cbedc83a3fd" id="r_ga1f467700c1117ca97f289cbedc83a3fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1f467700c1117ca97f289cbedc83a3fd">count_role_users</a> ($roleid, context $context, $parent=false)</td></tr>
<tr class="memdesc:ga1f467700c1117ca97f289cbedc83a3fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts all the users assigned this role in this context or higher.  <br /></td></tr>
<tr class="separator:ga1f467700c1117ca97f289cbedc83a3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20f99c5e8f189803231f52e4e37ae1f8" id="r_ga20f99c5e8f189803231f52e4e37ae1f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga20f99c5e8f189803231f52e4e37ae1f8">create_role</a> ($name, $shortname, $description, $archetype='')</td></tr>
<tr class="memdesc:ga20f99c5e8f189803231f52e4e37ae1f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that creates a role.  <br /></td></tr>
<tr class="separator:ga20f99c5e8f189803231f52e4e37ae1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31f98de8b303947a9245a927602b56ec" id="r_ga31f98de8b303947a9245a927602b56ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga31f98de8b303947a9245a927602b56ec">delete_role</a> ($roleid)</td></tr>
<tr class="memdesc:ga31f98de8b303947a9245a927602b56ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function that deletes a role and cleanups up after it.  <br /></td></tr>
<tr class="separator:ga31f98de8b303947a9245a927602b56ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff9b19b544cb4c3af7ff2dbe78bf0640" id="r_gaff9b19b544cb4c3af7ff2dbe78bf0640"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaff9b19b544cb4c3af7ff2dbe78bf0640">extract_suspended_users</a> ($context, &amp;$users, $ignoreusers=array())</td></tr>
<tr class="memdesc:gaff9b19b544cb4c3af7ff2dbe78bf0640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given context and array of users, returns array of users whose enrolment status is suspended, or enrolment has expired or has not started.  <br /></td></tr>
<tr class="separator:gaff9b19b544cb4c3af7ff2dbe78bf0640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b916e8e765a9e7a808e41ceb536b9fc" id="r_ga1b916e8e765a9e7a808e41ceb536b9fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1b916e8e765a9e7a808e41ceb536b9fc">fix_role_sortorder</a> ($allroles)</td></tr>
<tr class="memdesc:ga1b916e8e765a9e7a808e41ceb536b9fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fix the roles.sortorder field in the database, so it contains sequential integers, and return an array of roleids in order.  <br /></td></tr>
<tr class="separator:ga1b916e8e765a9e7a808e41ceb536b9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7d3fa115f042eee7d883ea8909547d9" id="r_gab7d3fa115f042eee7d883ea8909547d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab7d3fa115f042eee7d883ea8909547d9">get_all_capabilities</a> ()</td></tr>
<tr class="memdesc:gab7d3fa115f042eee7d883ea8909547d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns all capabilitiy records, preferably from MUC and not database.  <br /></td></tr>
<tr class="separator:gab7d3fa115f042eee7d883ea8909547d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4da976b4aa3c72c607ab4560a9add05b" id="r_ga4da976b4aa3c72c607ab4560a9add05b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4da976b4aa3c72c607ab4560a9add05b">get_all_risks</a> ()</td></tr>
<tr class="memdesc:ga4da976b4aa3c72c607ab4560a9add05b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an array of all the known types of risk The array keys can be used, for example as CSS class names, or in calls to print_risk_icon.  <br /></td></tr>
<tr class="separator:ga4da976b4aa3c72c607ab4560a9add05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab826913ef6aa23566fc9cc49b3cb8b90" id="r_gab826913ef6aa23566fc9cc49b3cb8b90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab826913ef6aa23566fc9cc49b3cb8b90">get_all_roles</a> (context $context=null)</td></tr>
<tr class="memdesc:gab826913ef6aa23566fc9cc49b3cb8b90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns all site roles in correct sort order.  <br /></td></tr>
<tr class="separator:gab826913ef6aa23566fc9cc49b3cb8b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2492b6ae94d98c374a171bd0fd81eb8" id="r_gad2492b6ae94d98c374a171bd0fd81eb8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad2492b6ae94d98c374a171bd0fd81eb8">get_archetype_roles</a> ($archetype)</td></tr>
<tr class="memdesc:gad2492b6ae94d98c374a171bd0fd81eb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns roles of a specified archetype.  <br /></td></tr>
<tr class="separator:gad2492b6ae94d98c374a171bd0fd81eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga742db860b11ecedf56f83185b61d26eb" id="r_ga742db860b11ecedf56f83185b61d26eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga742db860b11ecedf56f83185b61d26eb">get_assignable_roles</a> (context $context, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>, $withusercounts=false, $user=null)</td></tr>
<tr class="memdesc:ga742db860b11ecedf56f83185b61d26eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a list of roles that this user can assign in this context.  <br /></td></tr>
<tr class="separator:ga742db860b11ecedf56f83185b61d26eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga854ed4600b36dc8377d9bcbdc5a95907" id="r_ga854ed4600b36dc8377d9bcbdc5a95907"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga854ed4600b36dc8377d9bcbdc5a95907">get_capabilities_from_role_on_context</a> ($role, context $context)</td></tr>
<tr class="memdesc:ga854ed4600b36dc8377d9bcbdc5a95907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all capabilities for this role on this context (overrides)  <br /></td></tr>
<tr class="separator:ga854ed4600b36dc8377d9bcbdc5a95907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bbfc4b637693b92528151ccfcd8748e" id="r_ga4bbfc4b637693b92528151ccfcd8748e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4bbfc4b637693b92528151ccfcd8748e">get_capability_docs_link</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:ga4bbfc4b637693b92528151ccfcd8748e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a link to moodle docs for a given capability name.  <br /></td></tr>
<tr class="separator:ga4bbfc4b637693b92528151ccfcd8748e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga517737effe562e088ce605a695920368" id="r_ga517737effe562e088ce605a695920368"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga517737effe562e088ce605a695920368">get_capability_info</a> ($capabilityname)</td></tr>
<tr class="memdesc:ga517737effe562e088ce605a695920368"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns capability information (cached)  <br /></td></tr>
<tr class="separator:ga517737effe562e088ce605a695920368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga058d59768f0c61d69433aa58dfe5831f" id="r_ga058d59768f0c61d69433aa58dfe5831f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga058d59768f0c61d69433aa58dfe5831f">get_capability_string</a> ($capabilityname)</td></tr>
<tr class="memdesc:ga058d59768f0c61d69433aa58dfe5831f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the human-readable, translated version of the capability.  <br /></td></tr>
<tr class="separator:ga058d59768f0c61d69433aa58dfe5831f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4059ae8da018cd7274be3a48433dfaee" id="r_ga4059ae8da018cd7274be3a48433dfaee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4059ae8da018cd7274be3a48433dfaee">get_component_string</a> ($component, $contextlevel)</td></tr>
<tr class="memdesc:ga4059ae8da018cd7274be3a48433dfaee"><td class="mdescLeft">&#160;</td><td class="mdescRight">This gets the mod/block/course/core etc strings.  <br /></td></tr>
<tr class="separator:ga4059ae8da018cd7274be3a48433dfaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ddcaac5f93ff61388ed9c9cc791ad18" id="r_ga0ddcaac5f93ff61388ed9c9cc791ad18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0ddcaac5f93ff61388ed9c9cc791ad18">get_context_info_array</a> ($contextid)</td></tr>
<tr class="memdesc:ga0ddcaac5f93ff61388ed9c9cc791ad18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns context instance plus related course and cm instances.  <br /></td></tr>
<tr class="separator:ga0ddcaac5f93ff61388ed9c9cc791ad18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60062476167ca8b21387c7f1ca54e52f" id="r_ga60062476167ca8b21387c7f1ca54e52f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga60062476167ca8b21387c7f1ca54e52f">get_default_capabilities</a> ($archetype)</td></tr>
<tr class="memdesc:ga60062476167ca8b21387c7f1ca54e52f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns default capabilities for given role archetype.  <br /></td></tr>
<tr class="separator:ga60062476167ca8b21387c7f1ca54e52f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga375fe15fa1a778d7e3a81de7115b69a2" id="r_ga375fe15fa1a778d7e3a81de7115b69a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga375fe15fa1a778d7e3a81de7115b69a2">get_default_contextlevels</a> ($rolearchetype)</td></tr>
<tr class="memdesc:ga375fe15fa1a778d7e3a81de7115b69a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns default context levels where roles can be assigned.  <br /></td></tr>
<tr class="separator:ga375fe15fa1a778d7e3a81de7115b69a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae06c72d126b730c50a297cfd258c8333" id="r_gae06c72d126b730c50a297cfd258c8333"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae06c72d126b730c50a297cfd258c8333">get_default_role_archetype_allows</a> ($type, $archetype)</td></tr>
<tr class="memdesc:gae06c72d126b730c50a297cfd258c8333"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return default roles that can be assigned, overridden or switched by give role archetype.  <br /></td></tr>
<tr class="separator:gae06c72d126b730c50a297cfd258c8333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09b1eba3b9160056bb3d4cadf268d14a" id="r_ga09b1eba3b9160056bb3d4cadf268d14a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga09b1eba3b9160056bb3d4cadf268d14a">get_deprecated_capability_info</a> ($capabilityname)</td></tr>
<tr class="memdesc:ga09b1eba3b9160056bb3d4cadf268d14a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns deprecation info for this particular capabilty (cached)  <br /></td></tr>
<tr class="separator:ga09b1eba3b9160056bb3d4cadf268d14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab59a0e62fc226a4952602ed064d3c5ef" id="r_gab59a0e62fc226a4952602ed064d3c5ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab59a0e62fc226a4952602ed064d3c5ef">get_guest_role</a> ()</td></tr>
<tr class="memdesc:gab59a0e62fc226a4952602ed064d3c5ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the default guest role, this is used for guest account, search engine spiders, etc.  <br /></td></tr>
<tr class="separator:gab59a0e62fc226a4952602ed064d3c5ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab25141a38b80146bc4c36c8837547897" id="r_gab25141a38b80146bc4c36c8837547897"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab25141a38b80146bc4c36c8837547897">get_local_override</a> ($roleid, $contextid, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:gab25141a38b80146bc4c36c8837547897"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the local override (if any) for a given capability in a role in a context.  <br /></td></tr>
<tr class="separator:gab25141a38b80146bc4c36c8837547897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabfe471980560b88a19dc699f4d051516" id="r_gabfe471980560b88a19dc699f4d051516"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabfe471980560b88a19dc699f4d051516">get_overridable_roles</a> (context $context, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>, $withcounts=false)</td></tr>
<tr class="memdesc:gabfe471980560b88a19dc699f4d051516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a list of roles that this user can override in this context.  <br /></td></tr>
<tr class="separator:gabfe471980560b88a19dc699f4d051516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c63ee2636ff556a822992b8a031f9e4" id="r_ga9c63ee2636ff556a822992b8a031f9e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9c63ee2636ff556a822992b8a031f9e4">get_profile_roles</a> (context $context)</td></tr>
<tr class="memdesc:ga9c63ee2636ff556a822992b8a031f9e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the list of roles assigned to this context and up (parents) from the aggregation of: a) the list of roles that are visible on user profile page and participants page (profileroles setting) and; b) if applicable, those roles that are assigned in the context.  <br /></td></tr>
<tr class="separator:ga9c63ee2636ff556a822992b8a031f9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b3a6778d7d7292ee7fee13caa11410f" id="r_ga4b3a6778d7d7292ee7fee13caa11410f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4b3a6778d7d7292ee7fee13caa11410f">get_role_archetypes</a> ()</td></tr>
<tr class="memdesc:ga4b3a6778d7d7292ee7fee13caa11410f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns array of all role archetypes.  <br /></td></tr>
<tr class="separator:ga4b3a6778d7d7292ee7fee13caa11410f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa22b5be5494ae6bc9c32085891f677d0" id="r_gaa22b5be5494ae6bc9c32085891f677d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa22b5be5494ae6bc9c32085891f677d0">get_role_contextlevels</a> ($roleid)</td></tr>
<tr class="memdesc:gaa22b5be5494ae6bc9c32085891f677d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return context levels where this role is assignable.  <br /></td></tr>
<tr class="separator:gaa22b5be5494ae6bc9c32085891f677d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6f9384510b05dcbc81447619fee407b" id="r_gae6f9384510b05dcbc81447619fee407b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae6f9384510b05dcbc81447619fee407b">get_role_definitions</a> (array $roleids)</td></tr>
<tr class="memdesc:gae6f9384510b05dcbc81447619fee407b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch raw "site wide" role definitions.  <br /></td></tr>
<tr class="separator:gae6f9384510b05dcbc81447619fee407b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6968eb16a1953af54144833c2131e9a0" id="r_ga6968eb16a1953af54144833c2131e9a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6968eb16a1953af54144833c2131e9a0">get_role_definitions_uncached</a> (array $roleids)</td></tr>
<tr class="memdesc:ga6968eb16a1953af54144833c2131e9a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query raw "site wide" role definitions.  <br /></td></tr>
<tr class="separator:ga6968eb16a1953af54144833c2131e9a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4bfb489377303d064575ffa0756a5f3" id="r_gae4bfb489377303d064575ffa0756a5f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae4bfb489377303d064575ffa0756a5f3">get_role_names_with_caps_in_context</a> ($context, $capabilities)</td></tr>
<tr class="memdesc:gae4bfb489377303d064575ffa0756a5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an array of role names that have ALL of the the supplied capabilities Uses <a class="el" href="#ga6418f9879fe9d13aaa87e1950eaee3a5" title="Returns an array of role IDs that have ALL of the the supplied capabilities Uses get_roles_with_cap_i...">get_roles_with_caps_in_context()</a>.  <br /></td></tr>
<tr class="separator:gae4bfb489377303d064575ffa0756a5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1eb64f68288f6d8d04fb1ce3cf0f5798" id="r_ga1eb64f68288f6d8d04fb1ce3cf0f5798"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1eb64f68288f6d8d04fb1ce3cf0f5798">get_role_users</a> ($roleid, context $context, $parent=false, $fields='', $<a class="el" href="../../dc/d71/group___imap___client.html#ga4bd31bcedb7b4943aac2da78d0d84afe">sort</a>=null, $all=true, $group='', $limitfrom='', $limitnum='', $extrawheretest='', $whereorsortparams=array())</td></tr>
<tr class="memdesc:ga1eb64f68288f6d8d04fb1ce3cf0f5798"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets all the users assigned this role in this context or higher.  <br /></td></tr>
<tr class="separator:ga1eb64f68288f6d8d04fb1ce3cf0f5798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbe0f7b472391ae7f0e0f9ec44f81408" id="r_gadbe0f7b472391ae7f0e0f9ec44f81408"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadbe0f7b472391ae7f0e0f9ec44f81408">get_roles_for_contextlevels</a> ($contextlevel)</td></tr>
<tr class="memdesc:gadbe0f7b472391ae7f0e0f9ec44f81408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return roles suitable for assignment at the specified context level.  <br /></td></tr>
<tr class="separator:gadbe0f7b472391ae7f0e0f9ec44f81408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1098e905ef351f974bb6f36084230069" id="r_ga1098e905ef351f974bb6f36084230069"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1098e905ef351f974bb6f36084230069">get_roles_used_in_context</a> (context $context, $includeparents=true)</td></tr>
<tr class="memdesc:ga1098e905ef351f974bb6f36084230069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the list of roles assigned to this context and up (parents)  <br /></td></tr>
<tr class="separator:ga1098e905ef351f974bb6f36084230069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03cc6680a53a24a80f501bf0059f062d" id="r_ga03cc6680a53a24a80f501bf0059f062d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga03cc6680a53a24a80f501bf0059f062d">get_roles_with_cap_in_context</a> ($context, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:ga03cc6680a53a24a80f501bf0059f062d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns two lists, this can be used to find out if user has capability.  <br /></td></tr>
<tr class="separator:ga03cc6680a53a24a80f501bf0059f062d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga971eb3acfb63288c23b5b7fa5a7bf9d3" id="r_ga971eb3acfb63288c23b5b7fa5a7bf9d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga971eb3acfb63288c23b5b7fa5a7bf9d3">get_roles_with_capability</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $permission=null, $context=null)</td></tr>
<tr class="memdesc:ga971eb3acfb63288c23b5b7fa5a7bf9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the roles that have a given capability assigned to it.  <br /></td></tr>
<tr class="separator:ga971eb3acfb63288c23b5b7fa5a7bf9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6418f9879fe9d13aaa87e1950eaee3a5" id="r_ga6418f9879fe9d13aaa87e1950eaee3a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6418f9879fe9d13aaa87e1950eaee3a5">get_roles_with_caps_in_context</a> ($context, $capabilities)</td></tr>
<tr class="memdesc:ga6418f9879fe9d13aaa87e1950eaee3a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an array of role IDs that have ALL of the the supplied capabilities Uses <a class="el" href="#ga03cc6680a53a24a80f501bf0059f062d" title="Returns two lists, this can be used to find out if user has capability.">get_roles_with_cap_in_context()</a>.  <br /></td></tr>
<tr class="separator:ga6418f9879fe9d13aaa87e1950eaee3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ec2ce1871d50a42a20441d94dfa30a1" id="r_ga9ec2ce1871d50a42a20441d94dfa30a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9ec2ce1871d50a42a20441d94dfa30a1">get_roles_with_override_on_context</a> (context $context)</td></tr>
<tr class="memdesc:ga9ec2ce1871d50a42a20441d94dfa30a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get any role that has an override on exact context.  <br /></td></tr>
<tr class="separator:ga9ec2ce1871d50a42a20441d94dfa30a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54912b2efc769860963727a37542bfb7" id="r_ga54912b2efc769860963727a37542bfb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga54912b2efc769860963727a37542bfb7">get_sorted_contexts</a> ($select, $params=array())</td></tr>
<tr class="memdesc:ga54912b2efc769860963727a37542bfb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs get_records select on context table and returns the result Does get_records_select on the context table, and returns the results ordered by contextlevel, and then the natural sort order within each level.  <br /></td></tr>
<tr class="separator:ga54912b2efc769860963727a37542bfb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe424bab9d2f37c65dc4ddd1e72c19e7" id="r_gabe424bab9d2f37c65dc4ddd1e72c19e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabe424bab9d2f37c65dc4ddd1e72c19e7">get_suspended_userids</a> (context $context, $usecache=false)</td></tr>
<tr class="memdesc:gabe424bab9d2f37c65dc4ddd1e72c19e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given context and array of users, returns array of user ids whose enrolment status is suspended, or enrolment has expired or not started.  <br /></td></tr>
<tr class="separator:gabe424bab9d2f37c65dc4ddd1e72c19e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0802e1b7439f8766590563f7f63cd2ae" id="r_ga0802e1b7439f8766590563f7f63cd2ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0802e1b7439f8766590563f7f63cd2ae">get_switchable_roles</a> (context $context, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>)</td></tr>
<tr class="memdesc:ga0802e1b7439f8766590563f7f63cd2ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a list of roles that this user can switch to in a context.  <br /></td></tr>
<tr class="separator:ga0802e1b7439f8766590563f7f63cd2ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe0e63eb2ac64e2a09254bb166f96f2f" id="r_gafe0e63eb2ac64e2a09254bb166f96f2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafe0e63eb2ac64e2a09254bb166f96f2f">get_user_capability_contexts</a> (string $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, bool $getcategories, $userid=null, $doanything=true, $coursefieldsexceptid='', $categoryfieldsexceptid='', $courseorderby='', $categoryorderby='', $limit=0)</td></tr>
<tr class="memdesc:gafe0e63eb2ac64e2a09254bb166f96f2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the list of course and course category contexts that this user has a particular capability in.  <br /></td></tr>
<tr class="separator:gafe0e63eb2ac64e2a09254bb166f96f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1ffab498514c3891fe6fcfda0ad641f0" id="r_ga1ffab498514c3891fe6fcfda0ad641f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1ffab498514c3891fe6fcfda0ad641f0">get_user_capability_course</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $userid=null, $doanything=true, $fieldsexceptid='', $orderby='', $limit=0)</td></tr>
<tr class="memdesc:ga1ffab498514c3891fe6fcfda0ad641f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function gets the list of courses that this user has a particular capability in.  <br /></td></tr>
<tr class="separator:ga1ffab498514c3891fe6fcfda0ad641f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafc6bbc7f2d6c9cb12afebd6d37bfea50" id="r_gafc6bbc7f2d6c9cb12afebd6d37bfea50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafc6bbc7f2d6c9cb12afebd6d37bfea50">get_user_roles</a> (context $context, $userid=0, $checkparentcontexts=true, $order='c.contextlevel DESC, r.sortorder ASC')</td></tr>
<tr class="memdesc:gafc6bbc7f2d6c9cb12afebd6d37bfea50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets all the user roles assigned in this context, or higher contexts this is mainly used when checking if a user can assign a role, or overriding a role i.e.  <br /></td></tr>
<tr class="separator:gafc6bbc7f2d6c9cb12afebd6d37bfea50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab21940a04b70f1613f850825397feea7" id="r_gab21940a04b70f1613f850825397feea7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab21940a04b70f1613f850825397feea7">get_user_roles_in_course</a> ($userid, $courseid)</td></tr>
<tr class="memdesc:gab21940a04b70f1613f850825397feea7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to print roles column in user profile page.  <br /></td></tr>
<tr class="separator:gab21940a04b70f1613f850825397feea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55a22e0153a398bd2943325dd322005b" id="r_ga55a22e0153a398bd2943325dd322005b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga55a22e0153a398bd2943325dd322005b">get_user_roles_with_special</a> (context $context, $userid=0)</td></tr>
<tr class="memdesc:ga55a22e0153a398bd2943325dd322005b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Like get_user_roles, but adds in the authenticated user role, and the front page roles, if applicable.  <br /></td></tr>
<tr class="separator:ga55a22e0153a398bd2943325dd322005b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66340c4f447ab44105bf8f56f709daa1" id="r_ga66340c4f447ab44105bf8f56f709daa1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga66340c4f447ab44105bf8f56f709daa1">get_users_by_capability</a> (context $context, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $fields='', $<a class="el" href="../../dc/d71/group___imap___client.html#ga4bd31bcedb7b4943aac2da78d0d84afe">sort</a>='', $limitfrom='', $limitnum='', $groups='', $exceptions='', $notuseddoanything=null, $notusedview=null, $useviewallgroups=false)</td></tr>
<tr class="memdesc:ga66340c4f447ab44105bf8f56f709daa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Who has this capability in this context?  <br /></td></tr>
<tr class="separator:ga66340c4f447ab44105bf8f56f709daa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78d3d59a76533ca0789088767056a5f9" id="r_ga78d3d59a76533ca0789088767056a5f9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga78d3d59a76533ca0789088767056a5f9">get_users_from_role_on_context</a> ($role, context $context)</td></tr>
<tr class="memdesc:ga78d3d59a76533ca0789088767056a5f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find all user assignment of users for this role, on this context.  <br /></td></tr>
<tr class="separator:ga78d3d59a76533ca0789088767056a5f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8bdf3dbf1c6cd5f7cefc1a795481023" id="r_gaf8bdf3dbf1c6cd5f7cefc1a795481023"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf8bdf3dbf1c6cd5f7cefc1a795481023">get_users_roles</a> (context $context, $userids=[], $checkparentcontexts=true, $order='c.contextlevel DESC, r.sortorder ASC')</td></tr>
<tr class="memdesc:gaf8bdf3dbf1c6cd5f7cefc1a795481023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets all the user roles assigned in this context, or higher contexts for a list of users.  <br /></td></tr>
<tr class="separator:gaf8bdf3dbf1c6cd5f7cefc1a795481023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba0a6031f350c2f5e8d497f55f96e60e" id="r_gaba0a6031f350c2f5e8d497f55f96e60e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaba0a6031f350c2f5e8d497f55f96e60e">get_viewable_roles</a> (context $context, $userid=null, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>)</td></tr>
<tr class="memdesc:gaba0a6031f350c2f5e8d497f55f96e60e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a list of roles that this user can view in a context.  <br /></td></tr>
<tr class="separator:gaba0a6031f350c2f5e8d497f55f96e60e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9af89dd558ccf4003da846a79795180d" id="r_ga9af89dd558ccf4003da846a79795180d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9af89dd558ccf4003da846a79795180d">get_with_capability_join</a> (context $context, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $useridcolumn)</td></tr>
<tr class="memdesc:ga9af89dd558ccf4003da846a79795180d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets sql joins for finding users with capability in the given context.  <br /></td></tr>
<tr class="separator:ga9af89dd558ccf4003da846a79795180d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ccdb2a5b0a983b87dc1c114f5d22481" id="r_ga8ccdb2a5b0a983b87dc1c114f5d22481"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8ccdb2a5b0a983b87dc1c114f5d22481">get_with_capability_sql</a> (context $context, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:ga8ccdb2a5b0a983b87dc1c114f5d22481"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets sql for finding users with capability in the given context.  <br /></td></tr>
<tr class="separator:ga8ccdb2a5b0a983b87dc1c114f5d22481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7efea6d1bde89c10ddd77f21ea9f7dac" id="r_ga7efea6d1bde89c10ddd77f21ea9f7dac"><td class="memItemLeft" align="right" valign="top"><a id="ga7efea6d1bde89c10ddd77f21ea9f7dac" name="ga7efea6d1bde89c10ddd77f21ea9f7dac"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>guess_if_creator_will_have_course_capability</b> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, context $context, $user=null)</td></tr>
<tr class="separator:ga7efea6d1bde89c10ddd77f21ea9f7dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f6a2c13ed924064cd6ce4a221e1fe43" id="r_ga5f6a2c13ed924064cd6ce4a221e1fe43"><td class="memItemLeft" align="right" valign="top"><a id="ga5f6a2c13ed924064cd6ce4a221e1fe43" name="ga5f6a2c13ed924064cd6ce4a221e1fe43"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>has_all_capabilities</b> (array $capabilities, context $context, $user=null, $doanything=true)</td></tr>
<tr class="separator:ga5f6a2c13ed924064cd6ce4a221e1fe43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe69880706c3a795ed8e3d2dbbd6d126" id="r_gabe69880706c3a795ed8e3d2dbbd6d126"><td class="memItemLeft" align="right" valign="top"><a id="gabe69880706c3a795ed8e3d2dbbd6d126" name="gabe69880706c3a795ed8e3d2dbbd6d126"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>has_any_capability</b> (array $capabilities, context $context, $user=null, $doanything=true)</td></tr>
<tr class="separator:gabe69880706c3a795ed8e3d2dbbd6d126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed509a355b214abfd75cd23db71bd5ad" id="r_gaed509a355b214abfd75cd23db71bd5ad"><td class="memItemLeft" align="right" valign="top"><a id="gaed509a355b214abfd75cd23db71bd5ad" name="gaed509a355b214abfd75cd23db71bd5ad"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>has_capability</b> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, context $context, $user=null, $doanything=true)</td></tr>
<tr class="separator:gaed509a355b214abfd75cd23db71bd5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab116aa603700860d827daf7de08fb49" id="r_gaab116aa603700860d827daf7de08fb49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaab116aa603700860d827daf7de08fb49">has_coursecontact_role</a> ($userid)</td></tr>
<tr class="memdesc:gaab116aa603700860d827daf7de08fb49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if user has at least one role assign of 'coursecontact' role (is potentially listed in some course descriptions).  <br /></td></tr>
<tr class="separator:gaab116aa603700860d827daf7de08fb49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd7c8790b70ba5dbf2d204c3a803e8de" id="r_gafd7c8790b70ba5dbf2d204c3a803e8de"><td class="memItemLeft" align="right" valign="top"><a id="gafd7c8790b70ba5dbf2d204c3a803e8de" name="gafd7c8790b70ba5dbf2d204c3a803e8de"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>is_guest</b> (context $context, $user=null)</td></tr>
<tr class="separator:gafd7c8790b70ba5dbf2d204c3a803e8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb6c185fda8568262bb328514d383579" id="r_gafb6c185fda8568262bb328514d383579"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gafb6c185fda8568262bb328514d383579">is_inside_frontpage</a> (context $context)</td></tr>
<tr class="memdesc:gafb6c185fda8568262bb328514d383579"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if context is the front page context or a context inside it.  <br /></td></tr>
<tr class="separator:gafb6c185fda8568262bb328514d383579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35d16f693ab63233f0b180529ae9940d" id="r_ga35d16f693ab63233f0b180529ae9940d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga35d16f693ab63233f0b180529ae9940d">is_role_switched</a> ($courseid)</td></tr>
<tr class="memdesc:ga35d16f693ab63233f0b180529ae9940d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the user has switched roles within the given course.  <br /></td></tr>
<tr class="separator:ga35d16f693ab63233f0b180529ae9940d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad0cc97536e38d210276ece73b2dc1288" id="r_gad0cc97536e38d210276ece73b2dc1288"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad0cc97536e38d210276ece73b2dc1288">is_safe_capability</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:gad0cc97536e38d210276ece73b2dc1288"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify capability risks.  <br /></td></tr>
<tr class="separator:gad0cc97536e38d210276ece73b2dc1288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga749048a4269b55aa258ac035b3d6e499" id="r_ga749048a4269b55aa258ac035b3d6e499"><td class="memItemLeft" align="right" valign="top"><a id="ga749048a4269b55aa258ac035b3d6e499" name="ga749048a4269b55aa258ac035b3d6e499"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>is_siteadmin</b> ($user_or_id=null)</td></tr>
<tr class="separator:ga749048a4269b55aa258ac035b3d6e499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga270aeb83562eec9d3f88b3630c47a6b6" id="r_ga270aeb83562eec9d3f88b3630c47a6b6"><td class="memItemLeft" align="right" valign="top"><a id="ga270aeb83562eec9d3f88b3630c47a6b6" name="ga270aeb83562eec9d3f88b3630c47a6b6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>is_viewing</b> (context $context, $user=null, $withcapability='')</td></tr>
<tr class="separator:ga270aeb83562eec9d3f88b3630c47a6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19f07a8fd216feed61e45822a657e05d" id="r_ga19f07a8fd216feed61e45822a657e05d"><td class="memItemLeft" align="right" valign="top"><a id="ga19f07a8fd216feed61e45822a657e05d" name="ga19f07a8fd216feed61e45822a657e05d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>isguestuser</b> ($user=null)</td></tr>
<tr class="separator:ga19f07a8fd216feed61e45822a657e05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05874fa5e08443747d2f7e5c1b8c1f0d" id="r_ga05874fa5e08443747d2f7e5c1b8c1f0d"><td class="memItemLeft" align="right" valign="top"><a id="ga05874fa5e08443747d2f7e5c1b8c1f0d" name="ga05874fa5e08443747d2f7e5c1b8c1f0d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>isloggedin</b> ()</td></tr>
<tr class="separator:ga05874fa5e08443747d2f7e5c1b8c1f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5474d366746ba4fb687b3efb48e2a599" id="r_ga5474d366746ba4fb687b3efb48e2a599"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5474d366746ba4fb687b3efb48e2a599">load_temp_course_role</a> (context_course $coursecontext, $roleid)</td></tr>
<tr class="memdesc:ga5474d366746ba4fb687b3efb48e2a599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a temp role to current USER-&gt;access array.  <br /></td></tr>
<tr class="separator:ga5474d366746ba4fb687b3efb48e2a599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade0d5aba32c3f5de67424298c90ade16" id="r_gade0d5aba32c3f5de67424298c90ade16"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gade0d5aba32c3f5de67424298c90ade16">mark_user_dirty</a> ($userid)</td></tr>
<tr class="memdesc:gade0d5aba32c3f5de67424298c90ade16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark a user as dirty (with timestamp) so as to force reloading of the user session.  <br /></td></tr>
<tr class="separator:gade0d5aba32c3f5de67424298c90ade16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a75f06472e00beffc8a083f777db4ae" id="r_ga4a75f06472e00beffc8a083f777db4ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4a75f06472e00beffc8a083f777db4ae">prohibit_is_removable</a> ($roleid, context $context, $<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>)</td></tr>
<tr class="memdesc:ga4a75f06472e00beffc8a083f777db4ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function verifies the prohibit comes from this context and there are no more prohibits in parent contexts.  <br /></td></tr>
<tr class="separator:ga4a75f06472e00beffc8a083f777db4ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf57c585c7b4cec02246c3a1c6b9361a" id="r_gaaf57c585c7b4cec02246c3a1c6b9361a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaf57c585c7b4cec02246c3a1c6b9361a">remove_temp_course_roles</a> (context_course $coursecontext)</td></tr>
<tr class="memdesc:gaaf57c585c7b4cec02246c3a1c6b9361a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes any extra guest roles from current USER-&gt;access array.  <br /></td></tr>
<tr class="separator:gaaf57c585c7b4cec02246c3a1c6b9361a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3c722028406b13979b12917a45eacb6a" id="r_ga3c722028406b13979b12917a45eacb6a"><td class="memItemLeft" align="right" valign="top"><a id="ga3c722028406b13979b12917a45eacb6a" name="ga3c722028406b13979b12917a45eacb6a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>require_all_capabilities</b> (array $capabilities, context $context, $userid=null, $doanything=true, $errormessage='nopermissions', $stringfile='')</td></tr>
<tr class="separator:ga3c722028406b13979b12917a45eacb6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae106921b5a4e5d4f797621cca8193cd7" id="r_gae106921b5a4e5d4f797621cca8193cd7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae106921b5a4e5d4f797621cca8193cd7">require_capability</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, context $context, $userid=null, $doanything=true, $errormessage='nopermissions', $stringfile='')</td></tr>
<tr class="memdesc:gae106921b5a4e5d4f797621cca8193cd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A convenience function that tests has_capability, and displays an error if the user does not have that capability.  <br /></td></tr>
<tr class="separator:gae106921b5a4e5d4f797621cca8193cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga526d78545ea35b7f2d831de88244ccc8" id="r_ga526d78545ea35b7f2d831de88244ccc8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga526d78545ea35b7f2d831de88244ccc8">reset_role_capabilities</a> ($roleid)</td></tr>
<tr class="memdesc:ga526d78545ea35b7f2d831de88244ccc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset role capabilities to default according to selected role archetype.  <br /></td></tr>
<tr class="separator:ga526d78545ea35b7f2d831de88244ccc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9942ad6f10a787833c5a686c9e36ebb" id="r_gad9942ad6f10a787833c5a686c9e36ebb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad9942ad6f10a787833c5a686c9e36ebb">role_assign</a> ($roleid, $userid, $contextid, $component='', $itemid=0, $timemodified='')</td></tr>
<tr class="memdesc:gad9942ad6f10a787833c5a686c9e36ebb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function makes a role-assignment (a role for a user in a particular context)  <br /></td></tr>
<tr class="separator:gad9942ad6f10a787833c5a686c9e36ebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0c1dc75b9a8c3246d4cc10d838f6998" id="r_gae0c1dc75b9a8c3246d4cc10d838f6998"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae0c1dc75b9a8c3246d4cc10d838f6998">role_cap_duplicate</a> ($sourcerole, $targetrole)</td></tr>
<tr class="memdesc:gae0c1dc75b9a8c3246d4cc10d838f6998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicates all the base definitions of a role.  <br /></td></tr>
<tr class="separator:gae0c1dc75b9a8c3246d4cc10d838f6998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed47009d5c2358fb63fdf04c5756c4a2" id="r_gaed47009d5c2358fb63fdf04c5756c4a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaed47009d5c2358fb63fdf04c5756c4a2">role_change_permission</a> ($roleid, $context, $capname, $permission)</td></tr>
<tr class="memdesc:gaed47009d5c2358fb63fdf04c5756c4a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">More user friendly role permission changing, it should produce as few overrides as possible.  <br /></td></tr>
<tr class="separator:gaed47009d5c2358fb63fdf04c5756c4a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacede73f3ae58af31201a498e461c8a6a" id="r_gacede73f3ae58af31201a498e461c8a6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gacede73f3ae58af31201a498e461c8a6a">role_context_capabilities</a> ($roleid, context $context, $cap='')</td></tr>
<tr class="memdesc:gacede73f3ae58af31201a498e461c8a6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function pulls out all the resolved capabilities (overrides and defaults) of a role used in capability overrides in contexts at a given context.  <br /></td></tr>
<tr class="separator:gacede73f3ae58af31201a498e461c8a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e09cdf5a4b6faa5c40d95c1039190d7" id="r_ga9e09cdf5a4b6faa5c40d95c1039190d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga9e09cdf5a4b6faa5c40d95c1039190d7">role_fix_names</a> ($roleoptions, context $context=null, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>, $returnmenu=null)</td></tr>
<tr class="memdesc:ga9e09cdf5a4b6faa5c40d95c1039190d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare list of roles for display, apply aliases and localise default role names.  <br /></td></tr>
<tr class="separator:ga9e09cdf5a4b6faa5c40d95c1039190d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab16dc200a0de5de83ca14a33a4293660" id="r_gab16dc200a0de5de83ca14a33a4293660"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab16dc200a0de5de83ca14a33a4293660">role_get_description</a> (stdClass $role)</td></tr>
<tr class="memdesc:gab16dc200a0de5de83ca14a33a4293660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns localised role description if available.  <br /></td></tr>
<tr class="separator:gab16dc200a0de5de83ca14a33a4293660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1dd8f305e320a4c9ece907644944081b" id="r_ga1dd8f305e320a4c9ece907644944081b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga1dd8f305e320a4c9ece907644944081b">role_get_name</a> (stdClass $role, $context=null, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>)</td></tr>
<tr class="memdesc:ga1dd8f305e320a4c9ece907644944081b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get localised role name or alias if exists and format the text.  <br /></td></tr>
<tr class="separator:ga1dd8f305e320a4c9ece907644944081b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf5d6be413bc83b11f1a7842ab34b2bf" id="r_gadf5d6be413bc83b11f1a7842ab34b2bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gadf5d6be413bc83b11f1a7842ab34b2bf">role_get_names</a> (context $context=null, $rolenamedisplay=<a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a>, $returnmenu=null)</td></tr>
<tr class="memdesc:gadf5d6be413bc83b11f1a7842ab34b2bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all the localised role names for a context.  <br /></td></tr>
<tr class="separator:gadf5d6be413bc83b11f1a7842ab34b2bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30729206f2de12ab0bfe887db80031ad" id="r_ga30729206f2de12ab0bfe887db80031ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga30729206f2de12ab0bfe887db80031ad">role_switch</a> ($roleid, context $context)</td></tr>
<tr class="memdesc:ga30729206f2de12ab0bfe887db80031ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switches the current user to another role for the current session and only in the given context.  <br /></td></tr>
<tr class="separator:ga30729206f2de12ab0bfe887db80031ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8da408086f63145f9a3aa306b4b5ced0" id="r_ga8da408086f63145f9a3aa306b4b5ced0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8da408086f63145f9a3aa306b4b5ced0">role_unassign</a> ($roleid, $userid, $contextid, $component='', $itemid=0)</td></tr>
<tr class="memdesc:ga8da408086f63145f9a3aa306b4b5ced0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes one role assignment.  <br /></td></tr>
<tr class="separator:ga8da408086f63145f9a3aa306b4b5ced0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcf07ea620a5032be4a95f54ce1b7a96" id="r_gabcf07ea620a5032be4a95f54ce1b7a96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabcf07ea620a5032be4a95f54ce1b7a96">role_unassign_all</a> (array $params, $subcontexts=false, $includemanual=false)</td></tr>
<tr class="memdesc:gabcf07ea620a5032be4a95f54ce1b7a96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes multiple role assignments, parameters may contain: 'roleid', 'userid', 'contextid', 'component', 'enrolid'.  <br /></td></tr>
<tr class="separator:gabcf07ea620a5032be4a95f54ce1b7a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa626698a51598d556cff48793000af6b" id="r_gaa626698a51598d556cff48793000af6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa626698a51598d556cff48793000af6b">set_role_contextlevels</a> ($roleid, array $contextlevels)</td></tr>
<tr class="memdesc:gaa626698a51598d556cff48793000af6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the context levels at which a particular role can be assigned.  <br /></td></tr>
<tr class="separator:gaa626698a51598d556cff48793000af6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4a08eb7131890af57f5fe305f55a9b8" id="r_gab4a08eb7131890af57f5fe305f55a9b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab4a08eb7131890af57f5fe305f55a9b8">sort_by_roleassignment_authority</a> ($users, context $context, $roles=array(), $sortpolicy='locality')</td></tr>
<tr class="memdesc:gab4a08eb7131890af57f5fe305f55a9b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-sort a users array based on a sorting policy.  <br /></td></tr>
<tr class="separator:gab4a08eb7131890af57f5fe305f55a9b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5fd541d0278f2ce8aaeb321b8b8851c" id="r_gac5fd541d0278f2ce8aaeb321b8b8851c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac5fd541d0278f2ce8aaeb321b8b8851c">switch_roles</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gac73eef9ff76ea330c0dab36ca448b90d">first</a>, $second)</td></tr>
<tr class="memdesc:gac5fd541d0278f2ce8aaeb321b8b8851c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch the sort order of two roles (used in admin/roles/manage.php).  <br /></td></tr>
<tr class="separator:gac5fd541d0278f2ce8aaeb321b8b8851c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga928246fb49c4eb83e351423e3e11e72a" id="r_ga928246fb49c4eb83e351423e3e11e72a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga928246fb49c4eb83e351423e3e11e72a">unassign_capability</a> ($<a class="el" href="../../dc/d71/group___imap___client.html#gab2c24006bbccb7984767e680dc4c3e92">capability</a>, $roleid, $contextid=null)</td></tr>
<tr class="memdesc:ga928246fb49c4eb83e351423e3e11e72a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unassign a capability from a role.  <br /></td></tr>
<tr class="separator:ga928246fb49c4eb83e351423e3e11e72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb7f43b7c655ad190ca02f288d7f419f" id="r_gabb7f43b7c655ad190ca02f288d7f419f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabb7f43b7c655ad190ca02f288d7f419f">user_can_assign</a> (context $context, $targetroleid)</td></tr>
<tr class="memdesc:gabb7f43b7c655ad190ca02f288d7f419f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a user can assign users to a particular role in this context.  <br /></td></tr>
<tr class="separator:gabb7f43b7c655ad190ca02f288d7f419f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga094626c521a5191dec40e63c56be1733" id="r_ga094626c521a5191dec40e63c56be1733"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga094626c521a5191dec40e63c56be1733">user_has_role_assignment</a> ($userid, $roleid, $contextid=0)</td></tr>
<tr class="memdesc:ga094626c521a5191dec40e63c56be1733"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple function returning a boolean true if user has roles in context or parent contexts, otherwise false.  <br /></td></tr>
<tr class="separator:ga094626c521a5191dec40e63c56be1733"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga3bd1a55d998861e02e56c127f4b46c94" id="r_ga3bd1a55d998861e02e56c127f4b46c94"><td class="memItemLeft" align="right" valign="top"><a id="ga3bd1a55d998861e02e56c127f4b46c94" name="ga3bd1a55d998861e02e56c127f4b46c94"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$capabilities</b></td></tr>
<tr class="separator:ga3bd1a55d998861e02e56c127f4b46c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga052f212a4598137bdc80f3ef8748ffed" id="r_ga052f212a4598137bdc80f3ef8748ffed"><td class="memItemLeft" align="right" valign="top"><a id="ga052f212a4598137bdc80f3ef8748ffed" name="ga052f212a4598137bdc80f3ef8748ffed"></a>
$ACCESSLIB_PRIVATE&#160;</td><td class="memItemRight" valign="bottom"><b>accessdatabyuser</b> = array()</td></tr>
<tr class="separator:ga052f212a4598137bdc80f3ef8748ffed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4dbd9e33ec80cda06295afee17e8a570" id="r_ga4dbd9e33ec80cda06295afee17e8a570"><td class="memItemLeft" align="right" valign="top"><a id="ga4dbd9e33ec80cda06295afee17e8a570" name="ga4dbd9e33ec80cda06295afee17e8a570"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ACCESSLIB_HINT_CONTEXT_EXISTS</b> (!defined('CONTEXT_CACHE_MAX_SIZE')) 'contextexists'</td></tr>
<tr class="memdesc:ga4dbd9e33ec80cda06295afee17e8a570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performance hint for assign_capability: the contextid is known to exist. <br /></td></tr>
<tr class="separator:ga4dbd9e33ec80cda06295afee17e8a570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga77d34678aa29e66f1031cb33fe6f97f5" id="r_ga77d34678aa29e66f1031cb33fe6f97f5"><td class="memItemLeft" align="right" valign="top"><a id="ga77d34678aa29e66f1031cb33fe6f97f5" name="ga77d34678aa29e66f1031cb33fe6f97f5"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ACCESSLIB_HINT_NO_EXISTING</b> 'notexists'</td></tr>
<tr class="memdesc:ga77d34678aa29e66f1031cb33fe6f97f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performance hint for assign_capability: there is no existing entry in role_capabilities. <br /></td></tr>
<tr class="separator:ga77d34678aa29e66f1031cb33fe6f97f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa41d0c434384a9381417f43e196cb7d7" id="r_gaa41d0c434384a9381417f43e196cb7d7"><td class="memItemLeft" align="right" valign="top"><a id="gaa41d0c434384a9381417f43e196cb7d7" name="gaa41d0c434384a9381417f43e196cb7d7"></a>
$ACCESSLIB_PRIVATE&#160;</td><td class="memItemRight" valign="bottom"><b>cacheroledefs</b> = array()</td></tr>
<tr class="separator:gaa41d0c434384a9381417f43e196cb7d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc879f41ad412efa2fc8022359b3ebfb" id="r_gacc879f41ad412efa2fc8022359b3ebfb"><td class="memItemLeft" align="right" valign="top"><a id="gacc879f41ad412efa2fc8022359b3ebfb" name="gacc879f41ad412efa2fc8022359b3ebfb"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CAP_ALLOW</b> 1</td></tr>
<tr class="memdesc:gacc879f41ad412efa2fc8022359b3ebfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow permission, overrides CAP_PREVENT defined in parent contexts. <br /></td></tr>
<tr class="separator:gacc879f41ad412efa2fc8022359b3ebfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga017f65d9de6ebb83cad8421adf10b987" id="r_ga017f65d9de6ebb83cad8421adf10b987"><td class="memItemLeft" align="right" valign="top"><a id="ga017f65d9de6ebb83cad8421adf10b987" name="ga017f65d9de6ebb83cad8421adf10b987"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CAP_INHERIT</b> 0</td></tr>
<tr class="memdesc:ga017f65d9de6ebb83cad8421adf10b987"><td class="mdescLeft">&#160;</td><td class="mdescRight">No capability change. <br /></td></tr>
<tr class="separator:ga017f65d9de6ebb83cad8421adf10b987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga445022a4bed803c5c977ea8a2a2d9d48" id="r_ga445022a4bed803c5c977ea8a2a2d9d48"><td class="memItemLeft" align="right" valign="top"><a id="ga445022a4bed803c5c977ea8a2a2d9d48" name="ga445022a4bed803c5c977ea8a2a2d9d48"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CAP_PREVENT</b> -1</td></tr>
<tr class="memdesc:ga445022a4bed803c5c977ea8a2a2d9d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prevent permission, overrides CAP_ALLOW defined in parent contexts. <br /></td></tr>
<tr class="separator:ga445022a4bed803c5c977ea8a2a2d9d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga092d97073339b37bc54489e7b3ecddc4" id="r_ga092d97073339b37bc54489e7b3ecddc4"><td class="memItemLeft" align="right" valign="top"><a id="ga092d97073339b37bc54489e7b3ecddc4" name="ga092d97073339b37bc54489e7b3ecddc4"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CAP_PROHIBIT</b> -1000</td></tr>
<tr class="memdesc:ga092d97073339b37bc54489e7b3ecddc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prohibit permission, overrides everything in current and child contexts. <br /></td></tr>
<tr class="separator:ga092d97073339b37bc54489e7b3ecddc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf26e0e9d63f6aa70f446e178150f0127" id="r_gaf26e0e9d63f6aa70f446e178150f0127"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaf26e0e9d63f6aa70f446e178150f0127">CONTEXT_BLOCK</a> 80</td></tr>
<tr class="memdesc:gaf26e0e9d63f6aa70f446e178150f0127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block context level - one instance for each block, sticky blocks are tricky because ppl think they should be able to override them at lower contexts.  <br /></td></tr>
<tr class="separator:gaf26e0e9d63f6aa70f446e178150f0127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6793164cc4e484b90054c9938b7689ed" id="r_ga6793164cc4e484b90054c9938b7689ed"><td class="memItemLeft" align="right" valign="top"><a id="ga6793164cc4e484b90054c9938b7689ed" name="ga6793164cc4e484b90054c9938b7689ed"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CONTEXT_COURSE</b> 50</td></tr>
<tr class="memdesc:ga6793164cc4e484b90054c9938b7689ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Course context level - one instances for each course. <br /></td></tr>
<tr class="separator:ga6793164cc4e484b90054c9938b7689ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b60db455942f13f33223f6490295a5e" id="r_ga7b60db455942f13f33223f6490295a5e"><td class="memItemLeft" align="right" valign="top"><a id="ga7b60db455942f13f33223f6490295a5e" name="ga7b60db455942f13f33223f6490295a5e"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CONTEXT_COURSECAT</b> 40</td></tr>
<tr class="memdesc:ga7b60db455942f13f33223f6490295a5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Course category context level - one instance for each category. <br /></td></tr>
<tr class="separator:ga7b60db455942f13f33223f6490295a5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad810921ece54f4a0ccee43743267164f" id="r_gad810921ece54f4a0ccee43743267164f"><td class="memItemLeft" align="right" valign="top"><a id="gad810921ece54f4a0ccee43743267164f" name="gad810921ece54f4a0ccee43743267164f"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CONTEXT_MODULE</b> 70</td></tr>
<tr class="memdesc:gad810921ece54f4a0ccee43743267164f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Course module context level - one instance for each course module. <br /></td></tr>
<tr class="separator:gad810921ece54f4a0ccee43743267164f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1cef4b21548a9d4e72b5b85a4355cacd" id="r_ga1cef4b21548a9d4e72b5b85a4355cacd"><td class="memItemLeft" align="right" valign="top"><a id="ga1cef4b21548a9d4e72b5b85a4355cacd" name="ga1cef4b21548a9d4e72b5b85a4355cacd"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CONTEXT_SYSTEM</b> 10</td></tr>
<tr class="memdesc:ga1cef4b21548a9d4e72b5b85a4355cacd"><td class="mdescLeft">&#160;</td><td class="mdescRight">System context level - only one instance in every system. <br /></td></tr>
<tr class="separator:ga1cef4b21548a9d4e72b5b85a4355cacd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9712ed92a52cc217fa9790e42ab62906" id="r_ga9712ed92a52cc217fa9790e42ab62906"><td class="memItemLeft" align="right" valign="top"><a id="ga9712ed92a52cc217fa9790e42ab62906" name="ga9712ed92a52cc217fa9790e42ab62906"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>CONTEXT_USER</b> 30</td></tr>
<tr class="memdesc:ga9712ed92a52cc217fa9790e42ab62906"><td class="mdescLeft">&#160;</td><td class="mdescRight">User context level - one instance for each user describing what others can do to user. <br /></td></tr>
<tr class="separator:ga9712ed92a52cc217fa9790e42ab62906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa064d2cdc0a83daac8c513062ae93353" id="r_gaa064d2cdc0a83daac8c513062ae93353"><td class="memItemLeft" align="right" valign="top"><a id="gaa064d2cdc0a83daac8c513062ae93353" name="gaa064d2cdc0a83daac8c513062ae93353"></a>
$ACCESSLIB_PRIVATE&#160;</td><td class="memItemRight" valign="bottom"><b>dirtycontexts</b> = null</td></tr>
<tr class="separator:gaa064d2cdc0a83daac8c513062ae93353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa80259013e9d57accacbb622efd2179" id="r_gafa80259013e9d57accacbb622efd2179"><td class="memItemLeft" align="right" valign="top"><a id="gafa80259013e9d57accacbb622efd2179" name="gafa80259013e9d57accacbb622efd2179"></a>
$ACCESSLIB_PRIVATE&#160;</td><td class="memItemRight" valign="bottom"><b>dirtyusers</b> = null</td></tr>
<tr class="separator:gafa80259013e9d57accacbb622efd2179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga304236f3ff45585fb9ed90d829326b35" id="r_ga304236f3ff45585fb9ed90d829326b35"><td class="memItemLeft" align="right" valign="top"><a id="ga304236f3ff45585fb9ed90d829326b35" name="ga304236f3ff45585fb9ed90d829326b35"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_CONFIG</b> 0x0002</td></tr>
<tr class="memdesc:ga304236f3ff45585fb9ed90d829326b35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capability allows changes in system configuration - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:ga304236f3ff45585fb9ed90d829326b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10c1c41a7634e875263ac791efd19ca9" id="r_ga10c1c41a7634e875263ac791efd19ca9"><td class="memItemLeft" align="right" valign="top"><a id="ga10c1c41a7634e875263ac791efd19ca9" name="ga10c1c41a7634e875263ac791efd19ca9"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_DATALOSS</b> 0x0020</td></tr>
<tr class="memdesc:ga10c1c41a7634e875263ac791efd19ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">capability allows mass delete of data belonging to other users - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:ga10c1c41a7634e875263ac791efd19ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35798fee03098f2764bfdb6b410970f1" id="r_ga35798fee03098f2764bfdb6b410970f1"><td class="memItemLeft" align="right" valign="top"><a id="ga35798fee03098f2764bfdb6b410970f1" name="ga35798fee03098f2764bfdb6b410970f1"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_MANAGETRUST</b> 0x0001</td></tr>
<tr class="memdesc:ga35798fee03098f2764bfdb6b410970f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capability allow management of trusts - NOT IMPLEMENTED YET - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:ga35798fee03098f2764bfdb6b410970f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad68508d7c7f80d12610f8ff3178cc99d" id="r_gad68508d7c7f80d12610f8ff3178cc99d"><td class="memItemLeft" align="right" valign="top"><a id="gad68508d7c7f80d12610f8ff3178cc99d" name="gad68508d7c7f80d12610f8ff3178cc99d"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_PERSONAL</b> 0x0008</td></tr>
<tr class="memdesc:gad68508d7c7f80d12610f8ff3178cc99d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capability allows access to personal user information - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:gad68508d7c7f80d12610f8ff3178cc99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e63da95ef5699a97db646d0f02e60b9" id="r_ga6e63da95ef5699a97db646d0f02e60b9"><td class="memItemLeft" align="right" valign="top"><a id="ga6e63da95ef5699a97db646d0f02e60b9" name="ga6e63da95ef5699a97db646d0f02e60b9"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_SPAM</b> 0x0010</td></tr>
<tr class="memdesc:ga6e63da95ef5699a97db646d0f02e60b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capability allows users to add content others may see - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:ga6e63da95ef5699a97db646d0f02e60b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1ead7c9024d669a97ff733524b34e09" id="r_gad1ead7c9024d669a97ff733524b34e09"><td class="memItemLeft" align="right" valign="top"><a id="gad1ead7c9024d669a97ff733524b34e09" name="gad1ead7c9024d669a97ff733524b34e09"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>RISK_XSS</b> 0x0004</td></tr>
<tr class="memdesc:gad1ead7c9024d669a97ff733524b34e09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capability allows user to add scripted content - see <a href="https://moodledev.io/docs/apis/subsystems/roles" class="el externalurl"></a> <br /></td></tr>
<tr class="separator:gad1ead7c9024d669a97ff733524b34e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4497076d088c6236b84e9cd966b1956b" id="r_ga4497076d088c6236b84e9cd966b1956b"><td class="memItemLeft" align="right" valign="top"><a id="ga4497076d088c6236b84e9cd966b1956b" name="ga4497076d088c6236b84e9cd966b1956b"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_ALIAS</b> 1</td></tr>
<tr class="memdesc:ga4497076d088c6236b84e9cd966b1956b"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - the name as defined by a role alias at the course level, falls back to ROLENAME_ORIGINAL if alias not present <br /></td></tr>
<tr class="separator:ga4497076d088c6236b84e9cd966b1956b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga357baf3009611a4b445b865c36d493ea" id="r_ga357baf3009611a4b445b865c36d493ea"><td class="memItemLeft" align="right" valign="top"><a id="ga357baf3009611a4b445b865c36d493ea" name="ga357baf3009611a4b445b865c36d493ea"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_ALIAS_RAW</b> 4</td></tr>
<tr class="memdesc:ga357baf3009611a4b445b865c36d493ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - the name as defined by a role alias, in raw form suitable for editing <br /></td></tr>
<tr class="separator:ga357baf3009611a4b445b865c36d493ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b7ae19bb7dc9f0de86bb363531b7355" id="r_ga8b7ae19bb7dc9f0de86bb363531b7355"><td class="memItemLeft" align="right" valign="top"><a id="ga8b7ae19bb7dc9f0de86bb363531b7355" name="ga8b7ae19bb7dc9f0de86bb363531b7355"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_BOTH</b> 2</td></tr>
<tr class="memdesc:ga8b7ae19bb7dc9f0de86bb363531b7355"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - Both, like this: Role alias (Original) <br /></td></tr>
<tr class="separator:ga8b7ae19bb7dc9f0de86bb363531b7355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13b255ebd797302b06ebef3ea6a424f6" id="r_ga13b255ebd797302b06ebef3ea6a424f6"><td class="memItemLeft" align="right" valign="top"><a id="ga13b255ebd797302b06ebef3ea6a424f6" name="ga13b255ebd797302b06ebef3ea6a424f6"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_ORIGINAL</b> 0</td></tr>
<tr class="memdesc:ga13b255ebd797302b06ebef3ea6a424f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - the name as defined in the role definition, localised if name empty <br /></td></tr>
<tr class="separator:ga13b255ebd797302b06ebef3ea6a424f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga299da90d4ff38b7943cd43136acea944" id="r_ga299da90d4ff38b7943cd43136acea944"><td class="memItemLeft" align="right" valign="top"><a id="ga299da90d4ff38b7943cd43136acea944" name="ga299da90d4ff38b7943cd43136acea944"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_ORIGINALANDSHORT</b> 3</td></tr>
<tr class="memdesc:ga299da90d4ff38b7943cd43136acea944"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - the name as defined in the role definition and the shortname in brackets <br /></td></tr>
<tr class="separator:ga299da90d4ff38b7943cd43136acea944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac17ec92ab165e1159dbd2912e68eec07" id="r_gac17ec92ab165e1159dbd2912e68eec07"><td class="memItemLeft" align="right" valign="top"><a id="gac17ec92ab165e1159dbd2912e68eec07" name="gac17ec92ab165e1159dbd2912e68eec07"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>ROLENAME_SHORT</b> 5</td></tr>
<tr class="memdesc:gac17ec92ab165e1159dbd2912e68eec07"><td class="mdescLeft">&#160;</td><td class="mdescRight">rolename displays - the name is simply short role name <br /></td></tr>
<tr class="separator:gac17ec92ab165e1159dbd2912e68eec07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga0e5c6f5ecdd9c5011fbc0eda103e1769" name="ga0e5c6f5ecdd9c5011fbc0eda103e1769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e5c6f5ecdd9c5011fbc0eda103e1769">&#9670;&#160;</a></span>assign_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">assign_capability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$permission</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$overwrite</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$performancehints</em><span class="paramdefsep"> = </span><span class="paramdefval">[]</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to write context specific overrides, or default capabilities. </p>
<p>The $performancehints array can currently contain two values intended to make this faster when this function is being called in a loop, if you have already checked certain details: 'contextexists' - if we already know the contextid exists in context table ASSIGN_HINT_NO_EXISTING - if we already know there is no entry in role_capabilities matching contextid, roleid, and capability</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>string name </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$permission</td><td>CAP_ constants </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td>role id </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;context</td><td class="paramname">$contextid</td><td>context id </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$overwrite</td><td></td></tr>
    <tr><td class="paramtype">string[]</td><td class="paramname">$performancehints</td><td>Performance hints - leave blank unless needed </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>always true or exception </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4044312274e5f5f9bf768f1faa4587c5" name="ga4044312274e5f5f9bf768f1faa4587c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4044312274e5f5f9bf768f1faa4587c5">&#9670;&#160;</a></span>assign_legacy_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">assign_legacy_capabilities </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$legacyperms</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign the defaults found in this capability definition to roles that have the corresponding legacy capabilities assigned to them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$legacyperms</td><td>an array in the format (example): 'guest' =&gt; CAP_PREVENT, 'student' =&gt; CAP_ALLOW, 'teacher' =&gt; CAP_ALLOW, 'editingteacher' =&gt; CAP_ALLOW, 'coursecreator' =&gt; CAP_ALLOW, 'manager' =&gt; CAP_ALLOW </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>success or failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad5c5c0f0093c4b085455c14c0c5c7fa4" name="gad5c5c0f0093c4b085455c14c0c5c7fa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5c5c0f0093c4b085455c14c0c5c7fa4">&#9670;&#160;</a></span>can_access_course()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">can_access_course </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$course</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$user</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$withcapability</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$onlyactive</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the user is able to access the course. </p>
<p>This function is in no way, shape, or form a substitute for require_login. It should only be used in circumstances where it is not possible to call require_login such as the navigation.</p>
<p>This function checks many of the methods of access to a course such as the view capability, enrollments, and guest access. It also makes use of the cache generated by require_login for guest access.</p>
<p>The flags within the $USER object that are used here should NEVER be used outside of this function can_access_course and require_login. Doing so WILL break future versions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$course</td><td>record </td></tr>
    <tr><td class="paramtype">stdClass&#160;|&#160;int&#160;|&#160;null</td><td class="paramname">$user</td><td>user record or id, current user if null </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$withcapability</td><td>Check for this capability as well. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$onlyactive</td><td>consider only active enrolments in enabled plugins and time restrictions </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>Returns true if the user is able to access the course </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga73fb6f7b305131ff1d48fa08e020e187" name="ga73fb6f7b305131ff1d48fa08e020e187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga73fb6f7b305131ff1d48fa08e020e187">&#9670;&#160;</a></span>component_level_changed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">component_level_changed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$cap</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$comp</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextlevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aids in detecting if a new line is required when reading a new capability. </p>
<p>This function helps admin/roles/manage.php etc to detect if a new line should be printed when we read in a new capability. Most of the time, if the 2 components are different we should print a new line, (e.g. course system-&gt;rss client) but when we are in grade, all reports/import/export capabilities should be together</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$cap</td><td>component string a </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$comp</td><td>component string b </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$contextlevel</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>whether 2 component are in different "sections" </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad3c8bcb840b64feaed9dd0da770246b1" name="gad3c8bcb840b64feaed9dd0da770246b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3c8bcb840b64feaed9dd0da770246b1">&#9670;&#160;</a></span>core_role_set_assign_allowed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_role_set_assign_allowed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fromroleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetroleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a record in the role_allow_assign table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$fromroleid</td><td>source roleid </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetroleid</td><td>target roleid </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga328f41c9ebd5b1dc5c82afe17cb048b7" name="ga328f41c9ebd5b1dc5c82afe17cb048b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga328f41c9ebd5b1dc5c82afe17cb048b7">&#9670;&#160;</a></span>core_role_set_override_allowed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_role_set_override_allowed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fromroleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetroleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a record in the role_allow_override table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$fromroleid</td><td>source roleid </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetroleid</td><td>target roleid </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad789a6560ddff7773934c2a2c2b6b2f5" name="gad789a6560ddff7773934c2a2c2b6b2f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad789a6560ddff7773934c2a2c2b6b2f5">&#9670;&#160;</a></span>core_role_set_switch_allowed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_role_set_switch_allowed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fromroleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetroleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a record in the role_allow_switch table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$fromroleid</td><td>source roleid </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetroleid</td><td>target roleid </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga47bd0411f15fb14e5bf8d5794464e9fa" name="ga47bd0411f15fb14e5bf8d5794464e9fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47bd0411f15fb14e5bf8d5794464e9fa">&#9670;&#160;</a></span>core_role_set_view_allowed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_role_set_view_allowed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fromroleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetroleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a record in the role_allow_view table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$fromroleid</td><td>source roleid </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetroleid</td><td>target roleid </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1f467700c1117ca97f289cbedc83a3fd" name="ga1f467700c1117ca97f289cbedc83a3fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1f467700c1117ca97f289cbedc83a3fd">&#9670;&#160;</a></span>count_role_users()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">count_role_users </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$parent</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counts all the users assigned this role in this context or higher. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;array</td><td class="paramname">$roleid</td><td>either int or an array of ints </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$parent</td><td>if true, get list of users assigned in higher context too </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>Returns the result count </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga20f99c5e8f189803231f52e4e37ae1f8" name="ga20f99c5e8f189803231f52e4e37ae1f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20f99c5e8f189803231f52e4e37ae1f8">&#9670;&#160;</a></span>create_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">create_role </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$name</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$shortname</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$description</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$archetype</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that creates a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>role name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$shortname</td><td>role short name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$description</td><td>role description </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$archetype</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>id or <a class="el" href="../../d5/d5c/classdml__exception.html">dml_exception</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga31f98de8b303947a9245a927602b56ec" name="ga31f98de8b303947a9245a927602b56ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31f98de8b303947a9245a927602b56ec">&#9670;&#160;</a></span>delete_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">delete_role </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function that deletes a role and cleanups up after it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td>id of role to delete </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>always true </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaff9b19b544cb4c3af7ff2dbe78bf0640" name="gaff9b19b544cb4c3af7ff2dbe78bf0640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff9b19b544cb4c3af7ff2dbe78bf0640">&#9670;&#160;</a></span>extract_suspended_users()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">extract_suspended_users </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;</td>          <td class="paramname"><span class="paramname"><em>$users</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ignoreusers</em><span class="paramdefsep"> = </span><span class="paramdefval">array()</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given context and array of users, returns array of users whose enrolment status is suspended, or enrolment has expired or has not started. </p>
<p>Also removes those users from the given array</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>context in which suspended users should be extracted. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$users</td><td>list of users. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$ignoreusers</td><td>array of user ids to ignore, e.g. guest </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of suspended users. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1b916e8e765a9e7a808e41ceb536b9fc" name="ga1b916e8e765a9e7a808e41ceb536b9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1b916e8e765a9e7a808e41ceb536b9fc">&#9670;&#160;</a></span>fix_role_sortorder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fix_role_sortorder </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$allroles</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fix the roles.sortorder field in the database, so it contains sequential integers, and return an array of roleids in order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$allroles</td><td>array of roles, as returned by <a class="el" href="#gab826913ef6aa23566fc9cc49b3cb8b90" title="Returns all site roles in correct sort order.">get_all_roles()</a>; </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array::$role-,&gt;sortorder</td><td>=-&gt; $role-&gt;id with the keys in ascending order. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab7d3fa115f042eee7d883ea8909547d9" name="gab7d3fa115f042eee7d883ea8909547d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab7d3fa115f042eee7d883ea8909547d9">&#9670;&#160;</a></span>get_all_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_all_capabilities </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns all capabilitiy records, preferably from MUC and not database. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>All capability records indexed by capability name </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4da976b4aa3c72c607ab4560a9add05b" name="ga4da976b4aa3c72c607ab4560a9add05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4da976b4aa3c72c607ab4560a9add05b">&#9670;&#160;</a></span>get_all_risks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_all_risks </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an array of all the known types of risk The array keys can be used, for example as CSS class names, or in calls to print_risk_icon. </p>
<p>The values are the corresponding RISK_ constants.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>all the known types of risk. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab826913ef6aa23566fc9cc49b3cb8b90" name="gab826913ef6aa23566fc9cc49b3cb8b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab826913ef6aa23566fc9cc49b3cb8b90">&#9670;&#160;</a></span>get_all_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_all_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns all site roles in correct sort order. </p>
<p>Note: this method does not localise role names or descriptions, use <a class="el" href="#gadf5d6be413bc83b11f1a7842ab34b2bf" title="Get all the localised role names for a context.">role_get_names()</a> if you need role names.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>optional context for course role name aliases </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of role records with optional coursealias property </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad2492b6ae94d98c374a171bd0fd81eb8" name="gad2492b6ae94d98c374a171bd0fd81eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2492b6ae94d98c374a171bd0fd81eb8">&#9670;&#160;</a></span>get_archetype_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_archetype_roles </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$archetype</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns roles of a specified archetype. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$archetype</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of full role records </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga742db860b11ecedf56f83185b61d26eb" name="ga742db860b11ecedf56f83185b61d26eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga742db860b11ecedf56f83185b61d26eb">&#9670;&#160;</a></span>get_assignable_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_assignable_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$withusercounts</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$user</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a list of roles that this user can assign in this context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td>the type of role name to display. One of the ROLENAME_X constants. Default ROLENAME_ALIAS. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$withusercounts</td><td>if true, count the number of users with each role. </td></tr>
    <tr><td class="paramtype">integer&#160;|&#160;object</td><td class="paramname">$user</td><td>A user id or object. By default (null) checks the permissions of the current user. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>if $withusercounts is false, then an array $roleid =&gt; $rolename. if $withusercounts is true, returns a list of three arrays, $rolenames, $rolecounts, and $nameswithcounts. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga854ed4600b36dc8377d9bcbdc5a95907" name="ga854ed4600b36dc8377d9bcbdc5a95907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga854ed4600b36dc8377d9bcbdc5a95907">&#9670;&#160;</a></span>get_capabilities_from_role_on_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_capabilities_from_role_on_context </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$role</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get all capabilities for this role on this context (overrides) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$role</td><td></td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4bbfc4b637693b92528151ccfcd8748e" name="ga4bbfc4b637693b92528151ccfcd8748e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4bbfc4b637693b92528151ccfcd8748e">&#9670;&#160;</a></span>get_capability_docs_link()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_capability_docs_link </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a link to moodle docs for a given capability name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$capability</td><td>a capability - a row from the mdl_capabilities table. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>the human-readable capability name as a link to <a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> Docs. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga517737effe562e088ce605a695920368" name="ga517737effe562e088ce605a695920368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga517737effe562e088ce605a695920368">&#9670;&#160;</a></span>get_capability_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_capability_info </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capabilityname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns capability information (cached) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capabilityname</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>or null if capability not found </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga058d59768f0c61d69433aa58dfe5831f" name="ga058d59768f0c61d69433aa58dfe5831f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga058d59768f0c61d69433aa58dfe5831f">&#9670;&#160;</a></span>get_capability_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_capability_string </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capabilityname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the human-readable, translated version of the capability. </p>
<p>Basically a big switch statement.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capabilityname</td><td>e.g. mod/choice:readresponses </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4059ae8da018cd7274be3a48433dfaee" name="ga4059ae8da018cd7274be3a48433dfaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4059ae8da018cd7274be3a48433dfaee">&#9670;&#160;</a></span>get_component_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_component_string </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$component</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextlevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This gets the mod/block/course/core etc strings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$contextlevel</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string|bool</td><td>String is success, false if failed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0ddcaac5f93ff61388ed9c9cc791ad18" name="ga0ddcaac5f93ff61388ed9c9cc791ad18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ddcaac5f93ff61388ed9c9cc791ad18">&#9670;&#160;</a></span>get_context_info_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_context_info_array </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns context instance plus related course and cm instances. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of ($context, $course, $cm) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga60062476167ca8b21387c7f1ca54e52f" name="ga60062476167ca8b21387c7f1ca54e52f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga60062476167ca8b21387c7f1ca54e52f">&#9670;&#160;</a></span>get_default_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_default_capabilities </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$archetype</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns default capabilities for given role archetype. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$archetype</td><td>role archetype </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga375fe15fa1a778d7e3a81de7115b69a2" name="ga375fe15fa1a778d7e3a81de7115b69a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga375fe15fa1a778d7e3a81de7115b69a2">&#9670;&#160;</a></span>get_default_contextlevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_default_contextlevels </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolearchetype</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns default context levels where roles can be assigned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$rolearchetype</td><td>one of the role archetypes - that is, one of the keys from the array returned by <a class="el" href="#ga4b3a6778d7d7292ee7fee13caa11410f" title="Returns array of all role archetypes.">get_role_archetypes()</a>; </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of the context levels at which this type of role may be assigned by default. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae06c72d126b730c50a297cfd258c8333" name="gae06c72d126b730c50a297cfd258c8333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae06c72d126b730c50a297cfd258c8333">&#9670;&#160;</a></span>get_default_role_archetype_allows()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_default_role_archetype_allows </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$archetype</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return default roles that can be assigned, overridden or switched by give role archetype. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$type</td><td>assign|override|switch|view </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$archetype</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of role ids </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga09b1eba3b9160056bb3d4cadf268d14a" name="ga09b1eba3b9160056bb3d4cadf268d14a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09b1eba3b9160056bb3d4cadf268d14a">&#9670;&#160;</a></span>get_deprecated_capability_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_deprecated_capability_info </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capabilityname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns deprecation info for this particular capabilty (cached) </p>
<p>Do not use this function except in the get_capability_info</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capabilityname</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass|null</td><td>with deprecation message and potential replacement if not null </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab59a0e62fc226a4952602ed064d3c5ef" name="gab59a0e62fc226a4952602ed064d3c5ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab59a0e62fc226a4952602ed064d3c5ef">&#9670;&#160;</a></span>get_guest_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_guest_role </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the default guest role, this is used for guest account, search engine spiders, etc. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>role record </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab25141a38b80146bc4c36c8837547897" name="gab25141a38b80146bc4c36c8837547897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab25141a38b80146bc4c36c8837547897">&#9670;&#160;</a></span>get_local_override()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_local_override </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the local override (if any) for a given capability in a role in a context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>local capability override </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabfe471980560b88a19dc699f4d051516" name="gabfe471980560b88a19dc699f4d051516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabfe471980560b88a19dc699f4d051516">&#9670;&#160;</a></span>get_overridable_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_overridable_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$withcounts</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a list of roles that this user can override in this context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td>the type of role name to display. One of the ROLENAME_X constants. Default ROLENAME_ALIAS. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$withcounts</td><td>if true, count the number of overrides that are set for each role. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>if $withcounts is false, then an array $roleid =&gt; $rolename. if $withusercounts is true, returns a list of three arrays, $rolenames, $rolecounts, and $nameswithcounts. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9c63ee2636ff556a822992b8a031f9e4" name="ga9c63ee2636ff556a822992b8a031f9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c63ee2636ff556a822992b8a031f9e4">&#9670;&#160;</a></span>get_profile_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_profile_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the list of roles assigned to this context and up (parents) from the aggregation of: a) the list of roles that are visible on user profile page and participants page (profileroles setting) and; b) if applicable, those roles that are assigned in the context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4b3a6778d7d7292ee7fee13caa11410f" name="ga4b3a6778d7d7292ee7fee13caa11410f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4b3a6778d7d7292ee7fee13caa11410f">&#9670;&#160;</a></span>get_role_archetypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_archetypes </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns array of all role archetypes. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa22b5be5494ae6bc9c32085891f677d0" name="gaa22b5be5494ae6bc9c32085891f677d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa22b5be5494ae6bc9c32085891f677d0">&#9670;&#160;</a></span>get_role_contextlevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_contextlevels </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return context levels where this role is assignable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$roleid</td><td>the id of a role. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of the context levels at which this role may be assigned. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae6f9384510b05dcbc81447619fee407b" name="gae6f9384510b05dcbc81447619fee407b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae6f9384510b05dcbc81447619fee407b">&#9670;&#160;</a></span>get_role_definitions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_definitions </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$roleids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetch raw "site wide" role definitions. </p>
<p>Even MUC static acceleration cache appears a bit slow for this. Important as can be hit hundreds of times per page.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$roleids</td><td>List of role ids to fetch definitions for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Complete definition for each requested role. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6968eb16a1953af54144833c2131e9a0" name="ga6968eb16a1953af54144833c2131e9a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6968eb16a1953af54144833c2131e9a0">&#9670;&#160;</a></span>get_role_definitions_uncached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_definitions_uncached </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$roleids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query raw "site wide" role definitions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$roleids</td><td>List of role ids to fetch definitions for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Complete definition for each requested role. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae4bfb489377303d064575ffa0756a5f3" name="gae4bfb489377303d064575ffa0756a5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4bfb489377303d064575ffa0756a5f3">&#9670;&#160;</a></span>get_role_names_with_caps_in_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_names_with_caps_in_context </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capabilities</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an array of role names that have ALL of the the supplied capabilities Uses <a class="el" href="#ga6418f9879fe9d13aaa87e1950eaee3a5" title="Returns an array of role IDs that have ALL of the the supplied capabilities Uses get_roles_with_cap_i...">get_roles_with_caps_in_context()</a>. </p>
<p>Returns $allowed minus $forbidden</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$capabilities</td><td>An array of capabilities </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of roles with all of the required capabilities </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1eb64f68288f6d8d04fb1ce3cf0f5798" name="ga1eb64f68288f6d8d04fb1ce3cf0f5798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1eb64f68288f6d8d04fb1ce3cf0f5798">&#9670;&#160;</a></span>get_role_users()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_role_users </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$parent</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fields</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$sort</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$all</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$group</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitfrom</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitnum</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$extrawheretest</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$whereorsortparams</em><span class="paramdefsep"> = </span><span class="paramdefval">array()</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets all the users assigned this role in this context or higher. </p>
<p>Note that moodle is based on capabilities and it is usually better to check permissions than to check role ids as the capabilities system is more flexible. If you really need, you can to use this function but consider has_capability() as a possible substitute.</p>
<p>All $sort fields are added into $fields if not present there yet.</p>
<p>If $roleid is an array or is empty (all roles) you need to set $fields (and $sort by extension) params according to it, as the first field returned by the database should be unique (ra.id is the best candidate).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;array</td><td class="paramname">$roleid</td><td>(can also be an array of ints!) </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$parent</td><td>if true, get list of users assigned in higher context too </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$fields</td><td>fields from user (u.) , role assignment (ra) or role (r.) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$sort</td><td>sort from user (u.) , role assignment (ra.) or role (r.). null =&gt; use default sort from users_order_by_sql. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$all</td><td>true means all, false means limit to enrolled users </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$group</td><td>defaults to '' </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$limitfrom</td><td>defaults to '' </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$limitnum</td><td>defaults to '' </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$extrawheretest</td><td>defaults to '' </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$whereorsortparams</td><td>any paramter values used by $sort or $extrawheretest. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gadbe0f7b472391ae7f0e0f9ec44f81408" name="gadbe0f7b472391ae7f0e0f9ec44f81408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadbe0f7b472391ae7f0e0f9ec44f81408">&#9670;&#160;</a></span>get_roles_for_contextlevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_for_contextlevels </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextlevel</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return roles suitable for assignment at the specified context level. </p>
<p>NOTE: this function name looks like a typo, should be probably get_roles_for_contextlevel()</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$contextlevel</td><td>a contextlevel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of role ids that are assignable at this context level. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1098e905ef351f974bb6f36084230069" name="ga1098e905ef351f974bb6f36084230069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1098e905ef351f974bb6f36084230069">&#9670;&#160;</a></span>get_roles_used_in_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_used_in_context </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$includeparents</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the list of roles assigned to this context and up (parents) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$includeparents,false</td><td>means without parents. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga03cc6680a53a24a80f501bf0059f062d" name="ga03cc6680a53a24a80f501bf0059f062d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga03cc6680a53a24a80f501bf0059f062d">&#9670;&#160;</a></span>get_roles_with_cap_in_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_with_cap_in_context </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns two lists, this can be used to find out if user has capability. </p>
<p>Having any needed role and no forbidden role in this context means user has this capability in this context. Use get_role_names_with_cap_in_context() if you need role names to display in the UI</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array($neededroles,$forbiddenroles)</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga971eb3acfb63288c23b5b7fa5a7bf9d3" name="ga971eb3acfb63288c23b5b7fa5a7bf9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga971eb3acfb63288c23b5b7fa5a7bf9d3">&#9670;&#160;</a></span>get_roles_with_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_with_capability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$permission</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the roles that have a given capability assigned to it. </p>
<p>This function does not resolve the actual permission of the capability. It just checks for permissions and overrides. Use <a class="el" href="#ga03cc6680a53a24a80f501bf0059f062d" title="Returns two lists, this can be used to find out if user has capability.">get_roles_with_cap_in_context()</a> if resolution is required.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>capability name (string) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$permission</td><td>optional, the permission defined for this capability either CAP_ALLOW, CAP_PREVENT or CAP_PROHIBIT. Defaults to null which means any. </td></tr>
    <tr><td class="paramtype">context&#160;|&#160;null</td><td class="paramname">$context</td><td>null means any </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of role records </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga6418f9879fe9d13aaa87e1950eaee3a5" name="ga6418f9879fe9d13aaa87e1950eaee3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6418f9879fe9d13aaa87e1950eaee3a5">&#9670;&#160;</a></span>get_roles_with_caps_in_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_with_caps_in_context </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capabilities</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an array of role IDs that have ALL of the the supplied capabilities Uses <a class="el" href="#ga03cc6680a53a24a80f501bf0059f062d" title="Returns two lists, this can be used to find out if user has capability.">get_roles_with_cap_in_context()</a>. </p>
<p>Returns $allowed minus $forbidden</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$capabilities</td><td>An array of capabilities </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of roles with all of the required capabilities </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9ec2ce1871d50a42a20441d94dfa30a1" name="ga9ec2ce1871d50a42a20441d94dfa30a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ec2ce1871d50a42a20441d94dfa30a1">&#9670;&#160;</a></span>get_roles_with_override_on_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_roles_with_override_on_context </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get any role that has an override on exact context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>The context to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>An array of roles </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga54912b2efc769860963727a37542bfb7" name="ga54912b2efc769860963727a37542bfb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54912b2efc769860963727a37542bfb7">&#9670;&#160;</a></span>get_sorted_contexts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_sorted_contexts </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$select</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$params</em><span class="paramdefsep"> = </span><span class="paramdefval">array()</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs get_records select on context table and returns the result Does get_records_select on the context table, and returns the results ordered by contextlevel, and then the natural sort order within each level. </p>
<p>for the purpose of $select, you need to know that the context table has been aliased to ctx, so for example, you can call get_sorted_contexts('ctx.depth = 3');</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$select</td><td>the contents of the WHERE clause. Remember to do ctx.fieldname. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>any parameters required by $select. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>the requested context records. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabe424bab9d2f37c65dc4ddd1e72c19e7" name="gabe424bab9d2f37c65dc4ddd1e72c19e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe424bab9d2f37c65dc4ddd1e72c19e7">&#9670;&#160;</a></span>get_suspended_userids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_suspended_userids </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$usecache</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given context and array of users, returns array of user ids whose enrolment status is suspended, or enrolment has expired or not started. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>context in which user enrolment is checked. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$usecache</td><td>Enable or disable (default) the request cache </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of suspended user id's. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0802e1b7439f8766590563f7f63cd2ae" name="ga0802e1b7439f8766590563f7f63cd2ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0802e1b7439f8766590563f7f63cd2ae">&#9670;&#160;</a></span>get_switchable_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_switchable_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a list of roles that this user can switch to in a context. </p>
<p>Gets a list of roles that this user can switch to in a context, for the switchrole menu. This function just process the contents of the role_allow_switch table. You also need to test the moodle/role:switchroles to see if the user is allowed to switch in the first place.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>a context. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td>the type of role name to display. One of the ROLENAME_X constants. Default ROLENAME_ALIAS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>an array $roleid =&gt; $rolename. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafe0e63eb2ac64e2a09254bb166f96f2f" name="gafe0e63eb2ac64e2a09254bb166f96f2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe0e63eb2ac64e2a09254bb166f96f2f">&#9670;&#160;</a></span>get_user_capability_contexts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_user_capability_contexts </td>
          <td>(</td>
          <td class="paramtype">string</td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>$getcategories</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$doanything</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$coursefieldsexceptid</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$categoryfieldsexceptid</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseorderby</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$categoryorderby</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limit</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gets the list of course and course category contexts that this user has a particular capability in. </p>
<p>It is now reasonably efficient, but bear in mind that if there are users who have the capability everywhere, it may return an array of all contexts.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>Capability in question </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>User ID or null for current user </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$getcategories</td><td>Wether to return also course_categories </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$doanything</td><td>True if 'doanything' is permitted (default) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$coursefieldsexceptid</td><td>Leave blank if you only need 'id' in the course records; otherwise use a comma-separated list of the fields you require, not including id. Add ctxid, ctxpath, ctxdepth etc to return course context information for preloading. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$categoryfieldsexceptid</td><td>Leave blank if you only need 'id' in the course records; otherwise use a comma-separated list of the fields you require, not including id. Add ctxid, ctxpath, ctxdepth etc to return course context information for preloading. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$courseorderby</td><td>If set, use a comma-separated list of fields from course table with sql modifiers (DESC) if needed </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$categoryorderby</td><td>If set, use a comma-separated list of fields from course_category table with sql modifiers (DESC) if needed </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limit</td><td>Limit the number of courses to return on success. Zero equals all entries. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Array of categories and courses. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1ffab498514c3891fe6fcfda0ad641f0" name="ga1ffab498514c3891fe6fcfda0ad641f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1ffab498514c3891fe6fcfda0ad641f0">&#9670;&#160;</a></span>get_user_capability_course()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_user_capability_course </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$doanything</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fieldsexceptid</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$orderby</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limit</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function gets the list of courses that this user has a particular capability in. </p>
<p>It is now reasonably efficient, but bear in mind that if there are users who have the capability everywhere, it may return an array of all courses.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>Capability in question </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>User ID or null for current user </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$doanything</td><td>True if 'doanything' is permitted (default) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$fieldsexceptid</td><td>Leave blank if you only need 'id' in the course records; otherwise use a comma-separated list of the fields you require, not including id. Add ctxid, ctxpath, ctxdepth etc to return course context information for preloading. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$orderby</td><td>If set, use a comma-separated list of fields from course table with sql modifiers (DESC) if needed </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limit</td><td>Limit the number of courses to return on success. Zero equals all entries. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array|bool</td><td>Array of courses, if none found false is returned. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafc6bbc7f2d6c9cb12afebd6d37bfea50" name="gafc6bbc7f2d6c9cb12afebd6d37bfea50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc6bbc7f2d6c9cb12afebd6d37bfea50">&#9670;&#160;</a></span>get_user_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_user_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$checkparentcontexts</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$order</em><span class="paramdefsep"> = </span><span class="paramdefval">'c.contextlevel&#160;DESC</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">r.sortorder ASC'</td>          <td class="paramname"><span class="paramname"></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets all the user roles assigned in this context, or higher contexts this is mainly used when checking if a user can assign a role, or overriding a role i.e. </p>
<p>we need to know what this user holds, in order to verify against allow_assign and allow_override tables</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$checkparentcontexts</td><td>defaults to true </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$order</td><td>defaults to 'c.contextlevel DESC, r.sortorder ASC' </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab21940a04b70f1613f850825397feea7" name="gab21940a04b70f1613f850825397feea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab21940a04b70f1613f850825397feea7">&#9670;&#160;</a></span>get_user_roles_in_course()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_user_roles_in_course </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to print roles column in user profile page. </p>
<p>It is using the CFG-&gt;profileroles to limit the list to only interesting roles. (The permission tab has full details of user role assignments.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$courseid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga55a22e0153a398bd2943325dd322005b" name="ga55a22e0153a398bd2943325dd322005b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga55a22e0153a398bd2943325dd322005b">&#9670;&#160;</a></span>get_user_roles_with_special()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_user_roles_with_special </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Like get_user_roles, but adds in the authenticated user role, and the front page roles, if applicable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>optional. Defaults to $USER-&gt;id </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of objects with fields -&gt;userid, -&gt;contextid and -&gt;roleid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga66340c4f447ab44105bf8f56f709daa1" name="ga66340c4f447ab44105bf8f56f709daa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66340c4f447ab44105bf8f56f709daa1">&#9670;&#160;</a></span>get_users_by_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_users_by_capability </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$fields</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$sort</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitfrom</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$limitnum</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$groups</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$exceptions</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$notuseddoanything</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$notusedview</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$useviewallgroups</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Who has this capability in this context? </p>
<p>This can be a very expensive call - use sparingly and keep the results if you are going to need them again soon.</p>
<p>Note if $fields is empty this function attempts to get u.* which can get rather large - and has a serious perf impact on some DBs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$capability</td><td>- capability name(s) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$fields</td><td>- fields to be pulled. The user table is aliased to 'u'. u.id MUST be included. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$sort</td><td>- the sort order. Default is lastaccess time. </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$limitfrom</td><td>- number of records to skip (offset) </td></tr>
    <tr><td class="paramtype">mixed</td><td class="paramname">$limitnum</td><td>- number of records to fetch </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$groups</td><td>- single group or array of groups - only return users who are in one of these group(s). </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$exceptions</td><td>- list of users to exclude, comma separated or array </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$notuseddoanything</td><td>not used any more, admin accounts are never returned </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$notusedview</td><td>- use <a class="el" href="../../d0/de1/group__core.html#gabcabe8b60001a2a4877442c5a7c2ce08" title="Returns array with sql code and parameters returning all ids of users enrolled into course.">get_enrolled_sql()</a> instead </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$useviewallgroups</td><td>if $groups is set the return users who have capability both $capability and moodle/site:accessallgroups in this context, as well as users who have $capability and who are in $groups. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of user records </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga78d3d59a76533ca0789088767056a5f9" name="ga78d3d59a76533ca0789088767056a5f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78d3d59a76533ca0789088767056a5f9">&#9670;&#160;</a></span>get_users_from_role_on_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_users_from_role_on_context </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$role</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find all user assignment of users for this role, on this context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$role</td><td></td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf8bdf3dbf1c6cd5f7cefc1a795481023" name="gaf8bdf3dbf1c6cd5f7cefc1a795481023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf8bdf3dbf1c6cd5f7cefc1a795481023">&#9670;&#160;</a></span>get_users_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_users_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userids</em><span class="paramdefsep"> = </span><span class="paramdefval">[]</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$checkparentcontexts</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$order</em><span class="paramdefsep"> = </span><span class="paramdefval">'c.contextlevel&#160;DESC</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">r.sortorder ASC'</td>          <td class="paramname"><span class="paramname"></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets all the user roles assigned in this context, or higher contexts for a list of users. </p>
<p>If you try using the combination $userids = [], $checkparentcontexts = true then this is likely to cause an out-of-memory error on large <a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> sites, so this combination is deprecated and outputs a warning, even though it is the default.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$userids,.</td><td>An empty list means fetch all role assignments for the context. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$checkparentcontexts</td><td>defaults to true </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$order</td><td>defaults to 'c.contextlevel DESC, r.sortorder ASC' </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaba0a6031f350c2f5e8d497f55f96e60e" name="gaba0a6031f350c2f5e8d497f55f96e60e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba0a6031f350c2f5e8d497f55f96e60e">&#9670;&#160;</a></span>get_viewable_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_viewable_roles </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a list of roles that this user can view in a context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>a context. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>id of user. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td>the type of role name to display. One of the ROLENAME_X constants. Default ROLENAME_ALIAS. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>an array $roleid =&gt; $rolename. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9af89dd558ccf4003da846a79795180d" name="ga9af89dd558ccf4003da846a79795180d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9af89dd558ccf4003da846a79795180d">&#9670;&#160;</a></span>get_with_capability_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_with_capability_join </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$useridcolumn</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets sql joins for finding users with capability in the given context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>Context for the join. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$capability</td><td>Capability name or array of names. If an array is provided then this is the equivalent of a logical 'OR', i.e. the user needs to have one of these capabilities. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$useridcolumn</td><td>e.g. 'u.id'. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../dc/ddc/classcore_1_1dml_1_1sql__join.html">core::dml::sql_join</a></td><td>Contains joins, wheres, params. This function will set -&gt;cannotmatchanyrows if applicable. This may let you skip doing a <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a> query. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8ccdb2a5b0a983b87dc1c114f5d22481" name="ga8ccdb2a5b0a983b87dc1c114f5d22481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ccdb2a5b0a983b87dc1c114f5d22481">&#9670;&#160;</a></span>get_with_capability_sql()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_with_capability_sql </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets sql for finding users with capability in the given context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string&#160;|&#160;array</td><td class="paramname">$capability</td><td>Capability name or array of names. If an array is provided then this is the equivalent of a logical 'OR', i.e. the user needs to have one of these capabilities. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array($sql,$params)</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaab116aa603700860d827daf7de08fb49" name="gaab116aa603700860d827daf7de08fb49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab116aa603700860d827daf7de08fb49">&#9670;&#160;</a></span>has_coursecontact_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">has_coursecontact_role </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if user has at least one role assign of 'coursecontact' role (is potentially listed in some course descriptions). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafb6c185fda8568262bb328514d383579" name="gafb6c185fda8568262bb328514d383579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb6c185fda8568262bb328514d383579">&#9670;&#160;</a></span>is_inside_frontpage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">is_inside_frontpage </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if context is the front page context or a context inside it. </p>
<p>Returns true if this context is the front page context, or a context inside it, otherwise false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>a context object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga35d16f693ab63233f0b180529ae9940d" name="ga35d16f693ab63233f0b180529ae9940d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga35d16f693ab63233f0b180529ae9940d">&#9670;&#160;</a></span>is_role_switched()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">is_role_switched </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the user has switched roles within the given course. </p>
<p>Note: You can only switch roles within the course, hence it takes a course id rather than a context. On that note Petr volunteered to implement this across all other contexts, all requests for this should be forwarded to him ;)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$courseid</td><td>The id of the course to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if the user has switched roles within the course. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad0cc97536e38d210276ece73b2dc1288" name="gad0cc97536e38d210276ece73b2dc1288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad0cc97536e38d210276ece73b2dc1288">&#9670;&#160;</a></span>is_safe_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">is_safe_capability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify capability risks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$capability</td><td>a capability - a row from the capabilities table. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>whether this capability is safe - that is, whether people with the safeoverrides capability should be allowed to change it. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5474d366746ba4fb687b3efb48e2a599" name="ga5474d366746ba4fb687b3efb48e2a599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5474d366746ba4fb687b3efb48e2a599">&#9670;&#160;</a></span>load_temp_course_role()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_temp_course_role </td>
          <td>(</td>
          <td class="paramtype">context_course</td>          <td class="paramname"><span class="paramname"><em>$coursecontext</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a temp role to current USER-&gt;access array. </p>
<p>Useful for the "temporary guest" access we grant to logged-in users. This is useful for enrol plugins only.</p>
<dl class="section since"><dt>Since</dt><dd><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> 2.2 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context_course</td><td class="paramname">$coursecontext</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gade0d5aba32c3f5de67424298c90ade16" name="gade0d5aba32c3f5de67424298c90ade16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade0d5aba32c3f5de67424298c90ade16">&#9670;&#160;</a></span>mark_user_dirty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mark_user_dirty </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mark a user as dirty (with timestamp) so as to force reloading of the user session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4a75f06472e00beffc8a083f777db4ae" name="ga4a75f06472e00beffc8a083f777db4ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a75f06472e00beffc8a083f777db4ae">&#9670;&#160;</a></span>prohibit_is_removable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">prohibit_is_removable </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function verifies the prohibit comes from this context and there are no more prohibits in parent contexts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaf57c585c7b4cec02246c3a1c6b9361a" name="gaaf57c585c7b4cec02246c3a1c6b9361a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf57c585c7b4cec02246c3a1c6b9361a">&#9670;&#160;</a></span>remove_temp_course_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">remove_temp_course_roles </td>
          <td>(</td>
          <td class="paramtype">context_course</td>          <td class="paramname"><span class="paramname"><em>$coursecontext</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes any extra guest roles from current USER-&gt;access array. </p>
<p>This is useful for enrol plugins only.</p>
<dl class="section since"><dt>Since</dt><dd><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> 2.2 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context_course</td><td class="paramname">$coursecontext</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae106921b5a4e5d4f797621cca8193cd7" name="gae106921b5a4e5d4f797621cca8193cd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae106921b5a4e5d4f797621cca8193cd7">&#9670;&#160;</a></span>require_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">require_capability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$doanything</em><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$errormessage</em><span class="paramdefsep"> = </span><span class="paramdefval">'nopermissions'</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$stringfile</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A convenience function that tests has_capability, and displays an error if the user does not have that capability. </p>
<p>NOTE before <a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> 2.0, this function attempted to make an appropriate require_login call before checking the capability. This is no longer the case. You must call require_login (or one of its variants) if you want to check the user is logged in, before you call this function.</p>
<dl class="section see"><dt>See also</dt><dd>has_capability()</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>the name of the capability to check. For example mod/forum:view </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context to check the capability in. You normally get this with context_xxxx::instance(). </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>A user id. By default (null) checks the permissions of the current user. </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$doanything</td><td>If false, ignore effect of admin role assignment </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$errormessage</td><td>The error string to to user. Defaults to 'nopermissions'. </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$stringfile</td><td>The language file to load the error string from. Defaults to 'error'. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td>terminates with an error if the user does not have the given capability. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga526d78545ea35b7f2d831de88244ccc8" name="ga526d78545ea35b7f2d831de88244ccc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga526d78545ea35b7f2d831de88244ccc8">&#9670;&#160;</a></span>reset_role_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">reset_role_capabilities </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset role capabilities to default according to selected role archetype. </p>
<p>If no archetype selected, removes all capabilities.</p>
<p>This applies to capabilities that are assigned to the role (that you could edit in the 'define roles' interface), and not to any capability overrides in different locations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td>ID of role to reset capabilities for </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad9942ad6f10a787833c5a686c9e36ebb" name="gad9942ad6f10a787833c5a686c9e36ebb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad9942ad6f10a787833c5a686c9e36ebb">&#9670;&#160;</a></span>role_assign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_assign </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$component</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$itemid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$timemodified</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function makes a role-assignment (a role for a user in a particular context) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td>the role of the id </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>userid </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;context</td><td class="paramname">$contextid</td><td>id of the context </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td>example 'enrol_ldap', defaults to '' which means manual assignment, </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$itemid</td><td>id of enrolment/auth plugin </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$timemodified</td><td>defaults to current time </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>new/existing id of the assignment </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae0c1dc75b9a8c3246d4cc10d838f6998" name="gae0c1dc75b9a8c3246d4cc10d838f6998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0c1dc75b9a8c3246d4cc10d838f6998">&#9670;&#160;</a></span>role_cap_duplicate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_cap_duplicate </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$sourcerole</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetrole</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Duplicates all the base definitions of a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$sourcerole</td><td>role to copy from </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetrole</td><td>id of role to copy to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaed47009d5c2358fb63fdf04c5756c4a2" name="gaed47009d5c2358fb63fdf04c5756c4a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed47009d5c2358fb63fdf04c5756c4a2">&#9670;&#160;</a></span>role_change_permission()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_change_permission </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capname</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$permission</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>More user friendly role permission changing, it should produce as few overrides as possible. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">stdClass&#160;|&#160;context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$capname</td><td>capability name </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$permission</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gacede73f3ae58af31201a498e461c8a6a" name="gacede73f3ae58af31201a498e461c8a6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacede73f3ae58af31201a498e461c8a6a">&#9670;&#160;</a></span>role_context_capabilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_context_capabilities </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$cap</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function pulls out all the resolved capabilities (overrides and defaults) of a role used in capability overrides in contexts at a given context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$cap</td><td>capability, optional, defaults to '' </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Array of capabilities </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9e09cdf5a4b6faa5c40d95c1039190d7" name="ga9e09cdf5a4b6faa5c40d95c1039190d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e09cdf5a4b6faa5c40d95c1039190d7">&#9670;&#160;</a></span>role_fix_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_fix_names </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleoptions</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$returnmenu</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare list of roles for display, apply aliases and localise default role names. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$roleoptions</td><td>array roleid =&gt; roleobject (with optional coursealias), strings are accepted for backwards compatibility only </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context, null means system context </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$returnmenu</td><td>null means keep the same format as $roleoptions, true means id=&gt;localname, false means id=&gt;rolerecord </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Array of context-specific role names, or role objects with a -&gt;localname field added. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab16dc200a0de5de83ca14a33a4293660" name="gab16dc200a0de5de83ca14a33a4293660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab16dc200a0de5de83ca14a33a4293660">&#9670;&#160;</a></span>role_get_description()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_get_description </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$role</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns localised role description if available. </p>
<p>If the name is empty it tries to find the default role name using hardcoded list of default role names or other methods in the future.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$role</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>localised role name </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1dd8f305e320a4c9ece907644944081b" name="ga1dd8f305e320a4c9ece907644944081b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1dd8f305e320a4c9ece907644944081b">&#9670;&#160;</a></span>role_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_get_name </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$role</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$context</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get localised role name or alias if exists and format the text. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$role</td><td>role object<ul>
<li>optional 'coursealias' property should be included for performance reasons if course context used</li>
<li>description property is not required here </li>
</ul>
</td></tr>
    <tr><td class="paramtype">context&#160;|&#160;bool</td><td class="paramname">$context</td><td>empty means system context </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td>type of role name </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>localised role name or course role name alias </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gadf5d6be413bc83b11f1a7842ab34b2bf" name="gadf5d6be413bc83b11f1a7842ab34b2bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf5d6be413bc83b11f1a7842ab34b2bf">&#9670;&#160;</a></span>role_get_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_get_names </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rolenamedisplay</em><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="#ga4497076d088c6236b84e9cd966b1956b">ROLENAME_ALIAS</a></span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$returnmenu</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get all the localised role names for a context. </p>
<p>In new installs default roles have empty names, this function add localised role names using current language pack.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context, null means system context </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">array</td><td>of role objects with a -&gt;localname field containing the context-specific role name. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rolenamedisplay</td><td></td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$returnmenu</td><td>true means id=&gt;localname, false means id=&gt;rolerecord </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Array of context-specific role names, or role objects with a -&gt;localname field added. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga30729206f2de12ab0bfe887db80031ad" name="ga30729206f2de12ab0bfe887db80031ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga30729206f2de12ab0bfe887db80031ad">&#9670;&#160;</a></span>role_switch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_switch </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switches the current user to another role for the current session and only in the given context. </p>
<p>The caller <em>must</em> check</p><ul>
<li>that this op is allowed</li>
<li>that the requested role can be switched to in this context (use get_switchable_roles)</li>
<li>that the requested role is NOT $CFG-&gt;defaultuserroleid</li>
</ul>
<p>To "unswitch" pass 0 as the roleid.</p>
<p>This function <em>will</em> modify $USER-&gt;access - beware</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$roleid</td><td>the role to switch to. </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td>the context in which to perform the switch. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>success or failure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8da408086f63145f9a3aa306b4b5ced0" name="ga8da408086f63145f9a3aa306b4b5ced0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8da408086f63145f9a3aa306b4b5ced0">&#9670;&#160;</a></span>role_unassign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_unassign </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$component</em><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$itemid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes one role assignment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$itemid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabcf07ea620a5032be4a95f54ce1b7a96" name="gabcf07ea620a5032be4a95f54ce1b7a96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabcf07ea620a5032be4a95f54ce1b7a96">&#9670;&#160;</a></span>role_unassign_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">role_unassign_all </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$params</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$subcontexts</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$includemanual</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes multiple role assignments, parameters may contain: 'roleid', 'userid', 'contextid', 'component', 'enrolid'. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>role assignment parameters </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$subcontexts</td><td>unassign in subcontexts too </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$includemanual</td><td>include manual role assignments too </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa626698a51598d556cff48793000af6b" name="gaa626698a51598d556cff48793000af6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa626698a51598d556cff48793000af6b">&#9670;&#160;</a></span>set_role_contextlevels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set_role_contextlevels </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$contextlevels</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the context levels at which a particular role can be assigned. </p>
<p>Throws exceptions in case of error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer</td><td class="paramname">$roleid</td><td>the id of a role. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$contextlevels</td><td>the context levels at which this role should be assignable, duplicate levels are removed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab4a08eb7131890af57f5fe305f55a9b8" name="gab4a08eb7131890af57f5fe305f55a9b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4a08eb7131890af57f5fe305f55a9b8">&#9670;&#160;</a></span>sort_by_roleassignment_authority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sort_by_roleassignment_authority </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$users</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roles</em><span class="paramdefsep"> = </span><span class="paramdefval">array()</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$sortpolicy</em><span class="paramdefsep"> = </span><span class="paramdefval">'locality'</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Re-sort a users array based on a sorting policy. </p>
<p>Will re-sort a $users results array (from <a class="el" href="#ga66340c4f447ab44105bf8f56f709daa1" title="Who has this capability in this context?">get_users_by_capability()</a>, usually) based on a sorting policy. This is to support the odd practice of sorting teachers by 'authority', where authority was "lowest id of the role
assignment".</p>
<p>Will execute 1 database query. Only suitable for small numbers of users, as it uses an u.id IN() clause.</p>
<p>Notes about the sorting criteria.</p>
<p>As a default, we cannot rely on role.sortorder because then admins/coursecreators will always win. That is why the sane rule "is locality matters most", with sortorder as 2nd consideration.</p>
<p>If you want role.sortorder, use the 'sortorder' policy, and name explicitly what roles you want to cover. It's probably a good idea to see what roles have the capabilities you want (array_diff() them against roiles that have 'can-do-anything' to weed out admin-ish roles. Or fetch a list of roles from variables like $CFG-&gt;coursecontact .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$users</td><td>Users array, keyed on userid </td></tr>
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$roles</td><td>ids of the roles to include, optional </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$sortpolicy</td><td>defaults to locality, more about </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>sorted copy of the array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac5fd541d0278f2ce8aaeb321b8b8851c" name="gac5fd541d0278f2ce8aaeb321b8b8851c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5fd541d0278f2ce8aaeb321b8b8851c">&#9670;&#160;</a></span>switch_roles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">switch_roles </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$first</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$second</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch the sort order of two roles (used in admin/roles/manage.php). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$first</td><td>The first role. Actually, only -&gt;sortorder is used. </td></tr>
    <tr><td class="paramtype">stdClass</td><td class="paramname">$second</td><td>The second role. Actually, only -&gt;sortorder is used. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>success or failure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga928246fb49c4eb83e351423e3e11e72a" name="ga928246fb49c4eb83e351423e3e11e72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga928246fb49c4eb83e351423e3e11e72a">&#9670;&#160;</a></span>unassign_capability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unassign_capability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$capability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unassign a capability from a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$capability</td><td>the name of the capability </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td>the role id </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;context</td><td class="paramname">$contextid</td><td>null means all contexts </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>true or exception </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gabb7f43b7c655ad190ca02f288d7f419f" name="gabb7f43b7c655ad190ca02f288d7f419f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabb7f43b7c655ad190ca02f288d7f419f">&#9670;&#160;</a></span>user_can_assign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">user_can_assign </td>
          <td>(</td>
          <td class="paramtype">context</td>          <td class="paramname"><span class="paramname"><em>$context</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$targetroleid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if a user can assign users to a particular role in this context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">context</td><td class="paramname">$context</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$targetroleid</td><td>- the id of the role you want to assign users to </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga094626c521a5191dec40e63c56be1733" name="ga094626c521a5191dec40e63c56be1733"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga094626c521a5191dec40e63c56be1733">&#9670;&#160;</a></span>user_has_role_assignment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">user_has_role_assignment </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$roleid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$contextid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simple function returning a boolean true if user has roles in context or parent contexts, otherwise false. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$roleid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td>empty means any context </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaf26e0e9d63f6aa70f446e178150f0127" name="gaf26e0e9d63f6aa70f446e178150f0127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf26e0e9d63f6aa70f446e178150f0127">&#9670;&#160;</a></span>CONTEXT_BLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const CONTEXT_BLOCK 80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Block context level - one instance for each block, sticky blocks are tricky because ppl think they should be able to override them at lower contexts. </p>
<p>Any other context level instance can be parent of block context. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 21 2024 02:31:15 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
