<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: tool_policy\api Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.4</span>
   </div>
   <div id="projectbrief">Moodle 4.4+ (Build: 20240503) (f88dbfcafc6)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../db/d53/namespacetool__policy.html">tool_policy</a></li><li class="navelem"><a class="el" href="../../da/de0/classtool__policy_1_1api.html">api</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="../../db/d56/classtool__policy_1_1api-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">tool_policy\api Class Reference<div class="ingroups"><a class="el" href="../../d4/d8b/group__tool__policy.html">tool_policy</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Provides the API of the policies plugin.  
 <a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a91047d42ccfefc27cbf2fe36c363e6b0" id="r_a91047d42ccfefc27cbf2fe36c363e6b0"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91047d42ccfefc27cbf2fe36c363e6b0">accept_policies</a> ($policyversionid, $userid=null, $note=null, $lang=null)</td></tr>
<tr class="memdesc:a91047d42ccfefc27cbf2fe36c363e6b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the given policy versions as accepted by the user.  <br /></td></tr>
<tr class="separator:a91047d42ccfefc27cbf2fe36c363e6b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad32991d18c53cd004d93726468dbe074" id="r_ad32991d18c53cd004d93726468dbe074"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad32991d18c53cd004d93726468dbe074">can_accept_policies</a> (array $versionids, $userid=null, $throwexception=false)</td></tr>
<tr class="memdesc:ad32991d18c53cd004d93726468dbe074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if given policies can be accepted by the current user (eventually on behalf of the other user)  <br /></td></tr>
<tr class="separator:ad32991d18c53cd004d93726468dbe074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa649144f88595998816ea384e10d7ca3" id="r_aa649144f88595998816ea384e10d7ca3"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa649144f88595998816ea384e10d7ca3">can_decline_policies</a> (array $versionids, $userid=null, $throwexception=false)</td></tr>
<tr class="memdesc:aa649144f88595998816ea384e10d7ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if given policies can be declined by the current user (eventually on behalf of the other user)  <br /></td></tr>
<tr class="separator:aa649144f88595998816ea384e10d7ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f29cfddcae0a6e70fb630e9fb2f30c5" id="r_a6f29cfddcae0a6e70fb630e9fb2f30c5"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f29cfddcae0a6e70fb630e9fb2f30c5">can_delete_version</a> ($version)</td></tr>
<tr class="memdesc:a6f29cfddcae0a6e70fb630e9fb2f30c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can the current version be deleted.  <br /></td></tr>
<tr class="separator:a6f29cfddcae0a6e70fb630e9fb2f30c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ceca4e44cd24786e97ce0c85d38acf1" id="r_a9ceca4e44cd24786e97ce0c85d38acf1"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ceca4e44cd24786e97ce0c85d38acf1">can_revoke_policies</a> (array $versionids, $userid=null, $throwexception=false)</td></tr>
<tr class="memdesc:a9ceca4e44cd24786e97ce0c85d38acf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if acceptances to given policies can be revoked by the current user (eventually on behalf of the other user)  <br /></td></tr>
<tr class="separator:a9ceca4e44cd24786e97ce0c85d38acf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862eab9858df52a50711a62921d3d48c" id="r_a862eab9858df52a50711a62921d3d48c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a862eab9858df52a50711a62921d3d48c">can_user_view_policy_version</a> ($policy, $behalfid=null, $userid=null)</td></tr>
<tr class="memdesc:a862eab9858df52a50711a62921d3d48c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can the user view the given policy version document?  <br /></td></tr>
<tr class="separator:a862eab9858df52a50711a62921d3d48c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab8b92bcf819c74f91c21e2f8e1392f" id="r_a4ab8b92bcf819c74f91c21e2f8e1392f"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ab8b92bcf819c74f91c21e2f8e1392f">count_total_users</a> ()</td></tr>
<tr class="memdesc:a4ab8b92bcf819c74f91c21e2f8e1392f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns total number of users who are expected to accept site policy.  <br /></td></tr>
<tr class="separator:a4ab8b92bcf819c74f91c21e2f8e1392f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2153b9fcc16c6dad49d05c0fd5dca83" id="r_ad2153b9fcc16c6dad49d05c0fd5dca83"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2153b9fcc16c6dad49d05c0fd5dca83">create_acceptances_user_created</a> (\core\event\user_created $event)</td></tr>
<tr class="memdesc:ad2153b9fcc16c6dad49d05c0fd5dca83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create user policy acceptances when the user is created.  <br /></td></tr>
<tr class="separator:ad2153b9fcc16c6dad49d05c0fd5dca83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8963c3c5ef024731e60a71c971bb24bc" id="r_a8963c3c5ef024731e60a71c971bb24bc"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8963c3c5ef024731e60a71c971bb24bc">decline_policies</a> ($policyversionid, $userid=null, $note=null, $lang=null)</td></tr>
<tr class="memdesc:a8963c3c5ef024731e60a71c971bb24bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the given policy versions as declined by the user.  <br /></td></tr>
<tr class="separator:a8963c3c5ef024731e60a71c971bb24bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bb9d6c035dfabf52515aabb86f3b1d6" id="r_a9bb9d6c035dfabf52515aabb86f3b1d6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9bb9d6c035dfabf52515aabb86f3b1d6">delete</a> ($versionid)</td></tr>
<tr class="memdesc:a9bb9d6c035dfabf52515aabb86f3b1d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete the given version (if it is a draft).  <br /></td></tr>
<tr class="separator:a9bb9d6c035dfabf52515aabb86f3b1d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6355a6a23f23d318c1e1699ba4ed6a2" id="r_ac6355a6a23f23d318c1e1699ba4ed6a2"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6355a6a23f23d318c1e1699ba4ed6a2">fix_revision_values</a> (array $versions)</td></tr>
<tr class="memdesc:ac6355a6a23f23d318c1e1699ba4ed6a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure that each version has a unique revision value.  <br /></td></tr>
<tr class="separator:ac6355a6a23f23d318c1e1699ba4ed6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c6900da7b93bfaf2a2a12ee0a458c6" id="r_a11c6900da7b93bfaf2a2a12ee0a458c6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11c6900da7b93bfaf2a2a12ee0a458c6">form_policydoc_add</a> (stdClass $form)</td></tr>
<tr class="memdesc:a11c6900da7b93bfaf2a2a12ee0a458c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the data from the policydoc form as a new policy document.  <br /></td></tr>
<tr class="separator:a11c6900da7b93bfaf2a2a12ee0a458c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33734409e341be9fc3b37e52959b611" id="r_aa33734409e341be9fc3b37e52959b611"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa33734409e341be9fc3b37e52959b611">form_policydoc_data</a> (<a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html">policy_version</a> $version)</td></tr>
<tr class="memdesc:aa33734409e341be9fc3b37e52959b611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare data for the <a class="el" href="../../da/d3d/classtool__policy_1_1form_1_1policydoc.html">tool_policy::form::policydoc</a> form.  <br /></td></tr>
<tr class="separator:aa33734409e341be9fc3b37e52959b611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a058017434dfe4b6879ced1476ebc1798" id="r_a058017434dfe4b6879ced1476ebc1798"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a058017434dfe4b6879ced1476ebc1798">form_policydoc_update_new</a> (stdClass $form)</td></tr>
<tr class="memdesc:a058017434dfe4b6879ced1476ebc1798"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the data from the policydoc form as a new policy document version.  <br /></td></tr>
<tr class="separator:a058017434dfe4b6879ced1476ebc1798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c5c93735b4d8f364bc3494eb44bb50" id="r_a19c5c93735b4d8f364bc3494eb44bb50"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19c5c93735b4d8f364bc3494eb44bb50">form_policydoc_update_overwrite</a> (stdClass $form)</td></tr>
<tr class="memdesc:a19c5c93735b4d8f364bc3494eb44bb50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the data from the policydoc form, overwriting the existing policy document version.  <br /></td></tr>
<tr class="separator:a19c5c93735b4d8f364bc3494eb44bb50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41bb17befea9f2e8728e5abbea7896b" id="r_ab41bb17befea9f2e8728e5abbea7896b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab41bb17befea9f2e8728e5abbea7896b">get_agreement_optional</a> ($versionid)</td></tr>
<tr class="memdesc:ab41bb17befea9f2e8728e5abbea7896b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the value of the optional flag for the given policy version.  <br /></td></tr>
<tr class="separator:ab41bb17befea9f2e8728e5abbea7896b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7af0bfeee77b7926e8cecd3eb949701" id="r_ad7af0bfeee77b7926e8cecd3eb949701"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7af0bfeee77b7926e8cecd3eb949701">get_current_versions_ids</a> ($audience=null)</td></tr>
<tr class="memdesc:ad7af0bfeee77b7926e8cecd3eb949701"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if there are any current policies defined and returns their ids only.  <br /></td></tr>
<tr class="separator:ad7af0bfeee77b7926e8cecd3eb949701"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9abf93f4901de83e8a1026a9f3be5a0" id="r_ae9abf93f4901de83e8a1026a9f3be5a0"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9abf93f4901de83e8a1026a9f3be5a0">get_policies_with_acceptances</a> ($userid)</td></tr>
<tr class="memdesc:ae9abf93f4901de83e8a1026a9f3be5a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of policies and versions that current user is able to see and the respective acceptance records for the selected user.  <br /></td></tr>
<tr class="separator:ae9abf93f4901de83e8a1026a9f3be5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c0bb19b30ae10563d6f6ef57c0dde1" id="r_ae6c0bb19b30ae10563d6f6ef57c0dde1"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6c0bb19b30ae10563d6f6ef57c0dde1">get_policy_version</a> ($versionid, $policies=null)</td></tr>
<tr class="memdesc:ae6c0bb19b30ae10563d6f6ef57c0dde1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a particular policy document version.  <br /></td></tr>
<tr class="separator:ae6c0bb19b30ae10563d6f6ef57c0dde1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28439c67955dd90aaadd55a06a95eaf8" id="r_a28439c67955dd90aaadd55a06a95eaf8"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28439c67955dd90aaadd55a06a95eaf8">get_user_acceptances</a> ($userid, $versions=null)</td></tr>
<tr class="memdesc:a28439c67955dd90aaadd55a06a95eaf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns list of acceptances for this user.  <br /></td></tr>
<tr class="separator:a28439c67955dd90aaadd55a06a95eaf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af358f28d575c8a640956a43802b4f2c2" id="r_af358f28d575c8a640956a43802b4f2c2"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af358f28d575c8a640956a43802b4f2c2">get_user_minors</a> ($userid, array $extrafields=null)</td></tr>
<tr class="memdesc:af358f28d575c8a640956a43802b4f2c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the user's minors - other users on which behalf we can accept policies.  <br /></td></tr>
<tr class="separator:af358f28d575c8a640956a43802b4f2c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad622bd5635a12b83b438eae66c858b28" id="r_ad622bd5635a12b83b438eae66c858b28"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad622bd5635a12b83b438eae66c858b28">get_user_version_acceptance</a> ($userid, $versionid, $acceptances=null)</td></tr>
<tr class="memdesc:ad622bd5635a12b83b438eae66c858b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns version acceptance for this user.  <br /></td></tr>
<tr class="separator:ad622bd5635a12b83b438eae66c858b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb938533cd087f1b89b65df285ad60fe" id="r_acb938533cd087f1b89b65df285ad60fe"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb938533cd087f1b89b65df285ad60fe">inactivate</a> ($policyid)</td></tr>
<tr class="memdesc:acb938533cd087f1b89b65df285ad60fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inactivate the policy document - no version marked as current and the document does not apply.  <br /></td></tr>
<tr class="separator:acb938533cd087f1b89b65df285ad60fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75da33b9b7f21cbc5226ec0252b6c896" id="r_a75da33b9b7f21cbc5226ec0252b6c896"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75da33b9b7f21cbc5226ec0252b6c896">is_user_version_accepted</a> ($userid, $versionid, $acceptances=null)</td></tr>
<tr class="memdesc:a75da33b9b7f21cbc5226ec0252b6c896"><td class="mdescLeft">&#160;</td><td class="mdescRight">Did the user accept the given policy version?  <br /></td></tr>
<tr class="separator:a75da33b9b7f21cbc5226ec0252b6c896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e36ae9a0bee3574dfde5b55e3a84a60" id="r_a4e36ae9a0bee3574dfde5b55e3a84a60"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e36ae9a0bee3574dfde5b55e3a84a60">list_current_versions</a> ($audience=null)</td></tr>
<tr class="memdesc:a4e36ae9a0bee3574dfde5b55e3a84a60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return current (active) policies versions.  <br /></td></tr>
<tr class="separator:a4e36ae9a0bee3574dfde5b55e3a84a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac374f3cd5e0d62d4b990d7f643e2b67c" id="r_ac374f3cd5e0d62d4b990d7f643e2b67c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac374f3cd5e0d62d4b990d7f643e2b67c">list_policies</a> ($ids=null, $countacceptances=false)</td></tr>
<tr class="memdesc:ac374f3cd5e0d62d4b990d7f643e2b67c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of all policy documents and their versions.  <br /></td></tr>
<tr class="separator:ac374f3cd5e0d62d4b990d7f643e2b67c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed2c2b19d16f8282b053cb71ba5ae80" id="r_a0ed2c2b19d16f8282b053cb71ba5ae80"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ed2c2b19d16f8282b053cb71ba5ae80">make_current</a> ($versionid)</td></tr>
<tr class="memdesc:a0ed2c2b19d16f8282b053cb71ba5ae80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the given version the current active one.  <br /></td></tr>
<tr class="separator:a0ed2c2b19d16f8282b053cb71ba5ae80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ba6faf6b3e174bd8859750ea0052417" id="r_a0ba6faf6b3e174bd8859750ea0052417"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ba6faf6b3e174bd8859750ea0052417">move_down</a> ($policyid)</td></tr>
<tr class="memdesc:a0ba6faf6b3e174bd8859750ea0052417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the given policy document down in the list.  <br /></td></tr>
<tr class="separator:a0ba6faf6b3e174bd8859750ea0052417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a120921b5ff9f296d6f113b503032586f" id="r_a120921b5ff9f296d6f113b503032586f"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a120921b5ff9f296d6f113b503032586f">move_up</a> ($policyid)</td></tr>
<tr class="memdesc:a120921b5ff9f296d6f113b503032586f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the given policy document up in the list.  <br /></td></tr>
<tr class="separator:a120921b5ff9f296d6f113b503032586f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1df40e9e1ed48c5156941a1a8e6597" id="r_aae1df40e9e1ed48c5156941a1a8e6597"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae1df40e9e1ed48c5156941a1a8e6597">policy_content_field_options</a> ()</td></tr>
<tr class="memdesc:aae1df40e9e1ed48c5156941a1a8e6597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Editor field options for the policy content text.  <br /></td></tr>
<tr class="separator:aae1df40e9e1ed48c5156941a1a8e6597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1692ca7f392f36c1a8950f4cc3e35559" id="r_a1692ca7f392f36c1a8950f4cc3e35559"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1692ca7f392f36c1a8950f4cc3e35559">policy_summary_field_options</a> ()</td></tr>
<tr class="memdesc:a1692ca7f392f36c1a8950f4cc3e35559"><td class="mdescLeft">&#160;</td><td class="mdescRight">Editor field options for the policy summary text.  <br /></td></tr>
<tr class="separator:a1692ca7f392f36c1a8950f4cc3e35559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22cbb95e8eb5ec75692a7411223f9de" id="r_ab22cbb95e8eb5ec75692a7411223f9de"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab22cbb95e8eb5ec75692a7411223f9de">revert_to_draft</a> ($versionid)</td></tr>
<tr class="memdesc:ab22cbb95e8eb5ec75692a7411223f9de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new draft policy document from an archived version.  <br /></td></tr>
<tr class="separator:ab22cbb95e8eb5ec75692a7411223f9de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d69644c8bfdfb802359eabf30fbb24" id="r_aa5d69644c8bfdfb802359eabf30fbb24"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5d69644c8bfdfb802359eabf30fbb24">revoke_acceptance</a> ($policyversionid, $userid, $note=null)</td></tr>
<tr class="memdesc:aa5d69644c8bfdfb802359eabf30fbb24"><td class="mdescLeft">&#160;</td><td class="mdescRight">May be used to revert accidentally granted acceptance for another user.  <br /></td></tr>
<tr class="separator:aa5d69644c8bfdfb802359eabf30fbb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a15a19e4fd73b0f8a602ed9738053ef" id="r_a5a15a19e4fd73b0f8a602ed9738053ef"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a15a19e4fd73b0f8a602ed9738053ef">update_policyagreed</a> ($user=null)</td></tr>
<tr class="memdesc:a5a15a19e4fd73b0f8a602ed9738053ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure that $user-&gt;policyagreed matches the agreement to the policies.  <br /></td></tr>
<tr class="separator:a5a15a19e4fd73b0f8a602ed9738053ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:ada70562167c3427afab2ddf2453453df" id="r_ada70562167c3427afab2ddf2453453df"><td class="memItemLeft" align="right" valign="top"><a id="ada70562167c3427afab2ddf2453453df" name="ada70562167c3427afab2ddf2453453df"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><b>distribute_policy_document_sortorder</b> ()</td></tr>
<tr class="memdesc:ada70562167c3427afab2ddf2453453df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-sets the sortorder field of the policy documents to even values. <br /></td></tr>
<tr class="separator:ada70562167c3427afab2ddf2453453df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fa0133a4935856a61922a769d980a9" id="r_ac8fa0133a4935856a61922a769d980a9"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8fa0133a4935856a61922a769d980a9">move_policy_document</a> ($policyid, $step)</td></tr>
<tr class="memdesc:ac8fa0133a4935856a61922a769d980a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the policy document's sortorder.  <br /></td></tr>
<tr class="separator:ac8fa0133a4935856a61922a769d980a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4752617b3ddcf7e552cb18ad9a50c13d" id="r_a4752617b3ddcf7e552cb18ad9a50c13d"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4752617b3ddcf7e552cb18ad9a50c13d">set_acceptances_status</a> ($policyversionid, $userid=null, $note=null, $lang=null, $status=1)</td></tr>
<tr class="memdesc:a4752617b3ddcf7e552cb18ad9a50c13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the given policy versions as accepted or declined by the user.  <br /></td></tr>
<tr class="separator:a4752617b3ddcf7e552cb18ad9a50c13d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides the API of the policies plugin. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2018 David Mudrak <a href="#" onclick="location.href='mai'+'lto:'+'dav'+'id'+'@mo'+'od'+'le.'+'co'+'m'; return false;">david<span class="obfuscator">.nosp@m.</span>@moo<span class="obfuscator">.nosp@m.</span>dle.c<span class="obfuscator">.nosp@m.</span>om</a> </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a91047d42ccfefc27cbf2fe36c363e6b0" name="a91047d42ccfefc27cbf2fe36c363e6b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91047d42ccfefc27cbf2fe36c363e6b0">&#9670;&#160;</a></span>accept_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::accept_policies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyversionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$note</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$lang</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark the given policy versions as accepted by the user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array&#160;|&#160;int</td><td class="paramname">$policyversionid</td><td>Policy version id(s) to set acceptance status for. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$userid</td><td>Id of the user accepting the policy version, defaults to the current one. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$note</td><td>Note to be recorded. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$lang</td><td>Language in which the policy was shown, defaults to the current one. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad32991d18c53cd004d93726468dbe074" name="ad32991d18c53cd004d93726468dbe074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad32991d18c53cd004d93726468dbe074">&#9670;&#160;</a></span>can_accept_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::can_accept_policies </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$versionids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$throwexception</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if given policies can be accepted by the current user (eventually on behalf of the other user) </p>
<p>Currently, the version ids are not relevant and the check is based on permissions only. In the future, additional conditions can be added (such as policies applying to certain users only).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$versionids</td><td>int[] List of policy version ids to check </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>Accepting policies on this user's behalf (defaults to accepting on self) </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$throwexception</td><td>Throw exception instead of returning false </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa649144f88595998816ea384e10d7ca3" name="aa649144f88595998816ea384e10d7ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa649144f88595998816ea384e10d7ca3">&#9670;&#160;</a></span>can_decline_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::can_decline_policies </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$versionids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$throwexception</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if given policies can be declined by the current user (eventually on behalf of the other user) </p>
<p>Only optional policies can be declined. Otherwise, the permissions are same as for accepting policies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$versionids</td><td>int[] List of policy version ids to check </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>Declining policies on this user's behalf (defaults to declining by self) </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$throwexception</td><td>Throw exception instead of returning false </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6f29cfddcae0a6e70fb630e9fb2f30c5" name="a6f29cfddcae0a6e70fb630e9fb2f30c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f29cfddcae0a6e70fb630e9fb2f30c5">&#9670;&#160;</a></span>can_delete_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::can_delete_version </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$version</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Can the current version be deleted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$version</td><td>object describing version, contains fields policyid, id, status, archived, audience, ... </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9ceca4e44cd24786e97ce0c85d38acf1" name="a9ceca4e44cd24786e97ce0c85d38acf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ceca4e44cd24786e97ce0c85d38acf1">&#9670;&#160;</a></span>can_revoke_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::can_revoke_policies </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$versionids</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$throwexception</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if acceptances to given policies can be revoked by the current user (eventually on behalf of the other user) </p>
<p>Revoking optional policies is controlled by the same rules as declining them. Compulsory policies can be revoked only by users with the permission to accept policies on other's behalf. The reasoning behind this is to make sure the user communicates with the site's privacy officer and is well aware of all consequences of the decision (such as losing right to access the site).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$versionids</td><td>int[] List of policy version ids to check </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>Revoking policies on this user's behalf (defaults to revoking by self) </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$throwexception</td><td>Throw exception instead of returning false </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a862eab9858df52a50711a62921d3d48c" name="a862eab9858df52a50711a62921d3d48c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862eab9858df52a50711a62921d3d48c">&#9670;&#160;</a></span>can_user_view_policy_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::can_user_view_policy_version </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policy</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$behalfid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Can the user view the given policy version document? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$policy</td><td>- exported <a class="el" href="../../df/d90/classtool__policy_1_1policy__exporter.html">tool_policy::policy_exporter</a> instance </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$behalfid</td><td>The id of user on whose behalf the user is viewing the policy </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>The user whom access is evaluated, defaults to the current one </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4ab8b92bcf819c74f91c21e2f8e1392f" name="a4ab8b92bcf819c74f91c21e2f8e1392f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ab8b92bcf819c74f91c21e2f8e1392f">&#9670;&#160;</a></span>count_total_users()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::count_total_users </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns total number of users who are expected to accept site policy. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int|null</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad2153b9fcc16c6dad49d05c0fd5dca83" name="ad2153b9fcc16c6dad49d05c0fd5dca83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2153b9fcc16c6dad49d05c0fd5dca83">&#9670;&#160;</a></span>create_acceptances_user_created()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::create_acceptances_user_created </td>
          <td>(</td>
          <td class="paramtype">\core\event\user_created</td>          <td class="paramname"><span class="paramname"><em>$event</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create user policy acceptances when the user is created. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">core::event::user_created</td><td class="paramname">$event</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8963c3c5ef024731e60a71c971bb24bc" name="a8963c3c5ef024731e60a71c971bb24bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8963c3c5ef024731e60a71c971bb24bc">&#9670;&#160;</a></span>decline_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::decline_policies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyversionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$note</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$lang</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark the given policy versions as declined by the user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array&#160;|&#160;int</td><td class="paramname">$policyversionid</td><td>Policy version id(s) to set acceptance status for. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$userid</td><td>Id of the user accepting the policy version, defaults to the current one. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$note</td><td>Note to be recorded. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$lang</td><td>Language in which the policy was shown, defaults to the current one. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9bb9d6c035dfabf52515aabb86f3b1d6" name="a9bb9d6c035dfabf52515aabb86f3b1d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bb9d6c035dfabf52515aabb86f3b1d6">&#9670;&#160;</a></span>delete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::delete </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Delete the given version (if it is a draft). </p>
<p>Also delete policy if this is the only version.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6355a6a23f23d318c1e1699ba4ed6a2" name="ac6355a6a23f23d318c1e1699ba4ed6a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6355a6a23f23d318c1e1699ba4ed6a2">&#9670;&#160;</a></span>fix_revision_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::fix_revision_values </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$versions</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make sure that each version has a unique revision value. </p>
<p>Empty value are replaced with a timecreated date. Duplicates are suffixed with v1, v2, v3, ... etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$versions</td><td>List of objects with id, timecreated and revision properties </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a11c6900da7b93bfaf2a2a12ee0a458c6" name="a11c6900da7b93bfaf2a2a12ee0a458c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c6900da7b93bfaf2a2a12ee0a458c6">&#9670;&#160;</a></span>form_policydoc_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::form_policydoc_add </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$form</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the data from the policydoc form as a new policy document. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$form</td><td>data submitted from the <a class="el" href="../../da/d3d/classtool__policy_1_1form_1_1policydoc.html">tool_policy::form::policydoc</a> form. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html" title="Persistent model representing a single policy document version.">tool_policy::policy_version</a></td><td>persistent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa33734409e341be9fc3b37e52959b611" name="aa33734409e341be9fc3b37e52959b611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa33734409e341be9fc3b37e52959b611">&#9670;&#160;</a></span>form_policydoc_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::form_policydoc_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html">policy_version</a></td>          <td class="paramname"><span class="paramname"><em>$version</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare data for the <a class="el" href="../../da/d3d/classtool__policy_1_1form_1_1policydoc.html">tool_policy::form::policydoc</a> form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html" title="Persistent model representing a single policy document version.">tool_policy::policy_version</a></td><td class="paramname">$version</td><td>persistent representing the version. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>form data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a058017434dfe4b6879ced1476ebc1798" name="a058017434dfe4b6879ced1476ebc1798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a058017434dfe4b6879ced1476ebc1798">&#9670;&#160;</a></span>form_policydoc_update_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::form_policydoc_update_new </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$form</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the data from the policydoc form as a new policy document version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$form</td><td>data submitted from the <a class="el" href="../../da/d3d/classtool__policy_1_1form_1_1policydoc.html">tool_policy::form::policydoc</a> form. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html" title="Persistent model representing a single policy document version.">tool_policy::policy_version</a></td><td>persistent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a19c5c93735b4d8f364bc3494eb44bb50" name="a19c5c93735b4d8f364bc3494eb44bb50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c5c93735b4d8f364bc3494eb44bb50">&#9670;&#160;</a></span>form_policydoc_update_overwrite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::form_policydoc_update_overwrite </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$form</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Save the data from the policydoc form, overwriting the existing policy document version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$form</td><td>data submitted from the <a class="el" href="../../da/d3d/classtool__policy_1_1form_1_1policydoc.html">tool_policy::form::policydoc</a> form. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html" title="Persistent model representing a single policy document version.">tool_policy::policy_version</a></td><td>persistent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab41bb17befea9f2e8728e5abbea7896b" name="ab41bb17befea9f2e8728e5abbea7896b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41bb17befea9f2e8728e5abbea7896b">&#9670;&#160;</a></span>get_agreement_optional()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_agreement_optional </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the value of the optional flag for the given policy version. </p>
<p>Optimised for being called multiple times by making use of a request cache. The cache is normally populated as a side effect of calling <a class="el" href="">self::list_policies()</a> and in most cases should be warm enough for hits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>policy_version::AGREEMENT_COMPULSORY | policy_version::AGREEMENT_OPTIONAL </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad7af0bfeee77b7926e8cecd3eb949701" name="ad7af0bfeee77b7926e8cecd3eb949701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7af0bfeee77b7926e8cecd3eb949701">&#9670;&#160;</a></span>get_current_versions_ids()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_current_versions_ids </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$audience</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if there are any current policies defined and returns their ids only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$audience</td><td>If defined, filter against the given audience (AUDIENCE_ALL always included) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of version ids indexed by policies ids </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae9abf93f4901de83e8a1026a9f3be5a0" name="ae9abf93f4901de83e8a1026a9f3be5a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9abf93f4901de83e8a1026a9f3be5a0">&#9670;&#160;</a></span>get_policies_with_acceptances()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_policies_with_acceptances </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the list of policies and versions that current user is able to see and the respective acceptance records for the selected user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>array with the same structure that list_policies() returns with additional attribute acceptance for versions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae6c0bb19b30ae10563d6f6ef57c0dde1" name="ae6c0bb19b30ae10563d6f6ef57c0dde1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6c0bb19b30ae10563d6f6ef57c0dde1">&#9670;&#160;</a></span>get_policy_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_policy_version </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policies</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load a particular policy document version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td>ID of the policy document version. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$policies</td><td>cached result of self::list_policies() in case this function needs to be called in a loop </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>- exported <a class="el" href="../../df/d90/classtool__policy_1_1policy__exporter.html">tool_policy::policy_exporter</a> instance </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a28439c67955dd90aaadd55a06a95eaf8" name="a28439c67955dd90aaadd55a06a95eaf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28439c67955dd90aaadd55a06a95eaf8">&#9670;&#160;</a></span>get_user_acceptances()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_user_acceptances </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versions</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns list of acceptances for this user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>id of a user. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;array</td><td class="paramname">$versions</td><td>list of policy versions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of acceptances indexed by versionid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af358f28d575c8a640956a43802b4f2c2" name="af358f28d575c8a640956a43802b4f2c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af358f28d575c8a640956a43802b4f2c2">&#9670;&#160;</a></span>get_user_minors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_user_minors </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$extrafields</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the user's minors - other users on which behalf we can accept policies. </p>
<p>Returned objects contain all the standard user name and picture fields as well as the context instanceid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>The id if the user with parental responsibility </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$extrafields</td><td>Extra fields to be included in result </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of objects </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad622bd5635a12b83b438eae66c858b28" name="ad622bd5635a12b83b438eae66c858b28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad622bd5635a12b83b438eae66c858b28">&#9670;&#160;</a></span>get_user_version_acceptance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::get_user_version_acceptance </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$acceptances</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns version acceptance for this user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>User identifier. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td>Policy version identifier. </td></tr>
    <tr><td class="paramtype">array&#160;|&#160;null</td><td class="paramname">$acceptances</td><td>List of policy version acceptances indexed by versionid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass|null</td><td>Acceptance object if the user has ever accepted this version or null if not. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acb938533cd087f1b89b65df285ad60fe" name="acb938533cd087f1b89b65df285ad60fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb938533cd087f1b89b65df285ad60fe">&#9670;&#160;</a></span>inactivate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::inactivate </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inactivate the policy document - no version marked as current and the document does not apply. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$policyid</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a75da33b9b7f21cbc5226ec0252b6c896" name="a75da33b9b7f21cbc5226ec0252b6c896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75da33b9b7f21cbc5226ec0252b6c896">&#9670;&#160;</a></span>is_user_version_accepted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::is_user_version_accepted </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$acceptances</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Did the user accept the given policy version? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>User identifier. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td>Policy version identifier. </td></tr>
    <tr><td class="paramtype">array&#160;|&#160;null</td><td class="paramname">$acceptances</td><td>Pre-loaded list of policy version acceptances indexed by versionid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool|null</td><td>True/false if this user accepted/declined the policy; null otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4e36ae9a0bee3574dfde5b55e3a84a60" name="a4e36ae9a0bee3574dfde5b55e3a84a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e36ae9a0bee3574dfde5b55e3a84a60">&#9670;&#160;</a></span>list_current_versions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::list_current_versions </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$audience</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return current (active) policies versions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$audience</td><td>If defined, filter against the given audience (AUDIENCE_ALL always included) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of stdClass - exported <a class="el" href="../../d9/d9a/classtool__policy_1_1policy__version__exporter.html">tool_policy::policy_version_exporter</a> instances </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac374f3cd5e0d62d4b990d7f643e2b67c" name="ac374f3cd5e0d62d4b990d7f643e2b67c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac374f3cd5e0d62d4b990d7f643e2b67c">&#9670;&#160;</a></span>list_policies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::list_policies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$ids</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$countacceptances</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a list of all policy documents and their versions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array&#160;|&#160;int&#160;|&#160;null</td><td class="paramname">$ids</td><td>Load only the given policies, defaults to all. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$countacceptances</td><td>return number of user acceptances for each version </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of stdClass - exported <a class="el" href="../../df/d90/classtool__policy_1_1policy__exporter.html">tool_policy::policy_exporter</a> instances </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ed2c2b19d16f8282b053cb71ba5ae80" name="a0ed2c2b19d16f8282b053cb71ba5ae80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed2c2b19d16f8282b053cb71ba5ae80">&#9670;&#160;</a></span>make_current()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::make_current </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make the given version the current active one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ba6faf6b3e174bd8859750ea0052417" name="a0ba6faf6b3e174bd8859750ea0052417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ba6faf6b3e174bd8859750ea0052417">&#9670;&#160;</a></span>move_down()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::move_down </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move the given policy document down in the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">id</td><td class="paramname">$policyid</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac8fa0133a4935856a61922a769d980a9" name="ac8fa0133a4935856a61922a769d980a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fa0133a4935856a61922a769d980a9">&#9670;&#160;</a></span>move_policy_document()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::move_policy_document </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$step</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Change the policy document's sortorder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$policyid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$step</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a120921b5ff9f296d6f113b503032586f" name="a120921b5ff9f296d6f113b503032586f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120921b5ff9f296d6f113b503032586f">&#9670;&#160;</a></span>move_up()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::move_up </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Move the given policy document up in the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">id</td><td class="paramname">$policyid</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aae1df40e9e1ed48c5156941a1a8e6597" name="aae1df40e9e1ed48c5156941a1a8e6597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1df40e9e1ed48c5156941a1a8e6597">&#9670;&#160;</a></span>policy_content_field_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::policy_content_field_options </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Editor field options for the policy content text. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1692ca7f392f36c1a8950f4cc3e35559" name="a1692ca7f392f36c1a8950f4cc3e35559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1692ca7f392f36c1a8950f4cc3e35559">&#9670;&#160;</a></span>policy_summary_field_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::policy_summary_field_options </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Editor field options for the policy summary text. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab22cbb95e8eb5ec75692a7411223f9de" name="ab22cbb95e8eb5ec75692a7411223f9de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22cbb95e8eb5ec75692a7411223f9de">&#9670;&#160;</a></span>revert_to_draft()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::revert_to_draft </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$versionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new draft policy document from an archived version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$versionid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d1/d40/classtool__policy_1_1policy__version.html" title="Persistent model representing a single policy document version.">tool_policy::policy_version</a></td><td>persistent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa5d69644c8bfdfb802359eabf30fbb24" name="aa5d69644c8bfdfb802359eabf30fbb24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d69644c8bfdfb802359eabf30fbb24">&#9670;&#160;</a></span>revoke_acceptance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::revoke_acceptance </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyversionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$note</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>May be used to revert accidentally granted acceptance for another user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$policyversionid</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td></td></tr>
    <tr><td class="paramtype">null</td><td class="paramname">$note</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4752617b3ddcf7e552cb18ad9a50c13d" name="a4752617b3ddcf7e552cb18ad9a50c13d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4752617b3ddcf7e552cb18ad9a50c13d">&#9670;&#160;</a></span>set_acceptances_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::set_acceptances_status </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$policyversionid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$note</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$lang</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$status</em><span class="paramdefsep"> = </span><span class="paramdefval">1</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mark the given policy versions as accepted or declined by the user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array&#160;|&#160;int</td><td class="paramname">$policyversionid</td><td>Policy version id(s) to set acceptance status for. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$userid</td><td>Id of the user accepting the policy version, defaults to the current one. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$note</td><td>Note to be recorded. </td></tr>
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$lang</td><td>Language in which the policy was shown, defaults to the current one. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$status</td><td>The acceptance status, defaults to 1 = accepted </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5a15a19e4fd73b0f8a602ed9738053ef" name="a5a15a19e4fd73b0f8a602ed9738053ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a15a19e4fd73b0f8a602ed9738053ef">&#9670;&#160;</a></span>update_policyagreed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static tool_policy\api::update_policyagreed </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$user</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make sure that $user-&gt;policyagreed matches the agreement to the policies. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;stdClass&#160;|&#160;null</td><td class="paramname">$user</td><td>user to check (null for current user) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>admin/tool/policy/classes/<b>api.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 5 2024 02:43:43 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
